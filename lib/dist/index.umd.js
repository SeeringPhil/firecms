(function(y,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("@emotion/react/jsx-runtime"),require("@mui/x-date-pickers/AdapterDateFns"),require("@mui/x-date-pickers/LocalizationProvider"),require("@date-io/date-fns"),require("date-fns/locale"),require("react"),require("@mui/material"),require("react-router-dom"),require("notistack"),require("@mui/icons-material/Error"),require("@mui/material/styles"),require("@mui/material/Tooltip"),require("@mui/icons-material"),require("react-fast-compare"),require("@mui/icons-material/Close"),require("object-hash"),require("@mui/icons-material/Adjust"),require("@mui/icons-material/Functions"),require("@mui/icons-material/Crop75"),require("@mui/icons-material/ShortText"),require("@mui/icons-material/Subject"),require("@mui/icons-material/AddLink"),require("@mui/icons-material/List"),require("@mui/icons-material/Schedule"),require("@mui/icons-material/UploadFile"),require("@mui/icons-material/DriveFolderUpload"),require("@mui/icons-material/Repeat"),require("@mui/icons-material/ViewStream"),require("@mui/icons-material/ListAlt"),require("@mui/icons-material/Link"),require("@mui/icons-material/Http"),require("@mui/icons-material/Flag"),require("@mui/icons-material/Numbers"),require("@mui/icons-material/FormatListNumbered"),require("@mui/icons-material/FormatQuote"),require("@mui/icons-material/Email"),require("@mui/icons-material/BallotOutlined"),require("@mui/icons-material/Clear"),require("formik"),require("@mui/icons-material/Add"),require("@mui/icons-material/Remove"),require("@mui/icons-material/ContentCopy"),require("@mui/icons-material/DragHandle"),require("@hello-pangea/dnd"),require("react-use-measure"),require("@mui/icons-material/InfoOutlined"),require("react-dropzone"),require("@mui/system"),require("react-dom"),require("@mui/utils"),require("date-fns/format"),require("@mui/icons-material/DescriptionOutlined"),require("@mui/icons-material/OpenInNew"),require("markdown-it"),require("@mui/icons-material/KeyboardTab"),require("@mui/x-date-pickers/DatePicker"),require("@mui/x-date-pickers/DateTimePicker"),require("@mui/icons-material/ArrowForward"),require("@mui/icons-material/StarBorder"),require("@mui/icons-material/Star"),require("@mui/icons-material/ExpandMore"),require("@mui/icons-material/Assignment"),require("react-window"),require("@mui/icons-material/ArrowUpward"),require("@mui/icons-material/ArrowDownward"),require("@mui/icons-material/ArrowDropDownCircle"),require("@mui/lab"),require("@mui/icons-material/LightModeOutlined"),require("@mui/icons-material/DarkModeOutlined"),require("@mui/icons-material/NavigateNext"),require("react-markdown-editor-lite"),require("@mui/material/Select"),require("@mui/material/InputBase"),require("@mui/material/MenuItem"),require("@mui/material/colors"),require("yup"),require("firebase/auth"),require("firebase/firestore"),require("firebase/storage"),require("@mui/icons-material/ArrowBack"),require("@mui/icons-material/PersonOutline"),require("firebase/app"),require("firebase/app-check"),require("@emotion/react"),require("@mui/icons-material/Menu"),require("@mui/material/IconButton"),require("@mui/icons-material/ChevronLeft"),require("@mui/icons-material/ChevronRight"),require("flexsearch/dist/module/index.js"),require("@mui/icons-material/Search"),require("@mui/icons-material/GetApp"),require("clsx"),require("react-image-file-resizer"),require("@mui/material/Button"),require("@mui/material/Dialog"),require("@mui/material/DialogContent"),require("@mui/material/DialogContentText"),require("@mui/material/DialogTitle"),require("@mui/icons-material/Edit"),require("@mui/icons-material/ErrorOutline"),require("@mui/icons-material/RemoveCircle"),require("@mui/icons-material/FilterListOff")):typeof define=="function"&&define.amd?define(["exports","@emotion/react/jsx-runtime","@mui/x-date-pickers/AdapterDateFns","@mui/x-date-pickers/LocalizationProvider","@date-io/date-fns","date-fns/locale","react","@mui/material","react-router-dom","notistack","@mui/icons-material/Error","@mui/material/styles","@mui/material/Tooltip","@mui/icons-material","react-fast-compare","@mui/icons-material/Close","object-hash","@mui/icons-material/Adjust","@mui/icons-material/Functions","@mui/icons-material/Crop75","@mui/icons-material/ShortText","@mui/icons-material/Subject","@mui/icons-material/AddLink","@mui/icons-material/List","@mui/icons-material/Schedule","@mui/icons-material/UploadFile","@mui/icons-material/DriveFolderUpload","@mui/icons-material/Repeat","@mui/icons-material/ViewStream","@mui/icons-material/ListAlt","@mui/icons-material/Link","@mui/icons-material/Http","@mui/icons-material/Flag","@mui/icons-material/Numbers","@mui/icons-material/FormatListNumbered","@mui/icons-material/FormatQuote","@mui/icons-material/Email","@mui/icons-material/BallotOutlined","@mui/icons-material/Clear","formik","@mui/icons-material/Add","@mui/icons-material/Remove","@mui/icons-material/ContentCopy","@mui/icons-material/DragHandle","@hello-pangea/dnd","react-use-measure","@mui/icons-material/InfoOutlined","react-dropzone","@mui/system","react-dom","@mui/utils","date-fns/format","@mui/icons-material/DescriptionOutlined","@mui/icons-material/OpenInNew","markdown-it","@mui/icons-material/KeyboardTab","@mui/x-date-pickers/DatePicker","@mui/x-date-pickers/DateTimePicker","@mui/icons-material/ArrowForward","@mui/icons-material/StarBorder","@mui/icons-material/Star","@mui/icons-material/ExpandMore","@mui/icons-material/Assignment","react-window","@mui/icons-material/ArrowUpward","@mui/icons-material/ArrowDownward","@mui/icons-material/ArrowDropDownCircle","@mui/lab","@mui/icons-material/LightModeOutlined","@mui/icons-material/DarkModeOutlined","@mui/icons-material/NavigateNext","react-markdown-editor-lite","@mui/material/Select","@mui/material/InputBase","@mui/material/MenuItem","@mui/material/colors","yup","firebase/auth","firebase/firestore","firebase/storage","@mui/icons-material/ArrowBack","@mui/icons-material/PersonOutline","firebase/app","firebase/app-check","@emotion/react","@mui/icons-material/Menu","@mui/material/IconButton","@mui/icons-material/ChevronLeft","@mui/icons-material/ChevronRight","flexsearch/dist/module/index.js","@mui/icons-material/Search","@mui/icons-material/GetApp","clsx","react-image-file-resizer","@mui/material/Button","@mui/material/Dialog","@mui/material/DialogContent","@mui/material/DialogContentText","@mui/material/DialogTitle","@mui/icons-material/Edit","@mui/icons-material/ErrorOutline","@mui/icons-material/RemoveCircle","@mui/icons-material/FilterListOff"],o):(y=typeof globalThis<"u"?globalThis:y||self,o(y.FireCMS={},y.jsxRuntime,y.AdapterDateFns,y.LocalizationProvider,y.DateFnsUtils,y.locales,y.React,y.material,y.reactRouterDom,y.notistack,y.ErrorIcon,y.styles$1,y.Tooltip,y.mui,y.equal,y.CloseIcon,y.hash,y.AdjustIcon,y.FunctionsIcon,y.Crop75Icon,y.ShortTextIcon,y.SubjectIcon,y.AddLinkIcon,y.ListIcon,y.ScheduleIcon,y.UploadFileIcon,y.DriveFolderUploadIcon,y.RepeatIcon,y.ViewStreamIcon,y.ListAltIcon,y.LinkIcon,y.HttpIcon,y.FlagIcon,y.NumbersIcon,y.FormatListNumberedIcon,y.FormatQuoteIcon,y.EmailIcon,y.BallotOutlinedIcon,y.ClearIcon,y.formik,y.AddIcon,y.RemoveIcon,y.CopyIcon,y.DragHandleIcon,y.dnd,y.useMeasure,y.InfoIcon,y.reactDropzone,y.system,y.ReactDOM,y.utils,y.format,y.DescriptionOutlinedIcon,y.OpenInNewIcon,y.MarkdownIt,y.KeyboardTabIcon,y.DatePicker,y.DateTimePicker,y.ArrowForwardIcon,y.StarBorderIcon,y.StarIcon,y.ExpandMoreIcon,y.AssignmentIcon,y.reactWindow,y.ArrowUpwardIcon,y.ArrowDownwardIcon,y.ArrowDropDownCircleIcon,y.lab,y.LightModeOutlinedIcon,y.DarkModeOutlinedIcon,y.NavigateNextIcon,y.MdEditor,y.Select,y.InputBase,y.MenuItem,y.colors,y.yup,y.auth,y.firestore,y.storage,y.ArrowBackIcon,y.PersonOutlineIcon,y.app,y.appCheck,y.react,y.MenuIcon,y.IconButton,y.ChevronLeftIcon,y.ChevronRightIcon,y.Index,y.SearchIcon,y.GetAppIcon,y.clsx,y.Resizer,y.Button,y.Dialog,y.DialogContent,y.DialogContentText,y.DialogTitle,y.EditIcon,y.ErrorOutlineIcon,y.RemoveCircleIcon,y.FilterListOffIcon))})(this,function(y,o,ms,ks,Ss,Fs,d,c,Ae,qr,mt,ge,Zr,ye,le,Is,Xr,Ts,Ds,Ps,Ms,Qs,Ls,Os,Gs,$s,Vs,Kr,Ws,Ys,Rr,zs,Us,Ns,en,Hs,on,_s,Pe,we,js,kt,St,Js,io,Ft,qs,tn,Wo,Zs,Co,Xs,Ks,xo,rn,It,Tt,Dt,Rs,nn,sn,el,ol,tl,ln,rl,nl,il,sl,ll,al,Bo,cl,an,dl,Yo,Al,K,X,so,Pt,ul,fl,zo,gl,hl,cn,pl,bl,vl,yl,wl,Cl,xl,dn,Bl,El,An,ml,kl,Sl,Fl,Il){"use strict";function Eo(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:()=>e[r]})}}return t.default=e,Object.freeze(t)}const un=Eo(Fs),Ce=Eo(d),Mt=Eo(ye),Tl=Eo(Zs),me=Eo(Al),Dl={breadcrumbs:[],set:e=>{}},fn=d.createContext(Dl),Pl=({children:e})=>{const[t,r]=d.useState([]),n=s=>{r(s.breadcrumbs)};return o.jsx(fn.Provider,{value:{breadcrumbs:t,set:n},children:e})},Ml={mode:"light",setMode:e=>{},toggleMode:()=>{}},Qt=d.createContext(Ml),gn=Qt.Provider;function be(e){return hn(pn(e))}function hn(e){return e.startsWith("/")?e.slice(1):e}function pn(e){return e.endsWith("/")?e.slice(0,-1):e}function Ql(e){return e.startsWith("/")?e:`/${e}`}function Ll(e){const t=be(e);if(t.includes("/")){const r=t.split("/");return r[r.length-1]}return t}function Lt(e,t){const r=be(e),n=r.split("/");if(n.length%2===0)throw Error(`Collection paths must have an odd number of segments: ${e}`);const s=t.find(l=>l.alias===n[0]);let i;if(s&&(i=s.path),n.length>1){const l=Uo(i??n[0],t);if(!l?.subcollections)return r;const a=r.split("/").slice(2).join("/");return(i??n[0])+"/"+n[1]+"/"+Lt(a,l.subcollections)}else return i??r}function Uo(e,t){const r=be(e).split("/");if(r.length%2===0)throw Error(`Collection paths must have an odd number of segments: ${e}`);const n=Ot(r);let s;for(let i=0;i<n.length;i++){const l=n[i],a=t&&t.sort((A,u)=>(A.alias??"").localeCompare(u.alias??"")).find(A=>A.alias===l||A.path===l);if(a){if(l===e)s=a;else if(a.subcollections){const A=e.replace(l,"").split("/").slice(2).join("/");A.length>0&&(s=Uo(A,a.subcollections))}}if(s)break}return s}function Ot(e){const t=e.length>0&&e.length%2===0?e.splice(0,e.length-1):e,r=t.length,n=[];for(let s=r;s>0;s=s-2)n.push(t.slice(0,s).join("/"));return n}function Gt(e){const{path:t,collections:r=[],currentFullPath:n}=e,s=be(t).split("/"),i=Ot(s),l=[];for(let a=0;a<i.length;a++){const A=i[a],u=r&&r.find(f=>f.alias===A||f.path===A);if(u){const f=u.alias??u.path,h=n&&n.length>0?n+"/"+f:f;l.push({type:"collection",path:h,collection:u});const b=be(be(t).replace(A,"")),v=b.length>0?b.split("/"):[];if(v.length>0){const g=v[0],p=h+"/"+g;if(l.push({type:"entity",entityId:g,path:h,parentCollection:u}),v.length>1){const w=v.slice(1).join("/");if(!u)throw Error("collection not found resolving path: "+u);const C=u.views,x=C&&C.find(B=>B.path===w);if(x){const B=n&&n.length>0?n+"/"+x.path:x.path;l.push({type:"custom_view",path:B,view:x})}else u.subcollections&&l.push(...Gt({path:w,customViews:C,collections:u.subcollections,currentFullPath:p}))}}break}}return l}const mo="100vw",No="55vw",Ho="700px",bn=d.createContext({}),Se=()=>d.useContext(bn),vn=d.createContext({}),he=()=>d.useContext(vn),yn=d.createContext({}),Je=()=>d.useContext(yn),wn=d.createContext({}),ko=()=>d.useContext(wn),Cn=d.createContext({}),Ne=()=>d.useContext(Cn),xn=d.createContext({}),lo=()=>d.useContext(xn),He=()=>{const{enqueueSnackbar:e,closeSnackbar:t}=qr.useSnackbar();return{open:d.useCallback(n=>{const{type:s,message:i}=n;e({message:i,variant:s})},[]),close:t}},Bn=d.createContext(void 0),ao=()=>d.useContext(Bn),$t=d.createContext({sideDialogsController:{},sideEntityController:{},navigation:{},dataSource:{},storageSource:{},authController:{},snackbarController:{},fields:{}}),oe=()=>{const e=d.useContext($t),t=Je(),r=ko(),n=Ne(),s=he(),i=Se(),l=lo(),a=He(),A=ao();return{...e,authController:t,sideDialogsController:r,sideEntityController:n,navigation:s,dataSource:i,storageSource:l,snackbarController:a,userConfigPersistence:A}};function En({path:e,collection:t,filterValues:r,sortBy:n,itemCount:s,searchString:i}){const l=Se(),A=he().resolveAliasesFrom(e),u=n?n[0]:void 0,f=n?n[1]:void 0,h=oe(),[b,v]=d.useState([]),[g,p]=d.useState(!1),[w,C]=d.useState(),[x,B]=d.useState(!1);return d.useEffect(()=>{p(!0);const E=async k=>{if(t.callbacks?.onFetch)try{k=await Promise.all(k.map(S=>t.callbacks.onFetch({collection:t,path:A,entity:S,context:h})))}catch(S){console.error(S)}p(!1),C(void 0),v(k),B(!s||k.length<s)},m=k=>{console.error("ERROR",k),p(!1),v([]),C(k)};return l.listenCollection?l.listenCollection({path:A,collection:t,onUpdate:E,onError:m,searchString:i,filter:r,limit:s,startAfter:void 0,orderBy:u,order:f}):(l.fetchCollection({path:A,collection:t,searchString:i,filter:r,limit:s,startAfter:void 0,orderBy:u,order:f}).then(E).catch(m),()=>{})},[A,s,f,u,r,i]),{data:b,dataLoading:g,dataLoadingError:w,noMoreToLoad:x}}const Vt={};function _o({path:e,entityId:t,collection:r,useCache:n=!1}){const s=Se(),l=he().resolveAliasesFrom(e),a=oe(),[A,u]=d.useState(),[f,h]=d.useState(!0),[b,v]=d.useState();return d.useEffect(()=>{h(!0);const g=async w=>{if(r.callbacks?.onFetch&&w)try{w=await r.callbacks.onFetch({collection:r,path:l,entity:w,context:a})}catch(C){console.error(C)}Vt[`${l}/${t}`]=w,u(w),h(!1),v(void 0)},p=w=>{console.error("ERROR fetching entity",w),h(!1),u(void 0),v(w)};return t&&n&&Vt[`${l}/${t}`]?(u(Vt[`${l}/${t}`]),h(!1),v(void 0),()=>{}):t&&l&&r?s.listenEntity?s.listenEntity({path:l,entityId:t,collection:r,onUpdate:g,onError:p}):(s.fetchEntity({path:l,entityId:t,collection:r}).then(g).catch(p),()=>{}):(g(void 0),()=>{})},[t,l]),{entity:A,dataLoading:f,dataLoadingError:b}}async function Wt({collection:e,path:t,entityId:r,values:n,previousValues:s,status:i,dataSource:l,context:a,onSaveSuccess:A,onSaveFailure:u,onPreSaveHookError:f,onSaveSuccessHookError:h}){let b;const v=a.navigation.resolveAliasesFrom(t),g=e.callbacks;if(g?.onPreSave)try{const p=pe({collection:e,path:t,values:s,entityId:r,fields:a.fields});b=await g.onPreSave({collection:p,path:t,resolvedPath:v,entityId:r,values:n,previousValues:s,status:i,context:a})}catch(p){console.error(p),f&&f(p);return}else b=n;return l.saveEntity({collection:e,path:v,entityId:r,values:b,previousValues:s,status:i}).then(p=>{try{if(g?.onSaveSuccess){const w=pe({collection:e,path:t,values:b,entityId:r,fields:a.fields});g.onSaveSuccess({collection:w,path:t,resolvedPath:v,entityId:p.id,values:b,previousValues:s,status:i,context:a})}}catch(w){h&&h(w)}A&&A(p)}).catch(p=>{if(g?.onSaveFailure){const w=pe({collection:e,path:t,values:b,entityId:r,fields:a.fields});g.onSaveFailure({collection:w,path:t,resolvedPath:v,entityId:r,values:b,previousValues:s,status:i,context:a})}u&&u(p)})}async function mn({dataSource:e,entity:t,collection:r,callbacks:n,onDeleteSuccess:s,onDeleteFailure:i,onPreDeleteHookError:l,onDeleteSuccessHookError:a,context:A}){console.debug("Deleting entity",t.path,t.id);const u={entity:t,collection:r,entityId:t.id,path:t.path,context:A};if(n?.onPreDelete)try{await n.onPreDelete(u)}catch(f){return console.error(f),l&&l(t,f),!1}return e.deleteEntity({entity:t}).then(()=>{s&&s(t);try{return n?.onDelete&&n.onDelete(u),!0}catch(f){return a&&a(t,f),!1}}).catch(f=>(i&&i(t,f),!1))}function ke({property:e,value:t,setValue:r}){const n=d.useRef(null);d.useEffect(()=>{typeof e.disabled=="object"&&!!e.disabled.clearOnDisabled?t!=null&&(n.current=t,r(null)):n.current&&(r(n.current),n.current=null)},[e])}function kn({path:e,context:t}){const r=t.dataSource,n=t.navigation;if(!n)throw Error("Calling getNavigationFrom, but main navigation has not yet been initialised");const i=Gt({path:e,collections:n.collections??[]}).map(l=>{if(l.type==="collection")return Promise.resolve(l);if(l.type==="entity"){const a=n.getCollection(l.path,l.entityId);if(!a)throw Error(`No collection defined in the navigation for the entity with path ${l.path}`);return r.fetchEntity({path:l.path,entityId:l.entityId,collection:a}).then(A=>{if(A)return{...l,entity:A}})}else{if(l.type==="custom_view")return Promise.resolve(l);throw Error("Unmapped element in useEntitiesFromPath")}}).filter(l=>!!l);return Promise.all(i)}function Ol({path:e}){const t=oe(),[r,n]=d.useState(),[s,i]=d.useState(!1),[l,a]=d.useState();return d.useEffect(()=>{t.navigation&&(i(!0),a(void 0),kn({path:e,context:t}).then(u=>{n(u)}).catch(u=>a(u)).finally(()=>i(!1)))},[e,t]),t.navigation?{data:r,dataLoading:s,dataLoadingError:l}:{dataLoading:!0}}const jo=()=>d.useContext(Qt),Sn=e=>{const{onSuccess:t,onError:r,disableClipboardAPI:n=!1,copiedDuration:s}=e||{},i=d.useRef(null),[l,a]=d.useState(!1),[A,u]=d.useState("");d.useEffect(()=>{s&&setTimeout(()=>a(!1),s)},[l]);const f=()=>navigator.clipboard!==void 0,h=d.useCallback(x=>{if(r)r(x);else throw new Error(x)},[r]),b=d.useCallback(x=>{t&&t(x),a(!0),u(x)},[t]),v=d.useCallback(x=>{navigator.clipboard.writeText(x).then(()=>b(x)).catch(B=>{h(B),a(!1)})},[h,b]),g=()=>{f()&&navigator.clipboard.writeText("")},p=x=>C("copy",typeof x=="object"?void 0:x),w=()=>C("cut"),C=d.useCallback((x="copy",B)=>{const E=i.current,m=E&&(E.tagName==="INPUT"||E.tagName==="TEXTAREA"),k=i.current;f()&&!n&&(B?v(B):E?m?(v(k.value),x==="cut"&&(k.value="")):v(E.innerText):h("Both the ref & text were undefined"))},[n,v,h]);return{ref:i,isCoppied:l,clipboard:A,clearClipboard:g,isSupported:f,copy:p,cut:w}},Jo=()=>d.useContext(fn);function So(e){const t=he(),r=ko(),n=d.useCallback(()=>{if(e.path){let i=e.collection;if(i||(i=t.getCollection(e.path)),!i)throw Error("Not able to resolve the collection in useReferenceDialog");r.open({key:`reference_${e.path}`,component:o.jsx(Ji,{...e,collection:i}),width:"90vw",onClose:()=>{e.onClose?.()}})}else throw Error("useReferenceDialog: You are trying to open a reference dialog, but have not declared the `path`")},[t,e,r]),s=d.useCallback(()=>{r.close()},[r]);return{open:n,close:s}}const Gl=`data:image/png;base64,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
`;function Fn(e,t){d.useEffect(()=>{if(document){document.title=`${e} - FireCMS`;let r=document.querySelector("link[rel~='icon']");r||(r=document.createElement("link"),r.rel="icon",document.getElementsByTagName("head")[0].appendChild(r)),r.href=t??Gl}},[e,t])}const In=ge.styled(({className:e,...t})=>o.jsx(c.Tooltip,{...t,classes:{popper:e}}))(({theme:e})=>({[`& .${Zr.tooltipClasses.tooltip}`]:{margin:"0 8px",backgroundColor:e.palette.error.light},[`& .${Zr.tooltipClasses.arrow}`]:{color:e.palette.error.light}}));function ue({title:e,error:t,tooltip:r}){const n=t instanceof Error?t.message:t,s=o.jsxs(c.Box,{sx:{display:"flex",alignItems:"center",margin:1},children:[o.jsx(mt,{fontSize:"small",color:"error"}),o.jsxs(c.Box,{sx:{paddingLeft:2},children:[e&&o.jsx(c.Typography,{variant:"body2",sx:{fontWeight:"500"},children:e}),o.jsx(c.Typography,{variant:"body2",children:n})]})]});return r?o.jsx(In,{title:r,children:s}):s}class Me{id;path;constructor(t,r){this.id=t,this.path=r}get pathWithId(){return`${this.path}/${this.id}`}}class Fo{latitude;longitude;constructor(t,r){this.latitude=t,this.longitude=r}}function xe(e){const t=oe();let r;const{property:n,propertyKey:s,value:i,size:l,height:a,width:A,entity:u}=e,f=Ie({propertyKey:s,propertyOrBuilder:n,propertyValue:i,fields:t.fields});if(i===void 0||f===null)r=o.jsx(Ao,{});else if(f.Preview)r=d.createElement(f.Preview,{propertyKey:s,value:i,property:f,size:l,height:a,width:A,entity:u,customProps:f.customProps});else if(i===null)r=o.jsx(Ao,{});else if(f.dataType==="string"){const h=f;typeof i=="string"?h.url?typeof h.url=="boolean"?r=o.jsx(Ro,{size:e.size,url:i}):typeof h.url=="string"&&(r=o.jsx(Ro,{size:e.size,url:i,previewType:h.url})):h.storage?r=o.jsx(zn,{storeUrl:f.storage?.storeUrl??!1,size:e.size,storagePathOrDownloadUrl:i}):h.markdown?r=o.jsx(et,{source:i}):r=o.jsx(Nt,{...e,property:h,value:i}):r=qe(s,f.dataType,i)}else if(f.dataType==="array")if(i instanceof Array){const h=f;if(!h.of&&!h.oneOf)throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${s}`);h.of?Array.isArray(h.of)?r=o.jsx(jt,{...e,value:i,property:f}):h.of.dataType==="map"?r=o.jsx(Mn,{propertyKey:s,property:f,value:i,entity:u,size:l}):h.of.dataType==="reference"?typeof h.of.path=="string"?r=o.jsx(Gn,{...e,value:i,property:f}):r=o.jsx(Ao,{}):h.of.dataType==="string"?h.of.enumValues?r=o.jsx(_t,{...e,value:i,property:f}):h.of.storage?r=o.jsx(On,{...e,value:i,property:f}):r=o.jsx(Pn,{...e,value:i,property:f}):h.of.dataType==="number"&&h.of.enumValues?r=o.jsx(_t,{...e,value:i,property:f}):r=o.jsx(jt,{...e,value:i,property:f}):h.oneOf&&(r=o.jsx(Vn,{...e,value:i,property:f}))}else r=qe(s,f.dataType,i);else f.dataType==="map"?typeof i=="object"?r=o.jsx($n,{...e,property:f}):r=qe(s,f.dataType,i):f.dataType==="date"?i instanceof Date?r=o.jsx(Wn,{date:i}):r=qe(s,f.dataType,i):f.dataType==="reference"?typeof f.path=="string"?i instanceof Me?r=o.jsx(Ke,{disabled:!f.path,previewProperties:f.previewProperties,size:e.size,onClick:e.onClick,reference:i}):r=qe(s,f.dataType,i):r=o.jsx(Ao,{}):f.dataType==="boolean"?typeof i=="boolean"?r=o.jsx(Hn,{value:i}):r=qe(s,f.dataType,i):f.dataType==="number"?typeof i=="number"?r=o.jsx(Qn,{...e,value:i,property:f}):r=qe(s,f.dataType,i):r=JSON.stringify(i);return r??o.jsx(Ao,{})}function qe(e,t,r){return console.error(`Unexpected value for property ${e}, of type ${t}`,r),o.jsx(ue,{title:"Unexpected value",error:`${JSON.stringify(r)}`})}function Tn(e){let t=0,r,n;for(r=0;r<e.length;r++)n=e.charCodeAt(r),t=(t<<5)-t+n,t|=0;return Math.abs(t)}const Yt={blueLighter:{color:"#cfdfff",text:"#102046"},cyanLighter:{color:"#d0f0fd",text:"#04283f"},tealLighter:{color:"#c2f5e9",text:"#012524"},greenLighter:{color:"#d1f7c4",text:"#0b1d05"},yellowLighter:{color:"#ffeab6",text:"#3b2501"},orangeLighter:{color:"#fee2d5",text:"#6b2613"},redLighter:{color:"#ffdce5",text:"#4c0c1c"},pinkLighter:{color:"#ffdaf6",text:"#400832"},purpleLighter:{color:"#ede2fe",text:"#280b42"},grayLighter:{color:"#eee",text:"#040404"},blueLight:{color:"#9cc7ff",text:"#102046"},cyanLight:{color:"#77d1f3",text:"#04283f"},tealLight:{color:"#72ddc3",text:"#012524"},greenLight:{color:"#93e088",text:"#0b1d05"},yellowLight:{color:"#ffd66e",text:"#3b2501"},orangeLight:{color:"#ffa981",text:"#6b2613"},redLight:{color:"#ff9eb7",text:"#4c0c1c"},pinkLight:{color:"#f99de2",text:"#400832"},purpleLight:{color:"#cdb0ff",text:"#280b42"},grayLight:{color:"#ccc",text:"#040404"},blueDark:{color:"#2d7ff9",text:"#fff"},cyanDark:{color:"#18bfff",text:"#fff"},tealDark:{color:"#20d9d2",text:"#fff"},greenDark:{color:"#20c933",text:"#fff"},yellowDark:{color:"#fcb400",text:"#fff"},orangeDark:{color:"#ff6f2c",text:"#fff"},redDark:{color:"#f82b60",text:"#fff"},pinkDark:{color:"#ff08c2",text:"#fff"},purpleDark:{color:"#8b46ff",text:"#fff"},grayDark:{color:"#666",text:"#fff"},blueDarker:{color:"#2750ae",text:"#cfdfff"},cyanDarker:{color:"#0b76b7",text:"#d0f0fd"},tealDarker:{color:"#06a09b",text:"#c2f5e9"},greenDarker:{color:"#338a17",text:"#d1f7c4"},yellowDarker:{color:"#b87503",text:"#ffeab6"},orangeDarker:{color:"#d74d26",text:"#fee2d5"},redDarker:{color:"#ba1e45",text:"#ffdce5"},pinkDarker:{color:"#b2158b",text:"#ffdaf6"},purpleDarker:{color:"#6b1cb0",text:"#ede2fe"},grayDarker:{color:"#444",text:"#eee"}};function zt(e){const t=Tn(e),r=Object.keys(Yt),n=t%r.length;return Yt[r[n]]}function qo(e){return Array.isArray(e)?e:Object.entries(e).map(([t,r])=>typeof r=="string"?{id:t,label:r}:{...r,id:t})}function Dn(e,t){if(t)return e.find(r=>r.id===t)}function $l(e,t){const r=Dn(e,t);if(!r?.color)return zt(t.toString());if(typeof r=="object"&&"color"in r){if(typeof r.color=="string")return Yt[r.color];if(typeof r.color=="object")return r.color}}function Zo(e){return typeof e=="object"&&e.disabled}function Vl(e){if(e!==void 0)return typeof e=="object"?e.label:e}function Fe({enumValues:e,enumKey:t,small:r}){if(!e)return null;const n=qo(e),s=t!==void 0?Dn(n,t):void 0,i=Vl(s),l=$l(n,t);return o.jsx(Ut,{colorScheme:l,label:i!==void 0?i:t,error:!i,outlined:!1,small:r})}function Ut({label:e,colorScheme:t,error:r,outlined:n,small:s}){const i=c.useTheme(),l=t??zt(e);return o.jsx(c.Chip,{sx:{maxWidth:"100%",backgroundColor:r||!l?"#eee":l.color,color:r||!l?"red":l.text,fontWeight:i.typography.fontWeightRegular},size:s?"small":"medium",variant:n?"outlined":"filled",label:e})}function Nt({propertyKey:e,value:t,property:r,size:n}){if(r.enumValues){const s=t,i=br(r);return o.jsx(Fe,{enumKey:s,enumValues:i.enumValues,small:n!=="regular"})}else if(r.previewAsTag){const s=zt(e??"");return o.jsx(ne,{children:o.jsx(Ut,{colorScheme:s,label:t,small:n!=="regular"})})}else{if(!t)return o.jsx(o.Fragment,{});const s=t.split(`
`);return t&&t.includes(`
`)?o.jsx("div",{children:s.map((i,l)=>o.jsxs(d.Fragment,{children:[o.jsx("span",{children:i}),l!==s.length-1&&o.jsx("br",{})]},`string_preview_${l}`))}):o.jsx(o.Fragment,{children:t})}}const Ht="ArrayOfStringsPreview",Io={array:`${Ht}-array`,arrayWrap:`${Ht}-arrayWrap`,arrayItem:`${Ht}-arrayItem`},Wl=ge.styled("div")(({theme:e})=>({[`& .${Io.array}`]:{display:"flex",flexDirection:"column"},[`& .${Io.arrayWrap}`]:{display:"flex",flexWrap:"wrap"},[`& .${Io.arrayItem}`]:{margin:e.spacing(.5)}}));function Pn({propertyKey:e,value:t,property:r,entity:n,size:s}){const i=oe(),l=_e({propertyKey:e,property:r,propertyValue:t,fields:i.fields});if(Array.isArray(l.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(!l.of||l.dataType!=="array"||l.of.dataType!=="string")throw Error("Picked wrong preview component ArrayOfStringsPreview");if(t&&!Array.isArray(t))return o.jsx(Wl,{children:`Unexpected value: ${t}`});const a=l.of;return o.jsx("div",{className:Io.array,children:t&&t.map((A,u)=>o.jsx("div",{className:Io.arrayItem,children:o.jsx(ne,{children:o.jsx(Nt,{propertyKey:e,property:a,value:A,entity:n,size:s})})},`preview_array_strings_${e}_${u}`))})}function Xo({name:e,value:t,enumValues:r,size:n}){return o.jsx(c.Box,{sx:s=>({display:"flex",flexWrap:"wrap",gap:s.spacing(.5)}),children:t&&t.map((s,i)=>o.jsx(ne,{children:o.jsx(Fe,{enumKey:s,enumValues:r,small:n!=="regular"})},`preview_array_ref_${e}_${i}`))})}function _t({propertyKey:e,value:t,property:r,size:n}){if(r.dataType!=="array")throw Error("Picked wrong preview component ArrayEnumPreview");const s=r.of;if(!s.enumValues)throw Error("Picked wrong preview component ArrayEnumPreview");return t?o.jsx(Xo,{name:e,value:t,enumValues:s.enumValues,size:n}):null}function Mn({propertyKey:e,value:t,property:r,size:n,entity:s}){const i=oe(),l=_e({propertyKey:e,property:r,propertyValue:t,fields:i.fields});if(Array.isArray(l?.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(l?.dataType!=="array"||!l.of||l.of.dataType!=="map")throw Error("Picked wrong preview component ArrayOfMapsPreview");const a=l.of,A=a.properties;if(!A)throw Error(`You need to specify a 'properties' prop (or specify a custom field) in your map property ${e}`);const u=t,f=a.previewProperties;if(!u)return null;let h=f;return(!h||!h.length)&&(h=Object.keys(A),n&&(h=h.slice(0,3))),o.jsx(c.Table,{size:"small",children:o.jsx(c.TableBody,{children:u&&u.map((b,v)=>o.jsx(c.TableRow,{sx:{"&:last-child th, &:last-child td":{borderBottom:0}},children:h&&h.map(g=>o.jsx(c.TableCell,{component:"th",children:o.jsx(ne,{children:o.jsx(xe,{propertyKey:g,value:b[g],property:A[g],entity:s,size:"small"})})},`table-cell-${g}`))},`table_${b}_${v}`))})})}function Qn({value:e,property:t,size:r}){if(t.enumValues){const n=e,s=Qo(t.enumValues);return s?o.jsx(Fe,{enumKey:n,enumValues:s,small:r!=="regular"}):o.jsx(o.Fragment,{children:e})}else return o.jsx(o.Fragment,{children:e})}const Ln="ArrayOfStorageComponentsPreview",Ko={arrayWrap:`${Ln}-arrayWrap`,arrayItem:`${Ln}-arrayItem`},Yl=ge.styled("div")(({theme:e})=>({[`&.${Ko.arrayWrap}`]:{display:"flex",flexWrap:"wrap"},[`& .${Ko.arrayItem}`]:{margin:e.spacing(.5)}}));function On({propertyKey:e,entity:t,value:r,property:n,size:s}){const i=oe(),l=_e({propertyKey:e,property:n,propertyValue:r,fields:i.fields});if(Array.isArray(l.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(l.dataType!=="array"||!l.of||l.of.dataType!=="string")throw Error("Picked wrong preview component ArrayOfStorageComponentsPreview");const a=s==="regular"?"small":"tiny";return o.jsx(Yl,{className:Ko.arrayWrap,children:r&&r.map((A,u)=>o.jsx("div",{className:Ko.arrayItem,children:o.jsx(ne,{children:o.jsx(xe,{propertyKey:e,value:A,entity:t,property:l.of,size:a})})},`preview_array_storage_${e}_${u}`))})}function Gn({propertyKey:e,value:t,property:r,size:n}){const s=oe(),i=_e({propertyKey:e,property:r,propertyValue:t,fields:s.fields});if(Array.isArray(i?.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(i?.dataType!=="array"||!i.of||i.of.dataType!=="reference")throw Error("Picked wrong preview component ArrayOfReferencesPreview");const l=n==="regular"?"small":"tiny";return o.jsx(c.Box,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:t&&t.map((a,A)=>{const u=i.of;return o.jsx(c.Box,{sx:{marginTop:.25,marginBottom:.25,width:"100%"},children:o.jsx(Ke,{disabled:!u.path,previewProperties:u.previewProperties,size:l,reference:a})},`preview_array_ref_${e}_${A}`)})})}function $n({propertyKey:e,value:t,property:r,entity:n,size:s}){if(r.dataType!=="map")throw Error("Picked wrong preview component MapPropertyPreview");const i=r;if(!i.properties)throw Error(`You need to specify a 'properties' prop (or specify a custom field) in your map property ${e}`);if(!t)return null;let l;return s==="regular"?l=Object.keys(i.properties):(l=i.previewProperties||Object.keys(i.properties),s==="small"?l=l.slice(0,3):s==="tiny"&&(l=l.slice(0,1))),s!=="regular"?o.jsx(c.Box,{sx:a=>({width:"100%",display:"flex",flexDirection:"column","& > *":{[a.breakpoints.down("md")]:{marginBottom:`${a.spacing(.5)} !important`},marginBottom:`${a.spacing(1)} !important`}}),children:l.map((a,A)=>o.jsx("div",{children:o.jsx(ne,{children:o.jsx(xe,{propertyKey:a,value:t[a],property:i.properties[a],entity:n,size:s})},"map_preview_"+i.name+a+A)},`map_${a}`))}):o.jsx(c.Table,{size:"small",children:o.jsx(c.TableBody,{children:l&&l.map((a,A)=>o.jsxs(c.TableRow,{sx:{"&:last-child th, &:last-child td":{borderBottom:0}},children:[o.jsx(c.TableCell,{sx:{verticalAlign:"top"},width:"30%",component:"th",children:o.jsx(c.Typography,{variant:"caption",color:"textSecondary",children:i.properties[a].name})},`table-cell-title-${e}-${a}`),o.jsx(c.TableCell,{width:"70%",component:"th",children:o.jsx(ne,{children:o.jsx(xe,{propertyKey:a,value:t[a],property:i.properties[a],entity:n,size:"small"})})},`table-cell-${e}-${a}`)]},`map_preview_table_${e}_${A}`))})},`map_preview_${e}`)}function jt({propertyKey:e,value:t,property:r,entity:n,size:s}){const i=oe(),l=_e({propertyKey:e,property:r,propertyValue:t,fields:i.fields});if(!l.of)throw Error(`You need to specify an 'of' prop (or specify a custom field) in your array property ${e}`);if(l.dataType!=="array")throw Error("Picked wrong preview component ArrayPreview");const a=t;if(!a)return null;const A=s==="regular"?"small":"tiny";return o.jsx(c.Box,{sx:{display:"flex",flexDirection:"column"},children:a&&a.map((u,f)=>{const h=l.resolvedProperties[f]??l.resolvedProperties[f]??(Array.isArray(l.of)?l.of[f]:l.of);return h?o.jsxs(d.Fragment,{children:[o.jsx(c.Box,{sx:{margin:1},children:o.jsx(ne,{children:o.jsx(xe,{propertyKey:e,entity:n,value:u,property:h,size:A})})}),f<a.length-1&&o.jsx(c.Divider,{})]},"preview_array_"+u+"_"+f):null})})}const To="type",Jt="value",qt="ArrayOneOfPreview",Do={array:`${qt}-array`,arrayWrap:`${qt}-arrayWrap`,arrayItemBig:`${qt}-arrayItemBig`},zl=ge.styled("div")(({theme:e})=>({[`&.${Do.array}`]:{display:"flex",flexDirection:"column"},[`& .${Do.arrayWrap}`]:{display:"flex",flexWrap:"wrap"},[`& .${Do.arrayItemBig}`]:{margin:e.spacing(1)}}));function Vn({propertyKey:e,value:t,property:r,size:n,entity:s}){const i=oe(),l=_e({propertyKey:e,property:r,propertyValue:t,fields:i.fields});if(l?.dataType!=="array")throw Error("Picked wrong preview component ArrayPreview");if(!l?.oneOf)throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${e}`);const a=t;if(!a)return null;const A=n==="regular"?"small":"tiny",u=l.oneOf.typeField??To,f=l.oneOf.valueField??Jt,h=l.oneOf.properties;return o.jsx(zl,{className:Do.array,children:a&&a.map((b,v)=>o.jsxs(d.Fragment,{children:[o.jsx("div",{className:Do.arrayItemBig,children:o.jsx(ne,{children:b&&o.jsx(xe,{propertyKey:e,value:b[f],entity:s,property:l.resolvedProperties[v]??h[b[u]],size:A})})}),v<a.length-1&&o.jsx(c.Divider,{})]},"preview_array_"+b+"_"+v))})}const Ul=40,Nl=100,Hl=200;function co(e){if(e==="tiny")return Ul;if(e==="small")return Nl;if(e==="regular")return Hl;throw Error("Thumbnail size not mapped")}function Ze(e){switch(e){case"xs":case"s":return"tiny";case"m":return"small";case"l":case"xl":return"regular";default:throw Error("Missing mapping value in getPreviewSizeFrom")}}function Xe({property:e,size:t}){e||console.error("No property assigned for skeleton component",e,t);let r;if(e.dataType==="string"){const n=e;n.url?r=Xl(n,t):n.storage?r=Xt(t):r=Qe()}else if(e.dataType==="array"){const n=e;n.of&&(Array.isArray(n.of)?r=o.jsxs(o.Fragment,{children:[n.of.map((s,i)=>Zt(s,i))," "]}):n.of.dataType==="map"&&n.of.properties?r=jl(n.of.properties,t,n.of.previewProperties):n.of.dataType==="string"?n.of.enumValues?r=ql():n.of.storage?r=Zt(n.of):r=Jl():r=Zt(n.of))}else e.dataType==="map"?r=_l(e,t):e.dataType==="date"?r=Qe():e.dataType==="reference"?r=Zl():(e.dataType,r=Qe());return r||null}function _l(e,t){if(!e.properties)return o.jsx(o.Fragment,{});let r;return t==="regular"?r=Object.keys(e.properties):(r=e.previewProperties||Object.keys(e.properties),t==="small"?r=r.slice(0,3):t==="tiny"&&(r=r.slice(0,1))),t!=="regular"?o.jsx(c.Box,{sx:n=>({width:"100%",display:"flex",flexDirection:"column","& > *":{[n.breakpoints.down("md")]:{marginBottom:`${n.spacing(.5)} !important`},marginBottom:`${n.spacing(1)} !important`}}),children:r.map((n,s)=>o.jsx("div",{children:e.properties&&e.properties[n]&&o.jsx(Xe,{property:e.properties[n],size:"small"})},`map_${n}`))}):o.jsx(c.Table,{size:"small",children:o.jsx(c.TableBody,{children:r&&r.map((n,s)=>o.jsxs(c.TableRow,{sx:{"&:last-child th, &:last-child td":{borderBottom:0}},children:[o.jsx(c.TableCell,{sx:{verticalAlign:"top"},width:"30%",component:"th",children:o.jsx(c.Typography,{variant:"caption",color:"textSecondary",children:e.properties[n].name})},`table-cell-title--${n}`),o.jsx(c.TableCell,{width:"70%",component:"th",children:e.properties&&e.properties[n]&&o.jsx(Xe,{property:e.properties[n],size:"small"})},`table-cell-${n}`)]},`map_preview_table__${s}`))})})}function jl(e,t,r){let n=r;return(!n||!n.length)&&(n=Object.keys(e),t&&(n=n.slice(0,3))),o.jsx(c.Table,{size:"small",children:o.jsx(c.TableBody,{children:[0,1,2].map((s,i)=>o.jsx(c.TableRow,{children:n&&n.map(l=>o.jsx(c.TableCell,{component:"th",children:o.jsx(Xe,{property:e[l],size:"small"})},`table-cell-${l}`))},`table_${s}_${i}`))})})}function Jl(){return o.jsx(c.Grid,{children:[0,1].map((e,t)=>Qe(t))})}function ql(){return o.jsx(c.Grid,{children:[0,1].map((e,t)=>o.jsx(o.Fragment,{children:Qe(t)}))})}function Zt(e,t=0){return o.jsx(c.Grid,{children:[0,1].map((r,n)=>o.jsx(o.Fragment,{children:o.jsx(Xe,{property:e,size:"small"},`i_${n}`)}))},"array_index")}function Xt(e){const t=e==="tiny"?40:e==="small"?100:200;return o.jsx(c.Skeleton,{variant:"rectangular",sx:r=>({borderRadius:`${r.shape.borderRadius}px`}),width:t,height:t})}function Zl(){return o.jsx(c.Skeleton,{variant:"rectangular",width:200,height:100})}function Xl(e,t="regular"){return typeof e.url=="boolean"?o.jsxs("div",{style:{display:"flex"},children:[Kt(),Qe()]}):Kl(t)}function Kl(e){return o.jsx(c.Box,{sx:{width:co(e),height:co(e)},children:Kt()})}function Qe(e){return o.jsx(c.Skeleton,{variant:"text"},`skeleton_${e}`)}function Rl(e){return o.jsx(c.Skeleton,{height:20,variant:"text"})}function Kt(){return o.jsx(c.Skeleton,{variant:"rectangular",width:24,height:24})}const ea=Ce.memo(function({builder:t}){const[r,n]=d.useState(!0),[s,i]=d.useState(null);return d.useEffect(()=>{let l=!1;return t.then(a=>{l||(n(!1),i(a))}).catch(a=>{n(!1),console.error(a)}),()=>{l=!0}},[t]),r?o.jsx(c.Skeleton,{variant:"text"}):o.jsx(Ce.Fragment,{children:s})}),oa="MMMM dd, yyyy, HH:mm:ss";function Wn({date:e}){const t=oe(),r=t?.locale?un[t?.locale]:void 0,n=t?.dateTimeFormat??oa,s=e?Xs(e,n,{locale:r}):"";return o.jsx(o.Fragment,{children:s})}function Yn({size:e,url:t}){const[r,n]=d.useState(!1),s=d.useMemo(()=>co(e),[e]),i=c.useTheme();if(e==="tiny")return o.jsx("img",{src:t,style:{position:"relative",objectFit:"cover",width:s,height:s,borderRadius:i.shape.borderRadius,maxHeight:"100%"}},"tiny_image_preview_"+t);const l={maxWidth:"100%",maxHeight:"100%",borderRadius:i.shape.borderRadius};return o.jsxs(c.Box,{sx:{position:"relative",maxWidth:"100%",maxHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",width:s,height:s},onMouseEnter:()=>n(!0),onMouseMove:()=>n(!0),onMouseLeave:()=>n(!1),children:[o.jsx("img",{src:t,style:l}),r&&o.jsxs(o.Fragment,{children:[navigator&&o.jsx(c.Tooltip,{title:"Copy url to clipboard",children:o.jsx(c.Box,{sx:{borderRadius:"9999px",position:"absolute",bottom:-4,right:32,backgroundColor:i.palette.background.default},children:o.jsx(c.IconButton,{size:"small",onClick:a=>(a.stopPropagation(),navigator.clipboard.writeText(t)),children:o.jsx(St,{htmlColor:"#666",fontSize:"small"})})})}),o.jsx(c.Tooltip,{title:"Open image in new tab",children:o.jsx("a",{style:{borderRadius:"9999px",position:"absolute",bottom:-4,right:-4,backgroundColor:i.palette.background.default},href:t,rel:"noopener noreferrer",target:"_blank",children:o.jsx(c.IconButton,{size:"small",onClick:a=>a.stopPropagation(),children:o.jsx(xo,{htmlColor:"#666",fontSize:"small"})})})})]})]},"image_preview_"+t)}function Ro({url:e,previewType:t,size:r,hint:n}){return t?t==="image"?o.jsx(Yn,{url:e,size:r},`image_preview_${e}_${r}`):t==="audio"?o.jsxs("audio",{controls:!0,src:e,children:["Your browser does not support the",o.jsx("code",{children:"audio"})," element."]},`audio_preview_${e}_${r}`):t==="video"?o.jsx(c.CardMedia,{sx:{maxWidth:r==="small"?300:500},component:"video",controls:!0,image:e},`video_preview_${e}_${r}`):o.jsx("a",{href:e,rel:"noopener noreferrer",target:"_blank",onClick:s=>s.stopPropagation(),children:o.jsxs(c.Box,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:co(r),height:co(r)},children:[o.jsx(Ks,{sx:{flexGrow:1}}),n&&o.jsx(c.Tooltip,{title:n,children:o.jsx(c.Typography,{sx:{maxWidth:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",direction:"rtl",textAlign:"left"},variant:"caption",children:n})})]})},`link_preview_${e}_${r}`):o.jsxs(c.Link,{sx:s=>({display:"flex",wordBreak:"break-word",fontWeight:s.typography.fontWeightMedium}),href:e,onMouseDown:s=>{s.preventDefault()},target:"_blank",children:[o.jsx(xo,{style:{marginRight:8},fontSize:"small"}),e]})}const zn=d.memo(Nn,ta);function ta(e,t){return e.size===t.size&&e.storagePathOrDownloadUrl===t.storagePathOrDownloadUrl&&e.storeUrl===t.storeUrl}const Un={};function Nn({storeUrl:e,storagePathOrDownloadUrl:t,size:r}){const n=lo(),[s,i]=d.useState(Un[t]);if(d.useEffect(()=>{if(!t)return;let A=!1;return n.getDownloadURL(t).then(function(u){A||(i(u),Un[t]=u)}),()=>{A=!0}},[t]),!t)return null;const l=s?.metadata?ra(s?.metadata.contentType):void 0,a=l?.startsWith("image")?"image":l?.startsWith("video")?"video":l?.startsWith("audio")?"audio":"file";return s?o.jsx(Ro,{previewType:a,url:s.url,size:r,hint:t}):Xt(r)}function ra(e){return e.startsWith("image")?"image/*":e.startsWith("video")?"video/*":e.startsWith("audio")?"audio/*":e.startsWith("application")?"application/*":e.startsWith("text")?"text/*":e.startsWith("font")?"font/*":e}function Hn({value:e}){return e?o.jsx(ye.CheckBox,{color:"secondary"}):o.jsx(ye.CheckBoxOutlineBlank,{color:"disabled"})}const na=new rn({html:!0}),et=d.memo(function({source:t}){const r=d.useMemo(()=>na.render(typeof t=="string"?t:""),[t]);return o.jsx("div",{dangerouslySetInnerHTML:{__html:r}})},ia);function ia(e,t){return e.source===t.source}function Ao(){return o.jsx(c.Box,{sx:{borderRadius:"9999px",backgroundColor:"rgba(128,128,128,0.1)",width:"18px",height:"6px",display:"inline-block"}})}const Ke=Ce.memo(la,sa);function sa(e,t){return e.disabled===t.disabled&&e.size===t.size&&e.onHover===t.onHover&&e.reference?.id===t.reference?.id&&e.reference?.path===t.reference?.path&&e.allowEntityNavigation===t.allowEntityNavigation}function la({disabled:e,reference:t,previewProperties:r,size:n,onHover:s,onClick:i,allowEntityNavigation:l=!0}){const a=oe(),A=he(),u=Ne(),f=A.getCollection(t.path);if(!f)throw Error(`Couldn't find the corresponding collection view for the path: ${t.path}`);const{entity:h,dataLoading:b,dataLoadingError:v}=_o({path:t.path,entityId:t.id,collection:f,useCache:!0});h&&_n.set(t.pathWithId,h);const g=h??_n.get(t.pathWithId),p=d.useMemo(()=>pe({collection:f,path:t.path,values:g?.values,fields:a.fields}),[f]),w=d.useMemo(()=>mr(p,a.fields,r,n==="small"||n==="regular"?3:1),[r,p,n]);let C;return p?(t?t instanceof Me?g&&!g.values?C=o.jsx(ue,{error:"Reference does not exist",tooltip:t.path}):C=o.jsxs(o.Fragment,{children:[o.jsxs(c.Box,{sx:{display:"flex",flexDirection:"column",flexGrow:1,maxWidth:"calc(100% - 52px)",margin:1},children:[n!=="tiny"&&(t?o.jsx(c.Box,{sx:{display:n!=="regular"?"block":void 0,whiteSpace:n!=="regular"?"nowrap":void 0,overflow:n!=="regular"?"hidden":void 0,textOverflow:n!=="regular"?"ellipsis":void 0},children:o.jsx(c.Typography,{variant:"caption",className:"mono",children:t.id})}):o.jsx(c.Skeleton,{variant:"text"})),w&&w.map(x=>{const B=p.properties[x];return B?o.jsx(c.Box,{sx:{my:w.length>1?.5:0},children:g?o.jsx(xe,{propertyKey:x,value:Ve(g.values,x),property:B,entity:g,size:"tiny"}):o.jsx(Xe,{property:B,size:"tiny"})},"ref_prev_"+x):null})]}),o.jsx(c.Box,{sx:{my:n==="tiny"?.5:1},children:!e&&g&&l&&o.jsx(c.Tooltip,{title:`See details for ${g.id}`,children:o.jsx(c.IconButton,{color:"inherit",size:"small",onClick:x=>{x.stopPropagation(),a.onAnalyticsEvent?.("entity_click_from_reference",{path:g.path,entityId:g.id}),u.open({entityId:g.id,path:g.path,collection:p,updateUrl:!0})},children:o.jsx(It,{fontSize:"small"})})})})]}):(console.error("Reference preview received value of type",typeof t),C=o.jsx(ue,{error:"Unexpected value",tooltip:JSON.stringify(t)})):C=o.jsx(ue,{error:"Reference not set"}),o.jsx(aa,{onClick:e?void 0:i,onHover:e?void 0:s,size:n,children:C})):o.jsx(ue,{error:"Could not find collection with id "+p})}function aa({children:e,onHover:t,size:r,onClick:n}){return o.jsx(c.Typography,{variant:"label",sx:s=>{const i=n?{tabindex:0,backgroundColor:t?s.palette.mode==="dark"?c.lighten(s.palette.background.default,.1):c.darken(s.palette.background.default,.15):c.darken(s.palette.background.default,.1),transition:"background-color 300ms ease, box-shadow 300ms ease",boxShadow:t?"0 0 0 2px rgba(128,128,128,0.05)":void 0,cursor:t?"pointer":void 0}:{};return{width:"100%",display:"flex",backgroundColor:c.darken(s.palette.background.default,.1),borderRadius:`${s.shape.borderRadius}px`,overflow:"hidden",padding:r==="regular"?1:0,itemsAlign:r==="tiny"?"center":void 0,...i}},onClick:s=>{n&&(s.preventDefault(),n())},children:e})}const _n=new Map,jn=(e,...t)=>({...t.reduce((r,n)=>({...r,[n]:e[n]}),{})});function ot(e){return e&&typeof e=="object"&&!Array.isArray(e)}function Le(e,t){const r=ot(e),n=r?{...e}:e;return r&&ot(t)&&Object.keys(t).forEach(s=>{ot(t[s])?s in e?n[s]=Le(e[s],t[s]):Object.assign(n,{[s]:t[s]}):Object.assign(n,{[s]:t[s]})}),n}function Ve(e,t){if(e&&typeof e=="object"){if(t in e)return e[t];if(t.includes(".")){const r=t.split(".");return Ve(e[r[0]],r.slice(1).join("."))}}}function ca(e,t){let r={...e};const n=t.split("."),s=n.pop();for(const i of n)r=r[i];return s&&delete r[s],r}function Rt(e){return typeof e=="object"?Object.entries(e).filter(([t,r])=>typeof r!="function").map(([t,r])=>Array.isArray(r)?{[t]:r.map(n=>Rt(n))}:typeof r=="object"?{[t]:Rt(r)}:{[t]:r}).reduce((t,r)=>({...t,...r}),{}):e}function er(e){if(!e)return null;if(typeof e=="object"){if("id"in e)return e.id;if(e instanceof Date)return e.toLocaleString();if(e instanceof Fo)return Xr(e)}return Xr(e,{ignoreUnknown:!0})}function or(e){if(typeof e=="function")return e;if(Array.isArray(e))return e.map(t=>or(t));if(typeof e=="object"){const t={};return Object.keys(e).forEach(r=>{if(!tr(e)){const n=or(e[r]);n!==void 0&&!tr(n)&&(t[r]=n)}}),t}return e}function tr(e){return e&&Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length===0}function uo(e){return e.readOnly||e.dataType==="date"&&e.autoValue?!0:e.dataType==="reference"?!e.path:!1}function tt(e){return typeof e.disabled=="object"&&!!e.disabled.hidden}function Te(e){return typeof e=="function"}function Po(e){return e?Object.entries(e).map(([t,r])=>{const n=da(r);return n===void 0?{}:{[t]:n}}).reduce((t,r)=>({...t,...r}),{}):{}}function da(e){if(!Te(e))if(e.dataType==="map"&&e.properties){const t=Po(e.properties);return Object.keys(t).length===0?void 0:t}else return e.defaultValue}function Jn({inputValues:e,properties:t,status:r,timestampNowValue:n,setDateToMidnight:s}){return rr(e,t,(i,l)=>{if(l.dataType==="date"){let a;return r==="existing"&&l.autoValue==="on_update"||(r==="new"||r==="copy")&&(l.autoValue==="on_update"||l.autoValue==="on_create")?a=n:a=i,l.mode==="date"&&(a=s(a)),a}else return i})??{}}function qn(e,t){const r=e;return Object.entries(t).forEach(([n,s])=>{e&&e[n]!==void 0?r[n]=e[n]:s.validation?.required&&(r[n]=null)}),r}function Re(e){return new Me(e.id,e.path)}function rr(e,t,r){const n=Object.entries(t).map(([i,l])=>{const a=e&&e[i],A=rt(a,l,r);if(A!==void 0)return{[i]:A}}).reduce((i,l)=>({...i,...l}),{}),s={...e,...n};if(Object.keys(s).length!==0)return s}function rt(e,t,r){let n;if(t.dataType==="map"&&t.properties)n=rr(e,t.properties,r);else if(t.dataType==="array")if(t.of&&Array.isArray(e))n=e.map(s=>rt(s,t.of,r));else if(t.oneOf&&Array.isArray(e)){const s=t.oneOf?.typeField??To,i=t.oneOf?.valueField??Jt;n=e.map(l=>{if(l===null)return null;if(typeof l!="object")return l;const a=l[s],A=t.oneOf?.properties[a];return!a||!A?l:{[s]:a,[i]:rt(l[i],A,r)}})}else n=e;else n=r(e,t);return n}function nr(e,t){const r=e.subcollections?.map(s=>{const i=t.subcollections?.find(l=>l.path===s.path)??t.subcollections?.find(l=>l.alias===s.alias);return i?nr(s,i):s}),n=Le(e,t);return{...n,subcollections:r,properties:ir(n.properties,n.propertiesOrder)}}function Aa(e,t){const r=e.map(i=>({...i,editable:!0,deletable:!0})),n=(t??[]).map(i=>{const l=r?.find(a=>a.path===i.path)??r?.find(a=>a.alias===i.alias);return l?{...nr(i,l),deletable:!1}:{...i,deletable:!1}}),s=r.filter(i=>!n.map(l=>l.path).includes(i.path)||!n.map(l=>l.alias).includes(i.alias));return[...n,...s]}function ir(e,t){try{const r=Object.keys(e);return(t??r).map(s=>{if(e[s]){const i=e[s];return!Te(i)&&i?.dataType==="map"&&i.properties?{[s]:{...i,properties:ir(i.properties,i.propertiesOrder)}}:{[s]:i}}else return}).filter(s=>s!==void 0).reduce((s,i)=>({...s,...i}),{})}catch(r){return console.error("Error sorting properties",r),e}}const ua=/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g,fa=e=>{const t=e.match(ua);return t?t.map(r=>r.toLowerCase()).join("-"):""},ga=/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g,ha=e=>{const t=e.match(ga);return t?t.map(r=>r.toLowerCase()).join("_"):""};function fo(e=5){return Math.random().toString(36).slice(2,2+e)}function pa(){return Math.floor(Math.random()*16777215).toString(16)}const Zn="::";function sr(e){return Xn(We(e))}function Xn(e){return e.length===1?e[0]:e.reduce((t,r)=>`${t}${Zn}${r}`)}function We(e){return e.split("/").filter((t,r)=>r%2===0)}function ba(e){return e?e.toString():""}function Kn(e){if(!e)return;const t=e.match(/\/(.*?)\/([a-z]*)?$/i);return t?new RegExp(t[1],t[2]||""):new RegExp(e,"")}function va(e){return e.match(/\/((?![*+?])(?:[^\r\n[/\\]|\\.|\[(?:[^\r\n\]\\]|\\.)*])+)\/((?:g(?:im?|mi?)?|i(?:gm?|mg?)?|m(?:gi?|ig?)?)?)/)?!0:!!e.match(/((?![*+?])(?:[^\r\n[/\\]|\\.|\[(?:[^\r\n\]\\]|\\.)*])+)/)}function lr(e,t,r=300){const n=d.useRef(!1),s=d.useCallback(()=>{t(),n.current=!1},[t]);d.useEffect(()=>{n.current=!0;const i=setTimeout(s,r);return()=>{clearTimeout(i),n.current&&s()}},[e])}function ya(e,t=300){const[r,n]=d.useState(e);return d.useEffect(()=>{const s=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(s)}},[e,t]),r}function nt({name:e,addLabel:t,value:r,disabled:n,buildEntry:s,small:i,onInternalIdAdded:l,includeAddButton:a,newDefaultEntry:A=null}){const u=r&&Array.isArray(r)&&r.length>0,f=d.useMemo(()=>u?r.map((p,w)=>p?{[er(p)+w]:it()}:{}).reduce((p,w)=>({...p,...w}),{}):{},[r,u]),h=d.useRef(new Set(Object.values(f))),b=d.useRef(f),[v,g]=d.useState(u?Object.values(b.current):[]);return d.useEffect(()=>{if(u&&r&&r.length!==v.length){const p=r.map((w,C)=>{const x=er(w)+C;if(x in b.current)return b.current[x];{const B=it();return b.current[x]=B,B}});g(p)}},[u,v.length,r]),o.jsx(we.FieldArray,{name:e,validateOnChange:!0,render:p=>o.jsx(wa,{disabled:n,internalIds:v,onInternalIdAdded:l,setInternalIds:g,arrayHelpers:p,newDefaultEntry:A,value:r,name:e,small:i,buildEntry:s,hasValue:u,includeAddButton:a,addLabel:t,animatedIds:h})})}function wa({disabled:e,internalIds:t,onInternalIdAdded:r,setInternalIds:n,arrayHelpers:s,newDefaultEntry:i,value:l,name:a,small:A,buildEntry:u,hasValue:f,includeAddButton:h,addLabel:b,animatedIds:v}){const g=d.useCallback(()=>{if(e)return;const x=it(),B=[...t,x];r&&r(x),n(B),s.push(i)},[s,e,t,i,r,n]),p=d.useCallback(x=>{const B=[...t];B.splice(x,1),n(B),v.current.delete(t[x]),s.remove(x)},[s,t,n]),w=d.useCallback(x=>{const B=it(),E=l[x],m=[...t.splice(0,x+1),B,...t.splice(x+1,t.length-x-1)];r&&r(B),n(m),s.insert(x+1,E)},[s,t,r,n,l]),C=d.useCallback(x=>{if(!x.destination)return;const B=x.source.index,E=x.destination.index,m=[...t],k=m[B];m[B]=m[E],m[E]=k,n(m),s.move(B,E)},[s,t,n]);return o.jsx(io.DragDropContext,{onDragEnd:C,children:o.jsx(io.Droppable,{droppableId:`droppable_${a}`,renderClone:(x,B,E)=>{const m=E.source.index,k=t[m];return o.jsx(Rn,{provided:x,internalId:k,index:m,name:a,small:A,disabled:e,buildEntry:u,remove:p,copy:w,animatedIds:v})},children:(x,B)=>o.jsxs("div",{...x.droppableProps,ref:x.innerRef,children:[f&&t.map((E,m)=>o.jsx(io.Draggable,{draggableId:`array_field_${a}_${E}`,isDragDisabled:e,index:m,children:(k,S)=>o.jsx(Rn,{provided:k,internalId:E,index:m,name:a,small:A,disabled:e,buildEntry:u,remove:p,copy:w,animatedIds:v})},`array_field_${a}_${E}`)),x.placeholder,h&&o.jsx(c.Box,{p:1,justifyContent:"center",textAlign:"left",children:o.jsx(c.Button,{variant:"outlined",size:"large",color:"primary",disabled:e,startIcon:o.jsx(js,{}),onClick:g,children:b??"Add"})})]})})})}function Rn({provided:e,index:t,name:r,internalId:n,small:s,disabled:i,buildEntry:l,remove:a,copy:A,animatedIds:u}){const[f,h]=Ft(),b=h.height<100;return o.jsx(c.Box,{ref:e.innerRef,...e.draggableProps,style:e.draggableProps.style,sx:v=>({marginBottom:1,borderRadius:v.shape.borderRadius,opacity:1}),children:o.jsxs(c.Box,{display:"flex",children:[o.jsx(c.Box,{ref:f,flexGrow:1,width:"calc(100% - 48px)",children:l(t,n)}),o.jsx(Ca,{direction:s?"row":"column",disabled:i,remove:a,index:t,provided:e,smallContent:b,copy:A})]})})}function Ca({direction:e,disabled:t,remove:r,index:n,provided:s,copy:i,smallContent:l}){const[a,A]=d.useState(null),u=d.useCallback(h=>{A(h.currentTarget),h.stopPropagation()},[A]),f=d.useCallback(()=>{A(null)},[A]);return o.jsxs(c.Box,{display:"flex",flexDirection:e??"column",sx:{pl:1},alignItems:"center",children:[o.jsx("div",{...s.dragHandleProps,children:o.jsx(c.Tooltip,{placement:e==="column"?"left":void 0,title:"Move",children:o.jsx(c.IconButton,{size:"small",disabled:t,sx:{cursor:t?"inherit":"move"},children:o.jsx(Js,{fontSize:"small",color:t?"disabled":"inherit"})})})}),!l&&o.jsxs(o.Fragment,{children:[o.jsx(c.Tooltip,{title:"Remove",placement:e==="column"?"left":void 0,children:o.jsx(c.IconButton,{size:"small","aria-label":"remove",disabled:t,onClick:()=>r(n),children:o.jsx(kt,{fontSize:"small"})})}),o.jsx(c.Tooltip,{placement:e==="column"?"left":void 0,title:"Copy in this position",children:o.jsx(c.IconButton,{size:"small","aria-label":"copy",disabled:t,onClick:()=>i(n),children:o.jsx(St,{fontSize:"small"})})})]}),l&&o.jsxs(o.Fragment,{children:[o.jsx(c.IconButton,{onClick:u,size:"small",children:o.jsx(ye.MoreVert,{})}),o.jsxs(c.Menu,{anchorEl:a,open:!!a,onClose:f,elevation:3,children:[o.jsxs(c.MenuItem,{dense:!0,onClick:()=>r(n),children:[o.jsx(c.ListItemIcon,{children:o.jsx(kt,{})}),o.jsx(c.ListItemText,{primary:"Remove"})]}),o.jsxs(c.MenuItem,{dense:!0,onClick:()=>i(n),children:[o.jsx(c.ListItemIcon,{children:o.jsx(St,{})}),o.jsx(c.ListItemText,{primary:"Copy"})]})]})]})]})}function it(){return Math.floor(Math.random()*Math.floor(Number.MAX_SAFE_INTEGER))}function Be({property:e}){const t=typeof e.disabled=="object"?e.disabled.disabledMessage:void 0;return o.jsxs(c.Box,{display:"flex",children:[o.jsx(c.Box,{flexGrow:1,children:o.jsx(c.FormHelperText,{children:t||e.description})}),e.longDescription&&o.jsx(c.Tooltip,{title:o.jsx(c.Typography,{variant:"caption",children:e.longDescription}),placement:"bottom-start",arrow:!0,children:o.jsx(c.IconButton,{edge:"start",size:"small",sx:{alignSelf:"flex-start"},children:o.jsx(qs,{color:"disabled",fontSize:"small"})})})]})}function Ee({icon:e,title:t,small:r,sx:n}){return o.jsxs(c.Box,{sx:{display:"inline-flex",marginBottom:"2px",alignItems:"center",gap:r?1:1.5,...n},component:"span",children:[e,o.jsx(c.Typography,{component:"span",sx:{fontWeight:500,fontSize:r?"1rem":".85rem",transformOrigin:"left top",transform:r?"translate(8px, 0px) scale(0.75)":void 0},children:t})]})}function xa(e){const t=d.useRef(),[r,n]=d.useState(e.value),s=d.useDeferredValue(r);d.useEffect(()=>{n(e.value)},[e.value]),d.useEffect(()=>{!e.value&&!s||s!==e.value&&t.current&&e.onChange&&e.onChange(t.current)},[s,e.value,e.onChange]);const i=d.useCallback(l=>{t.current=l,n(l.target.value)},[]);return o.jsx(c.TextField,{...e,onChange:i,value:r})}function Ba({field:e,form:t,label:r,tooltip:n,disabled:s,size:i="small"}){const l=o.jsx(c.FormControlLabel,{checked:e.value??!1,sx:{ml:0},disabled:s,control:o.jsx(c.Switch,{size:i,disabled:s,onChange:(a,A)=>t.setFieldValue(e.name,A)}),label:o.jsx(c.Typography,{variant:"body2",children:r})});return n?o.jsx(c.Tooltip,{title:n,children:l}):l}function ar({propertyKey:e,value:t,setValue:r,error:n,showError:s,disabled:i,autoFocus:l,touched:a,property:A,includeDescription:u}){const f=A.enumValues;ke({property:A,value:t,setValue:r});const h=d.useCallback(()=>{r(null)},[r]);return o.jsxs(c.FormControl,{fullWidth:!0,required:A.validation?.required,error:s,disabled:i,sx:{"& .MuiInputLabel-root":{mt:1/2,ml:1/2},"& .MuiInputLabel-shrink":{mt:2}},children:[o.jsx(c.InputLabel,{id:`${e}-select-label`,children:o.jsx(Ee,{icon:ve(A),title:A.name})}),o.jsx(c.Select,{sx:b=>({minHeight:"64px",borderRadius:`${b.shape.borderRadius}px`}),variant:"filled",labelId:`${e}-select-label`,autoFocus:l,value:t??"",disabled:i,disableUnderline:!0,endAdornment:A.clearable&&o.jsx(c.IconButton,{sx:{position:"absolute",top:"12px",right:"32px"},onClick:h,children:o.jsx(Pe,{})}),onChange:b=>{const v=b.target.value,g=v?A.dataType==="number"?parseFloat(v):v:null;return r(g)},renderValue:b=>o.jsx(Fe,{enumKey:b,enumValues:f,small:!1}),children:f&&f.map(b=>o.jsx(c.MenuItem,{value:b.id,disabled:Zo(b),children:o.jsx(Fe,{enumKey:b.id,enumValues:f,small:!0})},`select_${e}_${b.id}`))}),u&&o.jsx(Be,{property:A}),s&&o.jsx(c.FormHelperText,{error:!0,children:n})]})}function cr({propertyKey:e,value:t,setValue:r,error:n,showError:s,disabled:i,property:l,includeDescription:a,autoFocus:A}){const u=l.of;if(!u)throw Error("Using wrong component ArrayEnumSelect");if(Array.isArray(u))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if(u.dataType!=="string"&&u.dataType!=="number")throw Error("Field misconfiguration: array field of type string or number");const f=u.enumValues;if(!f)throw console.error(l),Error("Field misconfiguration: array field of type string or number needs to have enumValues");ke({property:l,value:t,setValue:r});const h=d.useCallback(()=>{r(null)},[r]);if(f instanceof Error)return o.jsx(ue,{error:f.message});const b=!!t&&Array.isArray(t);return o.jsxs(c.FormControl,{fullWidth:!0,required:l.validation?.required,error:s,sx:{"& .MuiInputLabel-root":{mt:1/2,ml:1/2},"& .MuiInputLabel-shrink":{mt:2}},children:[o.jsx(c.InputLabel,{id:`${e}-multiselect-label`,children:o.jsx(Ee,{icon:ve(l),title:l.name})}),o.jsx(c.Select,{multiple:!0,sx:v=>({minHeight:"64px",borderRadius:`${v.shape.borderRadius}px`}),variant:"filled",labelId:`${e}-multiselect-label`,value:b?t.map(v=>v.toString()):[],autoFocus:A,disabled:i,disableUnderline:!0,endAdornment:u.clearable&&o.jsx(c.IconButton,{sx:{position:"absolute",top:"12px",right:"32px"},onClick:h,children:o.jsx(Pe,{})}),onChange:v=>{let g;return u?.dataType==="number"?g=v.target.value?v.target.value.map(p=>parseFloat(p)):[]:g=v.target.value,r(g)},renderValue:v=>o.jsx(Xo,{value:v,name:e,enumValues:f,size:"regular"}),children:qo(f).map(v=>{const g=v.id,p=b&&t.map(w=>w.toString()).includes(g.toString());return o.jsxs(c.MenuItem,{value:g,disabled:Zo(v),dense:!0,children:[o.jsx(c.Checkbox,{checked:p}),o.jsx(c.ListItemText,{primary:o.jsx(Fe,{enumKey:g,enumValues:f,small:!0})})]},`form-select-${e}-${g}`)})}),a&&o.jsx(Be,{property:l}),s&&o.jsx(c.FormHelperText,{error:!0,children:n})]})}function ei({propertyKey:e,value:t,error:r,showError:n,isSubmitting:s,tableMode:i,property:l,includeDescription:a,setValue:A}){const u=l.of;if(u.dataType!=="reference")throw Error("ArrayOfReferencesField expected a property containing references");const f=l.expanded===void 0?!0:l.expanded,[h,b]=d.useState(!1),v=t&&Array.isArray(t)?t.map(k=>k.id):[];ke({property:l,value:t,setValue:A});const g=he(),p=d.useMemo(()=>u.path?g.getCollection(u.path):void 0,[u.path]);if(!p)throw Error(`Couldn't find the corresponding collection for the path: ${u.path}`);const w=d.useCallback(k=>{A(k.map(S=>Re(S)))},[A]),C=So({multiselect:!0,path:u.path,collection:p,onMultipleEntitiesSelected:w,selectedEntityIds:v,forceFilter:u.forceFilter}),x=d.useCallback(()=>{C.open()},[C]),B=d.useCallback((k,S)=>{const F=t&&t.length>k?t[k]:void 0;return F?o.jsx("div",{onMouseEnter:()=>b(!0),onMouseMove:()=>b(!0),onMouseLeave:()=>b(!1),children:o.jsx(Ke,{disabled:!u.path,previewProperties:u.previewProperties,size:"regular",onClick:x,reference:F,onHover:h})}):o.jsx("div",{children:"Internal ERROR"})},[u.path,u.previewProperties,h,t]),E=o.jsx(Ee,{icon:ve(l),title:l.name}),m=o.jsxs(o.Fragment,{children:[!p&&o.jsx(ue,{error:"The specified collection does not exist. Check console"}),p&&o.jsxs(o.Fragment,{children:[o.jsx(nt,{value:t,addLabel:l.name?"Add reference to "+l.name:"Add reference",name:e,buildEntry:B,disabled:s,newDefaultEntry:l.of.defaultValue}),o.jsx(c.Box,{p:1,justifyContent:"center",textAlign:"left",children:o.jsxs(c.Button,{variant:"outlined",color:"primary",disabled:s,onClick:x,children:["Edit ",l.name]})})]})]});return o.jsx(o.Fragment,{children:o.jsxs(c.FormControl,{fullWidth:!0,error:n,children:[!i&&o.jsx(to,{initiallyExpanded:f,title:E,children:m}),i&&m,a&&o.jsx(Be,{property:l}),n&&typeof r=="string"&&o.jsx(c.FormHelperText,{error:!0,children:r})]})})}async function Ea(e,t,r,n,s,i,l,a){let A;return typeof e=="function"?(A=await e({path:s,entityId:n,values:r,property:i,file:l,storage:t,propertyKey:a}),A||console.warn("Storage callback returned empty result. Using default name value")):A=oi(l,e,n,a,s),A||(A=fo()+"_"+l.name),A}function ma(e,t,r,n,s,i,l,a){let A;return typeof e=="function"?(A=e({path:s,entityId:n,values:r,property:i,file:l,storage:t,propertyKey:a}),A||console.warn("Storage callback returned empty result. Using default name value")):A=oi(l,e,n,a,s),A||(A=fo()+"_"+l.name),A}function oi(e,t,r,n,s){const i=e.name.split(".").pop();let l=t.replace("{entityId}",r).replace("{propertyKey}",n).replace("{rand}",fo()).replace("{file}",e.name).replace("{file.type}",e.type).replace("{path}",s);if(i){l=l.replace("{file.ext}",i);const a=e.name.replace(`.${i}`,"");l=l.replace("{file.name}",a)}return l||(l=fo()+"_"+e.name),l}function ti({entityId:e,entityValues:t,path:r,value:n,property:s,propertyKey:i,storageSource:l,disabled:a,onChange:A}){const u=s.dataType==="string"?s.storage:s.dataType==="array"&&s.of.dataType==="string"?s.of.storage:void 0,f=s.dataType==="array";if(!u)throw Error("Storage meta must be specified");const h=u?.metadata,b=f?"small":"regular",v=u?.imageCompression,g=(f?n??[]:n?[n]:[]).map(S=>({id:dr(),storagePathOrDownloadUrl:S,metadata:h,size:b})),[p,w]=d.useState(n),[C,x]=d.useState(g);d.useEffect(()=>{le(p,n)||(w(n),x(g))},[g,n,p]);const B=d.useCallback(async S=>{if(u.fileName){const F=await Ea(u.fileName,u,t,e,r,s,S,i);if(!F||F.length===0)throw Error("You need to return a valid filename");return F}return fo()+"_"+S.name},[e,t,r,s,i,u]),E=d.useCallback(S=>ma(u.storagePath,u,t,e,r,s,S,i)??"/",[e,t,r,s,i,u]),m=d.useCallback(async(S,F,I)=>{console.debug("onFileUploadComplete",S,F);let T=S;u.storeUrl&&(T=(await l.getDownloadURL(S)).url),u.postProcess&&(T=await u.postProcess(T));let P;F.storagePathOrDownloadUrl=T,F.metadata=I,P=[...C],P=ri(P),x(P);const M=P.filter(L=>!!L.storagePathOrDownloadUrl).map(L=>L.storagePathOrDownloadUrl);A(f?M:M?M[0]:null)},[C,f,A,u,l]),k=d.useCallback(async S=>{if(!S.length||a)return;let F;if(f)F=[...C,...await Promise.all(S.map(async I=>(v&&Ar(I)&&(I=await ii(I,v)),{id:dr(),file:I,fileName:await B(I),metadata:h,size:b})))];else{let I=S[0];v&&Ar(I)&&(I=await ii(I,v)),F=[{id:dr(),file:I,fileName:await B(I),metadata:h,size:b}]}F=ri(F),x(F)},[a,B,C,h,f,b]);return{internalValue:C,setInternalValue:x,storage:u,fileNameBuilder:B,storagePathBuilder:E,onFileUploadComplete:m,onFilesAdded:k,multipleFilesSupported:f}}function ri(e){return e.filter((t,r)=>(e.map(n=>n.storagePathOrDownloadUrl).indexOf(t.storagePathOrDownloadUrl)===r||!t.storagePathOrDownloadUrl)&&(e.map(n=>n.file).indexOf(t.file)===r||!t.file))}function dr(){return Math.floor(Math.random()*Math.floor(Number.MAX_SAFE_INTEGER))}const ni={"image/jpeg":"JPEG","image/png":"PNG","image/webp":"WEBP"},Ar=e=>ni[e.type]?ni[e.type]:null,ka=100,ii=(e,t)=>new Promise(r=>{const n=t.quality===void 0?ka:t.quality,s=n>=0&&n<=100?n:100,i=Ar(e);if(!i)throw Error("resizeAndCompressImage: Unsupported image format");xl.imageFileResizer(e,t.maxWidth||Number.MAX_VALUE,t.maxHeight||Number.MAX_VALUE,i,s,0,l=>r(l),"file")});function si({storagePath:e,entry:t,metadata:r,onFileUploadComplete:n,imageSize:s,simple:i}){const l=lo(),a=He(),[A,u]=d.useState(),[f,h]=d.useState(!1),b=d.useRef(!1),v=d.useRef(!1),g=d.useCallback((p,w)=>{v.current||(v.current=!0,u(void 0),h(!0),l.uploadFile({file:p,fileName:w,path:e,metadata:r}).then(async({path:C})=>{console.debug("Upload successful"),await n(C,t,r),b.current&&h(!1)}).catch(C=>{console.error("Upload error",C),b.current&&(u(C),h(!1),a.open({type:"error",message:"Error uploading file: "+C.message}))}).finally(()=>{v.current=!1}))},[t,r,n,l,e]);return d.useEffect(()=>(b.current=!0,t.file&&g(t.file,t.fileName),()=>{b.current=!1}),[t.file,t.fileName,g]),i?o.jsx(c.Box,{m:1,sx:{width:s,height:s},children:f&&o.jsx(c.Skeleton,{variant:"rectangular",sx:{width:s,height:s}})}):o.jsx(c.Box,{m:1,children:o.jsxs(c.Paper,{elevation:0,sx:{padding:1,boxSizing:"border-box",minWidth:s,minHeight:s},variant:"outlined",children:[f&&o.jsx(c.Skeleton,{variant:"rectangular",sx:{width:"100%",height:"100%"}}),A&&o.jsx(ue,{title:"Error uploading file",error:A})]})})}function li({name:e,property:t,value:r,entity:n,onRemove:s,disabled:i,size:l}){return o.jsx(c.Box,{m:1,position:"relative",children:o.jsxs(c.Paper,{elevation:0,sx:{padding:1,boxSizing:"border-box",minWidth:l==="regular"?220:118,minHeight:l==="regular"?220:118},variant:"outlined",children:[!i&&o.jsx(c.Box,{sx:a=>({position:"absolute",borderRadius:"9999px",top:-8,right:-8,zIndex:1,backgroundColor:a.palette.background.paper}),children:o.jsx(c.Tooltip,{title:"Remove",children:o.jsx(c.IconButton,{size:"small",onClick:a=>{a.stopPropagation(),s(r)},children:o.jsx(kt,{fontSize:"small"})})})}),r&&o.jsx(ne,{children:o.jsx(xe,{propertyKey:e,value:r,property:t,entity:n,size:l})})]})})}const eo=e=>e.palette.mode==="light"?"rgb(240 240 240)":"rgb(39 39 41)",ur=e=>e.palette.mode==="light"?"rgb(232 232 232)":"rgb(49,49,50)",Sa=e=>e.palette.mode==="light"?"rgb(224 224 224)":"rgb(47 47 49)",go="StorageUploadField",De={dropZone:`${go}-dropZone`,disabled:`${go}-disabled`,nonActiveDrop:`${go}-nonActiveDrop`,activeDrop:`${go}-activeDrop`,acceptDrop:`${go}-acceptDrop`,rejectDrop:`${go}-rejectDrop`},Fa=ge.styled(c.Box)(({theme:e})=>({[`&.${De.dropZone}`]:{position:"relative",paddingTop:"2px",border:"2px solid transparent",minHeight:"254px",outline:0,borderRadius:`${e.shape.borderRadius}px`,backgroundColor:eo(e),boxSizing:"border-box",transition:"border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","&:focus":{border:`2px solid ${e.palette.primary.main}`}},[`&.${De.disabled}`]:{backgroundColor:"rgba(0, 0, 0, 0.12)",color:e.palette.mode==="light"?"rgba(0, 0, 0, 0.38)":"rgba(255, 255, 255, 0.38)",border:`1px dotted ${e.palette.grey[400]}`},[`&.${De.nonActiveDrop}`]:{"&:hover":{backgroundColor:ur(e)}},[`&.${De.activeDrop}`]:{paddingTop:"0px",boxSizing:"border-box",border:"2px solid"},[`&.${De.acceptDrop}`]:{transition:"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms",background:"repeating-linear-gradient( 45deg, rgba(0, 0, 0, 0.09), rgba(0, 0, 0, 0.09) 10px, rgba(0, 0, 0, 0.12) 10px, rgba(0, 0, 0, 0.12) 20px) !important",border:"2px solid",borderColor:e.palette.success.light},[`&.${De.rejectDrop}`]:{border:"2px solid",borderColor:e.palette.error.light}}));function fr({propertyKey:e,value:t,setValue:r,error:n,showError:s,autoFocus:i,tableMode:l,property:a,includeDescription:A,context:u,isSubmitting:f}){if(!u.entityId)throw new Error("StorageUploadFieldBinding: Entity id is null");const h=lo(),b=uo(a)||!!a.disabled||f,{internalValue:v,setInternalValue:g,onFilesAdded:p,storage:w,onFileUploadComplete:C,storagePathBuilder:x,multipleFilesSupported:B}=ti({entityValues:u.values,entityId:u.entityId,path:u.path,property:a,propertyKey:e,value:t,storageSource:h,disabled:b,onChange:r});ke({property:a,value:t,setValue:r});const E={id:u.entityId,values:u.values,path:u.path};return o.jsxs(c.FormControl,{fullWidth:!0,required:a.validation?.required,error:s,children:[!l&&o.jsx(c.FormHelperText,{filled:!0,children:o.jsx(Ee,{icon:ve(a),title:a.name})}),o.jsx(Ta,{value:v,name:e,disabled:b,autoFocus:i,property:a,onChange:r,setInternalValue:g,onFilesAdded:p,entity:E,onFileUploadComplete:C,storagePathBuilder:x,storage:w,multipleFilesSupported:B}),A&&o.jsx(Be,{property:a}),s&&o.jsx(c.FormHelperText,{error:!0,children:n})]})}function Ia({storage:e,disabled:t,isDraggingOver:r,onFilesAdded:n,multipleFilesSupported:s,droppableProvided:i,autoFocus:l,internalValue:a,property:A,entity:u,onClear:f,metadata:h,storagePathBuilder:b,onFileUploadComplete:v,size:g,name:p,helpText:w}){const C=He(),{getRootProps:x,getInputProps:B,isDragActive:E,isDragAccept:m,isDragReject:k}=tn.useDropzone({accept:e.acceptedFiles?e.acceptedFiles.map(S=>({[S]:[]})).reduce((S,F)=>({...S,...F}),{}):void 0,disabled:t||r,noDragEventsBubbling:!0,maxSize:e.maxSize,onDrop:n,onDropRejected:(S,F)=>{for(const I of S)for(const T of I.errors)C.open({type:"error",message:`Error uploading file: File is larger than ${e.maxSize} bytes`})}});return o.jsxs(Fa,{...x(),className:Cl(De.dropZone,{[De.nonActiveDrop]:!E,[De.activeDrop]:E,[De.rejectDrop]:k,[De.acceptDrop]:m,[De.disabled]:t}),sx:{display:s&&a.length?void 0:"flex",alignItems:"center"},children:[o.jsxs(c.Box,{...i.droppableProps,ref:i.innerRef,sx:{display:"flex",alignItems:"center",overflow:s&&a.length?"auto":void 0,minHeight:s&&a.length?180:250,p:1,"&::-webkit-scrollbar":{display:"none"}},children:[o.jsx("input",{autoFocus:l,...B()}),a.map((S,F)=>{let I;return S.storagePathOrDownloadUrl?I=o.jsx(li,{name:`storage_preview_${S.storagePathOrDownloadUrl}`,property:A,disabled:t,entity:u,value:S.storagePathOrDownloadUrl,onRemove:f,size:S.size}):S.file&&(I=o.jsx(si,{entry:S,metadata:h,storagePath:b(S.file),onFileUploadComplete:v,imageSize:g==="regular"?220:118,simple:!1})),o.jsx(io.Draggable,{draggableId:`array_field_${p}_${S.id}`,index:F,children:(T,P)=>o.jsx(c.Box,{ref:T.innerRef,...T.draggableProps,...T.dragHandleProps,style:T.draggableProps.style,sx:M=>({borderRadius:`${M.shape.borderRadius}px`}),children:I})},`array_field_${p}_${S.id}`)}),i.placeholder]}),o.jsx(c.Box,{sx:{flexGrow:1,minHeight:38,boxSizing:"border-box",m:2},children:o.jsx(c.Typography,{align:"center",variant:"label",children:w})})]})}function Ta({property:e,name:t,value:r,setInternalValue:n,onChange:s,multipleFilesSupported:i,onFileUploadComplete:l,disabled:a,onFilesAdded:A,autoFocus:u,storage:f,entity:h,storagePathBuilder:b}){if(i){const E=e;if(E.of){if(Array.isArray(E.of)||E.of.dataType!=="string")throw Error("Storage field using array must be of data type string")}else throw Error("Storage field using array must be of data type string")}const v=f?.metadata,g=i?"small":"regular",p=d.useCallback((E,m)=>{if(!i)return;const k=[...r],S=k[E];k.splice(E,1),k.splice(m,0,S),n(k);const F=k.filter(I=>!!I.storagePathOrDownloadUrl).map(I=>I.storagePathOrDownloadUrl);s(F)},[i,s,n,r]),w=d.useCallback(E=>{E.destination&&p(E.source.index,E.destination.index)},[p]),C=d.useCallback(E=>{if(i){const m=r.filter(k=>k.storagePathOrDownloadUrl!==E);s(m.filter(k=>!!k.storagePathOrDownloadUrl).map(k=>k.storagePathOrDownloadUrl)),n(m)}else s(null),n([])},[r,i,s]),x=i?"Drag 'n' drop some files here, or click to select files":"Drag 'n' drop a file here, or click to select one",B=i?e.of:e;return o.jsx(io.DragDropContext,{onDragEnd:w,children:o.jsx(io.Droppable,{droppableId:`droppable_${t}`,direction:"horizontal",renderClone:(E,m,k)=>{const S=r[k.source.index];return o.jsx(c.Box,{ref:E.innerRef,...E.draggableProps,...E.dragHandleProps,style:E.draggableProps.style,sx:F=>({borderRadius:F.shape.borderRadius}),children:o.jsx(li,{name:`storage_preview_${S.storagePathOrDownloadUrl}`,property:B,disabled:!0,entity:h,value:S.storagePathOrDownloadUrl,onRemove:C,size:S.size})})},children:(E,m)=>o.jsx(Ia,{storage:f,disabled:a,isDraggingOver:m.isDraggingOver,droppableProvided:E,onFilesAdded:A,multipleFilesSupported:i,autoFocus:u,internalValue:r,property:B,entity:h,onClear:C,metadata:v,storagePathBuilder:b,onFileUploadComplete:l,size:g,name:t,helpText:x})})})}function st(e){return parseInt(e,10)||0}const Da={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function ai(e){return e==null||Object.keys(e).length===0||e.outerHeightStyle===0&&!e.overflow}const gr=Ce.forwardRef(function(t,r){const{onChange:n,onScroll:s,onResize:i,maxRows:l,minRows:a=1,style:A,value:u,onFocus:f,onBlur:h,sizeRef:b,...v}=t,{current:g}=Ce.useRef(u!=null),p=Ce.useRef(null),w=Co.unstable_useForkRef(r,p),C=Ce.useRef(null),x=Ce.useRef(0),[B,E]=Ce.useState({outerHeightStyle:0}),m=Ce.useCallback(()=>{const T=p.current,M=Co.unstable_ownerWindow(T).getComputedStyle(T);if(M.width==="0px")return{outerHeightStyle:0};const L=b?.current??C.current,W=C.current;L.style.width=M.width,W.value=T.value||t.placeholder||"x",W.value.slice(-1)===`
`&&(W.value+=" ");const $=M.boxSizing,Z=st(M.paddingBottom)+st(M.paddingTop),z=st(M.borderBottomWidth)+st(M.borderTopWidth),J=L.scrollHeight;W.value="x";const O=L.scrollHeight;let D=J;a&&(D=Math.max(Number(a)*O,D)),l&&(D=Math.min(Number(l)*O,D)),D=Math.max(D,O);const Q=D+($==="border-box"?Z+z:0),j=Math.abs(D-J)<=1;return{outerHeightStyle:Q,overflow:j}},[l,a,t.placeholder]),k=(T,P)=>{const{outerHeightStyle:M,overflow:L}=P;return x.current<20&&(M>0&&Math.abs((T.outerHeightStyle||0)-M)>1||T.overflow!==L)?(x.current+=1,{overflow:L,outerHeightStyle:M}):(process.env.NODE_ENV!=="production"&&x.current===20&&console.error(["MUI: Too many re-renders. The layout is unstable.","TextareaAutosize limits the number of renders to prevent an infinite loop."].join(`
`)),T)},S=Ce.useCallback(()=>{const T=m();ai(T)||(i&&i(T),E(P=>k(P,T)))},[m,i]),F=()=>{const T=m();ai(T)||Tl.flushSync(()=>{E(P=>k(P,T))})};Ce.useEffect(()=>{const T=Co.unstable_debounce(()=>{x.current=0,p.current&&F()});let P;const M=p.current,L=Co.unstable_ownerWindow(M);return L.addEventListener("resize",T),typeof ResizeObserver<"u"&&(P=new ResizeObserver(T),P.observe(M)),()=>{T.clear(),L.removeEventListener("resize",T),P&&P.disconnect()}}),Co.unstable_useEnhancedEffect(()=>{S()}),Ce.useEffect(()=>{x.current=0},[u]);const I=T=>{x.current=0,g||S(),n&&n(T)};return o.jsxs(Ce.Fragment,{children:[o.jsx("textarea",{value:u,onChange:I,ref:w,onFocus:f,onBlur:h,rows:a,style:{height:B.outerHeightStyle,overflow:B.overflow?"hidden":void 0,...A},onScroll:s,...v}),o.jsx("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:C,tabIndex:-1,style:{...Da.shadow,...A,padding:0}})]})});function ci({label:e,value:t}){return o.jsxs(c.Box,{sx:{position:"relative",background:Sa,borderRadius:"4px",maxWidth:"100%",minHeight:"64px",color:r=>r.palette.text.disabled},children:[o.jsx(c.InputLabel,{shrink:!!t,sx:{position:"absolute",left:0,top:"4px",pointerEvents:"none"},variant:"filled",children:e}),o.jsx(c.Box,{sx:{padding:"32px 12px 8px 12px"},children:o.jsx(c.Typography,{variant:"body1",children:t})})]})}function di({value:e,setValue:t,label:r,inputType:n="text",multiline:s=!1,disabled:i,error:l,endAdornment:a,autoFocus:A,placeholder:u}){const f=d.useRef(null),[h,b]=d.useState(document.activeElement===f.current),v=e!=null&&e!=="",g=d.useCallback(C=>{if(n==="number"){const x=C.target.value?parseFloat(C.target.value):void 0;x&&isNaN(x)?t(null):x!=null?t(x):t(null)}else t(C.target.value)},[n,t]);if(i)return o.jsx(ci,{label:r,value:e});const p=s?o.jsx(Ma,{ref:f,placeholder:u,autoFocus:A,onFocus:()=>b(!0),onBlur:()=>b(!1),value:e??"",onChange:g}):o.jsx(Pa,{ref:f,sx:{padding:r?"32px 12px 8px 12px":"8px 12px 8px 12px"},placeholder:u,autoFocus:A,onFocus:()=>b(!0),onBlur:()=>b(!1),type:n,value:e??"",onChange:g}),w=a?o.jsxs(c.Box,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[p,o.jsx(c.Box,{sx:{mr:2,my:1},children:a})]}):p;return o.jsxs(c.Box,{sx:C=>({position:"relative",background:eo(C),borderRadius:`${C.shape.borderRadius}px`,maxWidth:"100%",minHeight:"64px","&:hover":{backgroundColor:h?void 0:ur(C)}}),children:[o.jsx(c.InputLabel,{shrink:v||h,sx:{position:"absolute",left:0,top:"4px",pointerEvents:"none",color:C=>l?C.palette.error.main:h?C.palette.primary.main:void 0},variant:"filled",children:r}),w]})}const Pa=d.memo(Wo.styled("input")(()=>({width:"100%",outlineWidth:0,minHeight:"64px",fontSize:"16px",padding:"32px 12px 8px 12px",font:"inherit",letterSpacing:"inherit",color:"currentcolor",border:"0px",background:"none",height:"1.4375em",margin:"0px",WebkitTapHighlightColor:"transparent",display:"block",minWidth:"0px",animationName:"mui-auto-fill-cancel",animationDuration:"10ms"})),(e,t)=>e.value===t.value),Ma=Wo.styled(gr)({width:"100%",outlineWidth:0,resize:"none",minHeight:"64px",fontSize:"16px",padding:"32px 12px 8px 12px",font:"inherit",letterSpacing:"inherit",color:"currentcolor",border:"0px",background:"none",height:"1.4375em",margin:"0px",WebkitTapHighlightColor:"transparent",display:"block",minWidth:"0px",animationName:"mui-auto-fill-cancel",animationDuration:"10ms"});function ho({propertyKey:e,value:t,setValue:r,error:n,showError:s,disabled:i,autoFocus:l,property:a,includeDescription:A,allowInfinity:u}){let f;a.dataType==="string"&&(f=a.multiline),ke({property:a,value:t,setValue:r});const h=d.useCallback(()=>{r(null)},[r]),b=!!f,g=(t??(a.dataType==="string"?"":t===0?0:""))===1/0,p=!g&&a.dataType==="number"?"number":void 0,w=d.useCallback(C=>{if(!C)r(null);else if(p==="number"){const x=parseFloat(C);r(x)}else r(C)},[p,r]);return o.jsxs(o.Fragment,{children:[o.jsx(di,{value:t,setValue:r,autoFocus:l,label:o.jsx(Ee,{icon:ve(a),title:a.name}),inputType:p,multiline:b,disabled:i,endAdornment:a.clearable&&o.jsx(c.IconButton,{onClick:h,children:o.jsx(Pe,{})}),error:s?n:void 0}),(s||A||u)&&o.jsxs(c.Box,{display:"flex",sx:{marginLeft:"14px"},children:[o.jsxs(c.Box,{flexGrow:1,children:[s&&o.jsx(c.FormHelperText,{error:!0,children:n}),A&&o.jsx(Be,{property:a})]}),u&&o.jsx(c.FormControlLabel,{checked:g,style:{marginRight:0},labelPlacement:"start",control:o.jsx(c.Switch,{size:"small",type:"checkbox",onChange:C=>{w(C.target.checked?1/0:void 0)}}),disabled:i,label:o.jsx(c.Typography,{variant:"caption",children:"Set value to Infinity"})})]})]})}const Ai=d.forwardRef(function({propertyKey:t,value:r,setValue:n,error:s,showError:i,autoFocus:l,disabled:a,touched:A,property:u,includeDescription:f},h){ke({property:u,value:r,setValue:n});const[b,v]=d.useState(l);return o.jsx(o.Fragment,{children:o.jsxs(c.FormControl,{fullWidth:!0,children:[o.jsx(c.FormControlLabel,{sx:g=>({color:b?g.palette.primary.main:g.palette.text.secondary,justifyContent:"space-between",margin:0,width:"100%",minHeight:"64px",paddingLeft:"16px",paddingRight:"24px",boxSizing:"border-box",position:"relative",display:"inline-flex",alignItems:"center",backgroundColor:eo(g),borderRadius:`${g.shape.borderRadius}px`,transition:"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms","&:hover":{backgroundColor:ur(g)}}),onClick:g=>v(!0),labelPlacement:"start",checked:!!r,inputRef:h,control:o.jsx(c.Switch,{type:"checkbox",color:"secondary",autoFocus:l,disabled:a,onFocus:g=>v(!0),onBlur:g=>v(!1),onChange:g=>{v(!0),n(g.target.checked)}}),disabled:a,label:o.jsx(Ee,{icon:ve(u),title:u.name})}),f&&o.jsx(Be,{property:u}),i&&o.jsx(c.FormHelperText,{error:!0,children:s})]})})});function ui({propertyKey:e,value:t,setValue:r,autoFocus:n,error:s,showError:i,disabled:l,touched:a,property:A,includeDescription:u}){const f=t||null;ke({property:A,value:t,setValue:r});const h=d.useCallback(()=>{r(null)},[r]),b=A.mode===void 0||A.mode==="date_time"?Dt.DateTimePicker:Tt.DatePicker;return o.jsxs(o.Fragment,{children:[o.jsx(b,{autoFocus:n,value:f,renderInput:v=>o.jsx(c.TextField,{...v,fullWidth:!0,sx:g=>({minHeight:"64px",borderRadius:`${g.shape.borderRadius}px`}),label:o.jsx(Ee,{icon:ve(A),title:A.name}),InputProps:{...v.InputProps,sx:g=>({minHeight:"64px",borderRadius:`${g.shape.borderRadius}px`}),disableUnderline:!0,endAdornment:o.jsxs(c.Box,{sx:{pr:2,gap:2},children:[A.clearable&&o.jsx(c.IconButton,{sx:{position:"absolute",right:"56px",top:"12px"},onClick:h,children:o.jsx(Pe,{})}),v.InputProps?.endAdornment]})},error:i,variant:"filled",helperText:i?s:null}),disabled:l,onChange:v=>r(v)}),u&&o.jsx(Be,{property:A})]})}function Qa({name:e,path:t,disabled:r,value:n,setValue:s,previewProperties:i,forceFilter:l}){const a=oe(),A=he(),u=Ne(),f=d.useMemo(()=>A.getCollection(t),[t,A]);if(!f)throw Error(`Couldn't find the corresponding collection for the path: ${t}`);const h=n&&n instanceof Me,{entity:b,dataLoading:v,dataLoadingError:g}=_o({path:t,entityId:h?n.id:void 0,collection:f,useCache:!0}),p=d.useCallback(m=>{r||s(m?Re(m):null)},[r,s]),w=So({multiselect:!1,path:t,collection:f,onSingleEntitySelected:p,forceFilter:l}),C=d.useCallback(()=>{w.open()},[w]),x=d.useCallback(m=>{m.stopPropagation(),s(null)},[s]),B=d.useCallback(m=>{m.stopPropagation(),b&&(a.onAnalyticsEvent?.("entity_click_from_reference",{path:b.path,entityId:b.id}),u.open({entityId:b.id,path:t,updateUrl:!0}))},[b,t,u]),E=m=>{const k=b&&!b.values;let S;if(!m)S=o.jsx(ue,{error:"The specified collection does not exist. Check console"});else if(k)S=o.jsx(c.Tooltip,{title:n&&n.path,children:o.jsxs(c.Box,{display:"flex",alignItems:"center",p:1,flexGrow:1,children:[o.jsx(mt,{fontSize:"small",color:"error"}),o.jsxs(c.Box,{marginLeft:1,children:["Missing reference ",b&&b.id]})]})});else if(h){const F=mr(m,a.fields,i,3);S=o.jsx(c.Box,{display:"flex",flexDirection:"column",flexGrow:1,ml:1,mr:1,children:F&&F.map(I=>{const T=m.properties[I];return T?o.jsx(c.Box,{mt:.25,mb:.25,children:o.jsx(ne,{children:b?o.jsx(xe,{propertyKey:I,value:b.values[I],property:T,entity:b,size:"tiny"}):o.jsx(Xe,{property:T,size:"tiny"})})},`reference_previews_${I}`):null})})}else S=o.jsxs(c.Box,{p:1,onClick:r?void 0:C,justifyContent:"center",display:"flex",children:[o.jsx(c.Typography,{variant:"label",sx:F=>({flexGrow:1,textAlign:"center"}),children:"No value set"}),!r&&o.jsx(c.Button,{variant:"outlined",color:"primary",children:"Set"})]});return o.jsx(c.Box,{onClick:r?void 0:C,display:"flex",children:o.jsxs(c.Box,{display:"flex",flexDirection:"column",flexGrow:1,children:[o.jsxs(c.Box,{display:"flex",flexDirection:"row",flexGrow:1,children:[o.jsx(Ee,{icon:o.jsx(Rr,{color:"inherit",fontSize:"inherit"}),sx:{flexGrow:1,color:"text.secondary",ml:1},title:e}),b&&o.jsx(c.Box,{alignSelf:"center",m:1,children:o.jsx(c.Tooltip,{title:n&&n.path,children:o.jsx(c.Typography,{variant:"caption",className:"mono",children:b.id})})}),!k&&b&&n&&o.jsx(c.Box,{children:o.jsx(c.Tooltip,{title:`See details for ${b.id}`,children:o.jsx("span",{children:o.jsx(c.IconButton,{onClick:B,size:"large",children:o.jsx(It,{})})})})}),n&&o.jsx(c.Box,{children:o.jsx(c.Tooltip,{title:"Clear",children:o.jsx("span",{children:o.jsx(c.IconButton,{disabled:r,onClick:r?void 0:x,size:"large",children:o.jsx(Pe,{})})})})})]}),S]})})};return o.jsx(c.Typography,{variant:"label",sx:m=>({elevation:0,width:"100%",padding:m.spacing(1),position:"relative",transition:"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms",borderRadius:`${m.shape.borderRadius}px`,backgroundColor:r?"rgba(0, 0, 0, 0.12)":m.palette.mode==="light"?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)","&:hover":{cursor:r?void 0:"pointer",backgroundColor:r?"rgba(0, 0, 0, 0.12)":m.palette.mode==="light"?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)"},color:r?m.palette.mode==="light"?"rgba(0, 0, 0, 0.38)":"rgba(255, 255, 255, 0.38)":void 0,fontWeight:m.typography.fontWeightMedium}),children:f&&E(f)})}function fi(e){return typeof e.property.path!="string"?o.jsx(hr,{...e}):o.jsx(La,{...e})}function La({propertyKey:e,value:t,setValue:r,error:n,showError:s,disabled:i,touched:l,autoFocus:a,property:A,includeDescription:u,context:f}){if(!A.path)throw new Error("Property path is required for ReferenceFieldBinding");ke({property:A,value:t,setValue:r});const b=t&&t instanceof Me?t.path:A.path;return o.jsxs(c.FormControl,{error:s,fullWidth:!0,children:[o.jsx(Qa,{name:A.name,path:b,forceFilter:A.forceFilter,previewProperties:A.previewProperties,value:t,disabled:!!A.disabled,setValue:r}),u&&o.jsx(Be,{property:A}),s&&o.jsx(c.FormHelperText,{error:!0,children:n})]})}class ne extends d.Component{constructor(t){super(t),this.state={error:null}}static getDerivedStateFromError(t){return{error:t}}componentDidCatch(t,r){console.error(t)}render(){return this.state.error?o.jsxs(c.Box,{display:"flex",flexDirection:"column",m:.5,children:[o.jsxs(c.Box,{display:"flex",alignItems:"center",m:.5,children:[o.jsx(mt,{color:"error",fontSize:"small"}),o.jsx(c.Box,{marginLeft:1,children:"Error"})]}),o.jsx(c.Typography,{variant:"caption",children:this.state.error?.message??"See the error in the console"})]}):this.props.children}}function hr({propertyKey:e,value:t,setValue:r,error:n,showError:s,isSubmitting:i,touched:l,tableMode:a,property:A,includeDescription:u,context:f}){if(!f.entityId)throw new Error("ReadOnlyFieldBinding: Entity id is null");const h={id:f.entityId,values:f.values,path:f.path};return o.jsxs(c.FormControl,{fullWidth:!0,error:s,children:[!a&&o.jsx(c.FormHelperText,{filled:!0,children:o.jsx(Ee,{icon:ve(A),title:A.name})}),o.jsx(c.Paper,{sx:b=>({minHeight:"56px",elevation:0,padding:b.spacing(2),[b.breakpoints.up("md")]:{padding:b.spacing(3)}}),variant:"outlined",children:o.jsx(ne,{children:o.jsx(xe,{propertyKey:e,value:t,property:A,entity:h,size:"regular"})})}),s&&typeof n=="string"&&o.jsx(c.FormHelperText,{error:!0,children:n}),u&&o.jsx(Be,{property:A})]})}const oo=d.memo(Oa,(e,t)=>{const r=Te(e.property)||e.property.fromBuilder,n=Te(t.property)||t.property.fromBuilder;return!((r===n||le(e.property,t.property))&&e.disabled===t.disabled)||lt(t.property),!1});function Oa({propertyKey:e,property:t,context:r,includeDescription:n,underlyingValueHasChanged:s,disabled:i,tableMode:l,partOfArray:a,autoFocus:A,context:{values:u,collection:f,path:h,entityId:b}}){const v=oe(),p=lt(t,v.plugins)?we.Field:we.FastField;return o.jsx(p,{name:e,children:w=>{let C;const x=Ie({propertyKey:e,propertyValue:w.field.value,propertyOrBuilder:t,values:w.form.values,path:r.path,entityId:r.entityId,fields:v.fields});if(x===null||tt(x))return o.jsx(o.Fragment,{});if(uo(x))C=hr;else if(x.Field)typeof x.Field=="function"&&(C=x.Field);else{const E=at(x);if(!E)throw new Error(`INTERNAL: Could not find field config for property ${e}`);C=E.Field}if(!C)return o.jsx("div",{children:`Currently the field ${x.dataType} is not supported`});const B={propertyKey:e,property:x,includeDescription:n,underlyingValueHasChanged:s,context:r,disabled:i,tableMode:l,partOfArray:a,autoFocus:A};return o.jsx(Ga,{Component:C,componentProps:B,fieldProps:w})}})}function Ga({Component:e,componentProps:{propertyKey:t,property:r,includeDescription:n,underlyingValueHasChanged:s,tableMode:i,partOfArray:l,autoFocus:a,context:A,disabled:u},fieldProps:f}){const{plugins:h}=oe(),b=r.customProps,v=f.field.value,g=f.meta.initialValue,p=we.getIn(f.form.errors,t),w=we.getIn(f.form.touched,t),C=p&&(f.form.submitCount>0||r.validation?.unique)&&(!Array.isArray(p)||!!p.filter(k=>!!k).length),B=$a(A.path,A.collection,t,r,e,h)??e,E=f.form.isSubmitting,m={propertyKey:t,value:v,initialValue:g,setValue:(k,S)=>{f.form.setFieldTouched(t,!0,!1),f.form.setFieldValue(t,k,S)},setFieldValue:(k,S,F)=>{f.form.setFieldTouched(t,!0,!1),f.form.setFieldValue(k,S,F)},error:p,touched:w,showError:C,isSubmitting:E,includeDescription:n??!0,property:r,disabled:u??!1,underlyingValueHasChanged:s??!1,tableMode:i??!1,partOfArray:l??!1,autoFocus:a??!1,customProps:b,context:A};return o.jsxs(ne,{children:[o.jsx(B,{...m}),s&&!E&&o.jsx(c.FormHelperText,{children:"This value has been updated elsewhere"})]})}const lt=(e,t)=>{if(t?.some(s=>s.form?.fieldBuilder)||Te(e))return!0;const r=e,n=!!r.Field||"fromBuilder"in r&&r.fromBuilder;return r.dataType==="map"&&r.properties?n||Object.values(r.properties).some(s=>lt(s,t)):r.dataType==="array"&&"resolvedProperties"in r?n||r.resolvedProperties?.some(s=>s&&lt(s,t)):n};function $a(e,t,r,n,s,i){return d.useRef((()=>{let a=null;return i&&i.forEach(A=>{const u=yr(n);if(u&&A.form?.fieldBuilder){const f={fieldConfigId:u,propertyKey:r,property:n,Field:s,plugin:A,path:e,collection:t},h=A.form?.fieldBuilderEnabled?.(f);(h===void 0||h)&&(a=A.form.fieldBuilder(f)||a)}u||console.warn("INTERNAL: Field id not found for property",n)}),a})()).current}function gi({propertyKey:e,value:t,showError:r,disabled:n,property:s,setValue:i,tableMode:l,includeDescription:a,underlyingValueHasChanged:A,autoFocus:u,context:f}){const h=s.pickOnlySomeKeys||!1,b=(s.expanded===void 0?!0:s.expanded)||u;if(!s.properties)throw Error(`You need to specify a 'properties' prop (or specify a custom field) in your map property ${e}`);let v;h?t?v=jn(s.properties,...Object.keys(t).filter(w=>w in s.properties)):v={}:v=s.properties,ke({property:s,value:t,setValue:i});const g=o.jsxs(o.Fragment,{children:[o.jsx(c.Grid,{container:!0,spacing:2,sx:{py:1},children:Object.entries(v).filter(([w,C])=>!tt(C)).map(([w,C],x)=>{const B={propertyKey:`${e}.${w}`,disabled:n,property:C,includeDescription:a,underlyingValueHasChanged:A,context:f,tableMode:!1,partOfArray:!1,autoFocus:u&&x===0};return o.jsx(c.Grid,{item:!0,sm:12,xs:12,children:o.jsx(oo,{...B})},`map-${e}-${x}`)})}),h&&Va(n,s.properties,i,t)]}),p=o.jsx(Ee,{icon:ve(s),title:s.name});return o.jsxs(c.FormControl,{fullWidth:!0,error:r,children:[!l&&o.jsx(to,{initiallyExpanded:b,title:p,children:g}),l&&g,a&&o.jsx(Be,{property:s})]})}const Va=(e,t,r,n)=>{const s=Object.keys(t).filter(l=>!n||!(l in n)),i=l=>{r({...n,[l.target.value]:null})};return s.length?o.jsx(c.Box,{m:1,children:o.jsxs(c.FormControl,{fullWidth:!0,children:[o.jsx(c.InputLabel,{children:"Add property"}),o.jsx(c.Select,{variant:"standard",value:"",disabled:e,onChange:i,children:s.map(l=>o.jsx(c.MenuItem,{value:l,children:t[l].name||l},l))})]})}):o.jsx(o.Fragment,{})};function to({title:e,children:t,invisible:r=!1,initiallyExpanded:n=!0,padding:s=1,darken:i=!0,onExpandedChange:l}){const[a,A]=d.useState(n);return o.jsxs(c.Accordion,{variant:"outlined",disableGutters:!0,expanded:a,sx:u=>({backgroundColor:r?"transparent":i?void 0:"inherit",borderRadius:r?0:`${u.shape.borderRadius}px`,border:r?"none":void 0,"&::before":{display:"none"}}),TransitionProps:{unmountOnExit:!0},onChange:d.useCallback((u,f)=>{l?.(f),A(f)},[l]),children:[o.jsx(c.AccordionSummary,{expandIcon:o.jsx(el,{}),sx:u=>({color:u.palette.text.secondary,padding:r?0:void 0,minHeight:"56px",alignItems:"center",borderTopLeftRadius:`${u.shape.borderRadius}px`,borderTopRightRadius:`${u.shape.borderRadius}px`,borderBottomLeftRadius:!a&&!r?`${u.shape.borderRadius}px`:void 0,borderBottomRightRadius:!a&&!r?`${u.shape.borderRadius}px`:void 0,border:r?"none":void 0,borderBottom:r?`1px solid ${u.palette.divider}`:void 0,"&.Mui-expanded":{borderBottom:`1px solid ${u.palette.divider}`}}),children:e}),o.jsx(c.AccordionDetails,{sx:u=>({padding:r?0:typeof s=="string"?s:u.spacing(s),py:u.spacing(2),border:r?"none":void 0,color:"inherit"}),children:t})]})}function hi({propertyKey:e,value:t,error:r,showError:n,isSubmitting:s,setValue:i,tableMode:l,property:a,includeDescription:A,underlyingValueHasChanged:u,context:f,disabled:h}){if(!a.of)throw Error("RepeatFieldBinding misconfiguration. Property `of` not set");if(!a.resolvedProperties||!Array.isArray(a.resolvedProperties))throw Error("RepeatFieldBinding - Internal error: Expected array in 'property.resolvedProperties'");const b=a.expanded===void 0?!0:a.expanded,v=a.of,[g,p]=d.useState();ke({property:a,value:t,setValue:i});const w=d.useCallback((B,E)=>{const m=a.resolvedProperties[B]??v,k={propertyKey:`${e}.${B}`,disabled:h,property:m,includeDescription:A,underlyingValueHasChanged:u,context:f,tableMode:!1,partOfArray:!0,autoFocus:E===g};return o.jsx(oo,{...k})},[f,h,A,g,v,a.resolvedProperties,e,u]),C=o.jsx(nt,{value:t,addLabel:a.name?"Add entry to "+a.name:"Add entry",name:e,buildEntry:w,onInternalIdAdded:p,disabled:s||!!a.disabled,includeAddButton:!a.disabled,newDefaultEntry:a.of.defaultValue}),x=o.jsx(Ee,{icon:ve(a),title:a.name});return o.jsxs(c.FormControl,{fullWidth:!0,error:n,children:[!l&&o.jsx(to,{initiallyExpanded:b,title:x,children:C}),l&&C,A&&o.jsx(Be,{property:a}),n&&typeof r=="string"&&o.jsx(c.FormHelperText,{error:!0,children:r})]})}function pi({propertyKey:e,value:t,error:r,showError:n,isSubmitting:s,setValue:i,tableMode:l,property:a,includeDescription:A,underlyingValueHasChanged:u,context:f,disabled:h}){if(!a.oneOf)throw Error("ArrayOneOfField misconfiguration. Property `oneOf` not set");const b=a.expanded===void 0?!0:a.expanded;ke({property:a,value:t,setValue:i});const[v,g]=d.useState(),p=d.useCallback((x,B)=>o.jsx(Wa,{name:`${e}.${x}`,index:x,value:t[x],typeField:a.oneOf.typeField??To,valueField:a.oneOf.valueField??Jt,properties:a.oneOf.properties,autoFocus:B===v,context:f},`array_one_of_${x}`),[f,v,a.oneOf,e,t]),w=o.jsx(Ee,{icon:ve(a),title:a.name}),C=o.jsx(nt,{value:t,name:e,addLabel:a.name?"Add entry to "+a.name:"Add entry",buildEntry:p,onInternalIdAdded:g,disabled:s||!!a.disabled,includeAddButton:!a.disabled,newDefaultEntry:{[a.oneOf.typeField??To]:Object.keys(a.oneOf.properties)[0]}});return o.jsxs(c.FormControl,{fullWidth:!0,error:n,children:[!l&&o.jsx(to,{initiallyExpanded:b,title:w,children:C}),l&&C,A&&o.jsx(Be,{property:a}),n&&typeof r=="string"&&o.jsx(c.FormHelperText,{error:!0,children:r})]})}function Wa({name:e,index:t,value:r,typeField:n,valueField:s,properties:i,autoFocus:l,context:a}){const A=r&&r[n],[u,f]=d.useState(A??void 0),h=we.useFormikContext();d.useEffect(()=>{A||C(Object.keys(i)[0])},[]),d.useEffect(()=>{A!==u&&f(A)},[A]);const b=u?i[u]:void 0,v=Object.entries(i).map(([x,B])=>({id:x,label:B.name??x})),g=`${e}.${n}`,p=`${e}.${s}`,w=b?{propertyKey:p,property:b,context:a,autoFocus:l,tableMode:!1}:void 0,C=d.useCallback(x=>{f(x),h.setFieldTouched(g),h.setFieldValue(g,x),h.setFieldValue(p,null)},[g,p]);return o.jsxs(c.Paper,{sx:x=>({padding:x.spacing(1),my:1,py:2}),elevation:0,children:[o.jsx(we.FastField,{required:!0,name:g,children:x=>o.jsxs(c.FormControl,{fullWidth:!0,size:"small",children:[o.jsx(c.InputLabel,{id:`${e}_${t}_select_label`,children:o.jsx("span",{children:"Type"})}),o.jsx(c.Select,{fullWidth:!0,sx:{marginBottom:2},labelId:`${e}_${t}_select_label`,label:"Type",value:x.field.value!==void 0&&x.field.value!==null?x.field.value:"",onChange:B=>{const E=B.target.value;C(E)},renderValue:B=>o.jsx(Fe,{enumKey:B,enumValues:v,small:!0}),children:v.map(B=>{const E=B.id;return o.jsx(c.MenuItem,{value:E,children:o.jsx(Fe,{enumKey:E,enumValues:v,small:!0})},`select_${e}_${t}_${E}`)})})]})}),w&&o.jsx(c.FormControl,{fullWidth:!0,children:o.jsx(oo,{...w})},`form_control_${e}_${u}`)]})}const Ya=new rn;Bo.use(Bo.Plugins.AutoResize,{min:100}),Bo.unuse(Bo.Plugins.Clear);function bi({propertyKey:e,value:t,setValue:r,error:n,showError:s,disabled:i,autoFocus:l,touched:a,property:A,tableMode:u,includeDescription:f,context:h}){const[b,v]=d.useState(t),g=d.useRef(t),p=d.useDeferredValue({internalValue:b,value:t});return d.useEffect(()=>{g.current=t,v(t)},[t]),d.useEffect(()=>{p.internalValue!==g.current&&r(p.internalValue)},[p]),o.jsxs(za,{required:A.validation?.required,error:s,fullWidth:!0,children:[!u&&o.jsx(c.FormHelperText,{filled:!0,children:o.jsx(Ee,{icon:ve(A),title:A.name})}),o.jsx(Bo,{value:b??"",readOnly:i,renderHTML:w=>Ya.render(w),view:{menu:!0,md:!0,html:!1},onChange:({html:w,text:C})=>{v(C??null)}}),o.jsx(c.Box,{display:"flex",children:o.jsxs(c.Box,{flexGrow:1,children:[s&&typeof n=="string"&&o.jsx(c.FormHelperText,{error:!0,children:n}),f&&o.jsx(Be,{property:A})]})})]})}const za=ge.styled(c.FormControl)(({theme:e})=>`
  @font-face {
    font-family: rmel-iconfont;
    src: url(data:application/vnd.ms-fontobject;base64,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NS4BJyMOAd0VGwEBGxWRFRsbFWEcFBQcYRUbGxWRFRsBARsCK2EVGxsVkRUbAQEbKRySARsVYRwpGwEBGxWRFRsBHwEbFZEVGwEBGykcYRUbwwEbFWEcKRsBARsVkRUb/qscKRsBARsVkRUbGxUBtRQcYRUbGxWRFRsBARsAAAAAAAASAN4AAQAAAAAAAAAVAAAAAQAAAAAAAQANABUAAQAAAAAAAgAHACIAAQAAAAAAAwANACkAAQAAAAAABAANADYAAQAAAAAABQALAEMAAQAAAAAABgANAE4AAQAAAAAACgArAFsAAQAAAAAACwATAIYAAwABBAkAAAAqAJkAAwABBAkAAQAaAMMAAwABBAkAAgAOAN0AAwABBAkAAwAaAOsAAwABBAkABAAaAQUAAwABBAkABQAWAR8AAwABBAkABgAaATUAAwABBAkACgBWAU8AAwABBAkACwAmAaUKQ3JlYXRlZCBieSBpY29uZm9udApybWVsLWljb25mb250UmVndWxhcnJtZWwtaWNvbmZvbnRybWVsLWljb25mb250VmVyc2lvbiAxLjBybWVsLWljb25mb250R2VuZXJhdGVkIGJ5IHN2ZzJ0dGYgZnJvbSBGb250ZWxsbyBwcm9qZWN0Lmh0dHA6Ly9mb250ZWxsby5jb20ACgBDAHIAZQBhAHQAZQBkACAAYgB5ACAAaQBjAG8AbgBmAG8AbgB0AAoAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABSAGUAZwB1AGwAYQByAHIAbQBlAGwALQBpAGMAbwBuAGYAbwBuAHQAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABWAGUAcgBzAGkAbwBuACAAMQAuADAAcgBtAGUAbAAtAGkAYwBvAG4AZgBvAG4AdABHAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAHMAdgBnADIAdAB0AGYAIABmAHIAbwBtACAARgBvAG4AdABlAGwAbABvACAAcAByAG8AagBlAGMAdAAuAGgAdAB0AHAAOgAvAC8AZgBvAG4AdABlAGwAbABvAC4AYwBvAG0AAAAAAgAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaAQIBAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwADdGFiCGtleWJvYXJkBmRlbGV0ZQpjb2RlLWJsb2NrBGNvZGUKdmlzaWJpbGl0eQp2aWV3LXNwbGl0BGxpbmsEcmVkbwR1bmRvBGJvbGQGaXRhbGljDGxpc3Qtb3JkZXJlZA5saXN0LXVub3JkZXJlZAVxdW90ZQ1zdHJpa2V0aHJvdWdoCXVuZGVybGluZQR3cmFwCWZvbnQtc2l6ZQRncmlkBWltYWdlC2V4cGFuZC1sZXNzC2V4cGFuZC1tb3JlD2Z1bGxzY3JlZW4tZXhpdApmdWxsc2NyZWVuAAAAAAA=);
    src: url(data:font/ttf;base64,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) format("truetype")
  }

  .rmel-iconfont {
    font-family: rmel-iconfont !important;
    font-size: 16px;
    font-style: normal;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale
  }

  .rmel-icon-tab:before {
    content: "\\e76d"
  }

  .rmel-icon-keyboard:before {
    content: "\\ed80"
  }

  .rmel-icon-delete:before {
    content: "\\ed3c"
  }

  .rmel-icon-code-block:before {
    content: "\\e941"
  }

  .rmel-icon-code:before {
    content: "\\ed3b"
  }

  .rmel-icon-visibility:before {
    content: "\\ed44"
  }

  .rmel-icon-view-split:before {
    content: "\\ed45"
  }

  .rmel-icon-link:before {
    content: "\\ed5f"
  }

  .rmel-icon-redo:before {
    content: "\\ed60"
  }

  .rmel-icon-undo:before {
    content: "\\ed61"
  }

  .rmel-icon-bold:before {
    content: "\\ed6f"
  }

  .rmel-icon-italic:before {
    content: "\\ed70"
  }

  .rmel-icon-list-ordered:before {
    content: "\\ed71"
  }

  .rmel-icon-list-unordered:before {
    content: "\\ed72"
  }

  .rmel-icon-quote:before {
    content: "\\ed73"
  }

  .rmel-icon-strikethrough:before {
    content: "\\ed74"
  }

  .rmel-icon-underline:before {
    content: "\\ed75"
  }

  .rmel-icon-wrap:before {
    content: "\\ed77"
  }

  .rmel-icon-font-size:before {
    content: "\\ed78"
  }

  .rmel-icon-grid:before {
    content: "\\ed8c"
  }

  .rmel-icon-image:before {
    content: "\\ed8d"
  }

  .rmel-icon-expand-less:before {
    content: "\\ed9f"
  }

  .rmel-icon-expand-more:before {
    content: "\\eda0"
  }

  .rmel-icon-fullscreen-exit:before {
    content: "\\eda1"
  }

  .rmel-icon-fullscreen:before {
    content: "\\eda2"
  }

  .rc-md-editor {
    padding-bottom: 1px;
    position: relative;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    overflow: hidden;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
    -webkit-flex-direction: column;
    -ms-flex-direction: column;
    flex-direction: column;
            border-radius: 6px;
            background-color: ${eo(e)};
  }

  .rc-md-editor.full {
    width: 100%;
    height: 100% !important;
    position: fixed;
    left: 0;
    top: 0;
    z-index: 1000
  }

  .rc-md-editor .editor-container {
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    -ms-flex: 1;
    flex: 1;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    width: 100%;
    min-height: 0;
    position: relative;
                background-color: ${eo(e)};

  }

  .rc-md-editor .editor-container > .section {
    -webkit-box-flex: 1;
    -webkit-flex-grow: 1;
    -ms-flex-positive: 1;
    flex-grow: 1;
    -webkit-flex-shrink: 1;
    -ms-flex-negative: 1;
    flex-shrink: 1;
    -webkit-flex-basis: 1px;
    -ms-flex-preferred-size: 1px;
    flex-basis: 1px;
    padding: 4px;
    
            border: none
  }

  .rc-md-editor .editor-container > .section.in-visible {
    display: none
  }

  .rc-md-editor .editor-container > .section > .section-container {
    padding: 8x 16px 16px
  }
  
  .rc-md-editor .editor-container > .section:last-child {
    border-radius: unset
  }

  .rc-md-editor .editor-container .sec-md {
    min-height: 0;
    min-width: 0
  }

  .rc-md-editor .editor-container .sec-md .input {
    display: block;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    width: 100%;
    height: 100%;
    overflow-y: scroll;
    border: none;
    resize: none;
    outline: none;
    min-height: 0;
    color: inherit;
    font-size: 14px;
    line-height: 1.7;   
             background-color: ${eo(e)};

  }

  .rc-md-editor .editor-container .sec-html {
    min-height: 0;
    min-width: 0;         
       background-color: ${eo(e)};

  }

  .rc-md-editor .editor-container .sec-html .html-wrap {
    height: 100%;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    overflow: auto
  }

  .custom-html-style {
    color: inherit
  }

  .custom-html-style h1 {
    font-size: 32px;
    padding: 0;
    border: none;
    font-weight: 700;
    margin: 32px 0;
    line-height: 1.2
  }

  .custom-html-style h2 {
    font-size: 24px;
    padding: 0;
    border: none;
    font-weight: 700;
    margin: 24px 0;
    line-height: 1.7
  }

  .custom-html-style h3 {
    font-size: 18px;
    margin: 18px 0;
    padding: 0;
    line-height: 1.7;
    border: none
  }

  .custom-html-style p {
    font-size: 14px;
    line-height: 1.7;
    margin: 8px 0
  }

  .custom-html-style a {
    color: ${c.darken(e.palette.text.secondary,0)}
  }

  .custom-html-style a:hover {
    text-decoration: none
  }

  .custom-html-style strong {
    font-weight: 700
  }

  .custom-html-style ol, .custom-html-style ul {
    font-size: 14px;
    line-height: 28px;
    padding-left: 36px
  }

  .custom-html-style li {
    margin-bottom: 8px;
    line-height: 1.7
  }

  .custom-html-style hr {
    margin-top: 20px;
    margin-bottom: 20px;
    border: 0;
    border-top: 1px solid ${e.palette.divider}
  }

  .custom-html-style pre {
    display: block;
    padding: 20px;
    line-height: 28px;
    word-break: break-word
  }

  .custom-html-style code, .custom-html-style pre {
    background-color: ${c.darken(e.palette.background.default,.1)};
    font-size: 14px;
    border-radius: 0;
    overflow-x: auto
  }

  .custom-html-style code {
    padding: 3px 0;
    margin: 0;
    word-break: normal
  }

  .custom-html-style code:after, .custom-html-style code:before {
    letter-spacing: 0
  }

  .custom-html-style blockquote {
    position: relative;
    margin: 16px 0;
    padding: 5px 8px 5px 30px;
    background: none repeat scroll 0 0 rgb(39 39 41);
    color: inherit;
    border: none;
    border-left: 10px solid #d6dbdf
  }

  .custom-html-style img, .custom-html-style video {
    max-width: 100%
  }

  .custom-html-style table {
    font-size: 14px;
    line-height: 1.7;
    max-width: 100%;
    overflow: auto;
    border: 1px solid ${e.palette.divider};
    border-collapse: collapse;
    border-spacing: 0;
    -webkit-box-sizing: border-box;
    box-sizing: border-box
  }

  .custom-html-style table td, .custom-html-style table th {
    word-break: break-all;
    word-wrap: break-word;
    white-space: normal
  }

  .custom-html-style table tr {
    border: 1px solid ${e.palette.divider}
  }

  .custom-html-style table tr:nth-of-type(2n) {
    background-color: transparent
  }

  .custom-html-style table th {
    text-align: center;
    font-weight: 700;
    border: 1px solid ${e.palette.divider};
    padding: 10px 6px;
    background-color: #f5f7fa;
    word-break: break-word
  }

  .custom-html-style table td {
    border: 1px solid ${e.palette.divider};
    text-align: left;
    padding: 10px 15px;
    word-break: break-word;
    min-width: 60px
  }

  .rc-md-editor .drop-wrap {
    display: block;
    position: absolute;
    left: 0;
    top: 28px;
    z-index: 2;
    min-width: 20px;
    padding: 10px 0;
    text-align: center;
    background-color: ${c.darken(e.palette.background.default,0)};
    border-color: ${e.palette.divider};
    border-style: solid;
    border-width: 1px
  }

  .rc-md-editor .drop-wrap.hidden {
    display: none !important
  }

  .rc-md-editor .rc-md-navigation {
    min-height: 38px;
    padding: 0 8px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    border-bottom: 1px solid ${e.palette.divider};
    font-size: 16px;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -webkit-flex-direction: row;
    -ms-flex-direction: row;
    flex-direction: row;
    -webkit-box-pack: justify;
    -webkit-justify-content: space-between;
    -ms-flex-pack: justify;
    justify-content: space-between;
    
            color: "inherit",
            background-color: ${e.palette.mode==="light","rgb(39 39 41)"};
        
  }

  .rc-md-editor .rc-md-navigation.in-visible {
    display: none
  }

  .rc-md-editor .rc-md-navigation .navigation-nav {
    -webkit-box-align: center;
    -webkit-align-items: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: center;
    -webkit-justify-content: center;
    -ms-flex-pack: center;
    justify-content: center;
    font-size: 14px;
    color: ${c.darken(e.palette.text.secondary,0)};
  }

  .rc-md-editor .rc-md-navigation .button-wrap, .rc-md-editor .rc-md-navigation .navigation-nav {
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -webkit-flex-direction: row;
    -ms-flex-direction: row;
    flex-direction: row
  }

  .rc-md-editor .rc-md-navigation .button-wrap {
    -webkit-flex-wrap: wrap;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button {
    position: relative;
    min-width: 22px;
    height: 28px;
    margin-left: 3px;
    margin-right: -2px;
    display: inline-block;
    cursor: pointer;
    line-height: 28px;
    text-align: center;
    color: ${e.palette.text.secondary};
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button:hover {
    color: ${c.darken(e.palette.text.secondary,.2)};
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button.disabled {
    color: ${c.darken(e.palette.text.disabled,0)};
    cursor: not-allowed
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button:first-of-type {
    margin-left: 0
  }

  .rc-md-editor .rc-md-navigation .button-wrap .button:last-child {
    margin-right: 0
  }

  .rc-md-editor .rc-md-navigation .button-wrap .rmel-iconfont {
    font-size: 18px
  }

  .rc-md-editor .rc-md-navigation li, .rc-md-editor .rc-md-navigation ul {
    list-style: none;
    margin: 0;
    padding: 0
  }

  .rc-md-editor .rc-md-navigation .h1, .rc-md-editor .rc-md-navigation .h2, .rc-md-editor .rc-md-navigation .h3, .rc-md-editor .rc-md-navigation .h4, .rc-md-editor .rc-md-navigation .h5, .rc-md-editor .rc-md-navigation .h6, .rc-md-editor .rc-md-navigation h1, .rc-md-editor .rc-md-navigation h2, .rc-md-editor .rc-md-navigation h3, .rc-md-editor .rc-md-navigation h4, .rc-md-editor .rc-md-navigation h5, .rc-md-editor .rc-md-navigation h6 {
    font-family: inherit;
    font-weight: 500;
    color: inherit;
    padding: 0;
    margin: 0;
    line-height: 1.1
  }

  .rc-md-editor .rc-md-navigation h1 {
    font-size: 34px
  }

  .rc-md-editor .rc-md-navigation h2 {
    font-size: 30px
  }

  .rc-md-editor .rc-md-navigation h3 {
    font-size: 24px
  }

  .rc-md-editor .rc-md-navigation h4 {
    font-size: 18px
  }

  .rc-md-editor .rc-md-navigation h5 {
    font-size: 14px
  }

  .rc-md-editor .rc-md-navigation h6 {
    font-size: 12px
  }

  .rc-md-editor .tool-bar {
    position: absolute;
    z-index: 1;
    right: 8px;
    top: 8px
  }

  .rc-md-editor .tool-bar .button {
    min-width: 24px;
    height: 28px;
    margin-right: 5px;
    display: inline-block;
    cursor: pointer;
    font-size: 14px;
    line-height: 28px;
    text-align: center;
    color: #999
  }

  .rc-md-editor .tool-bar .button:hover {
    color: inherit
  }

  .rc-md-editor .rc-md-divider {
    display: block;
    width: 1px;
    background-color: ${c.darken(e.palette.background.paper,0)}
  }

  .rc-md-editor .table-list.wrap {
    position: relative;
    margin: 0 10px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box
  }

  .rc-md-editor .table-list.wrap .list-item {
    position: absolute;
    top: 0;
    left: 0;
    display: inline-block;
    width: 20px;
    height: 20px;
    background-color: ${c.darken(e.palette.background.paper,.05)};
    border-radius: 4px
  }

  .rc-md-editor .table-list.wrap .list-item.active {
    background: ${c.lighten(e.palette.background.paper,.2)}
  }

  .rc-md-editor .tab-map-list .list-item {
    width: 120px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box
  }

  .rc-md-editor .tab-map-list .list-item:hover {
    background: ${c.darken(e.palette.background.default,.1)}
  }

  .rc-md-editor .tab-map-list .list-item.active {
    font-weight: 700
  }

  .rc-md-editor .header-list .list-item {
    width: 100px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    padding: 8px 0
  }

  .rc-md-editor .header-list .list-item:hover {
    background: ${c.darken(e.palette.background.default,.1)}
  }

`);me.addMethod(me.array,"uniqueInArray",function(e=r=>r,t){return this.test("uniqueInArray",t,r=>!r||r.length===new Set(r.map(e)).size)});function vi(e,t,r){const n={};return Object.entries(t).forEach(([s,i])=>{n[s]=Mo({property:i,customFieldValidator:r,name:s,entityId:e})}),me.object().shape(n)}function Mo(e){const t=e.property;if(Te(t))throw console.error("Error in property",e),Error("Trying to create a yup mapping from a property builder. Please use resolved properties only");if(t.dataType==="string")return Na(e);if(t.dataType==="number")return Ha(e);if(t.dataType==="boolean")return qa(e);if(t.dataType==="map")return Ua(e);if(t.dataType==="array")return Xa(e);if(t.dataType==="date")return ja(e);if(t.dataType==="geopoint")return _a(e);if(t.dataType==="reference")return Ja(e);throw console.error("Unsupported data type in yup mapping",t),Error("Unsupported data type in yup mapping")}function Ua({property:e,entityId:t,customFieldValidator:r,name:n}){const s={};return e.validation,e.properties&&Object.entries(e.properties).forEach(([i,l])=>{s[i]=Mo({property:l,parentProperty:e,customFieldValidator:r,name:`${n}[${i}]`,entityId:t})}),me.object().shape(s)}function Na({property:e,parentProperty:t,customFieldValidator:r,name:n,entityId:s}){let i=me.string();const l=e.validation;if(e.enumValues&&(l?.required&&(i=i.required(l?.requiredMessage?l.requiredMessage:"Required")),i=i.oneOf(qo(e.enumValues).map(a=>a.id)).nullable(!0)),l){if(i=l.required?i.required(l?.requiredMessage?l.requiredMessage:"Required").nullable(!0):i.notRequired().nullable(!0),l.unique&&r&&n&&(i=i.test("unique","This value already exists and should be unique",(a,A)=>r({name:n,property:e,parentProperty:t,value:a,entityId:s}))),(l.min||l.min===0)&&(i=i.min(l.min,`${e.name} must be min ${l.min} characters long`)),(l.max||l.max===0)&&(i=i.max(l.max,`${e.name} must be max ${l.max} characters long`)),l.matches){const a=typeof l.matches=="string"?Kn(l.matches):l.matches;a&&(i=i.matches(a,l.matchesMessage?{message:l.matchesMessage}:void 0))}l.trim&&(i=i.trim()),l.lowercase&&(i=i.lowercase()),l.uppercase&&(i=i.uppercase()),e.email&&(i=i.email(`${e.name} must be an email`)),e.url&&(i=i.url(`${e.name} must be a url`))}else i=i.notRequired().nullable(!0);return i}function Ha({property:e,parentProperty:t,customFieldValidator:r,name:n,entityId:s}){const i=e.validation;let l=me.number().typeError("Must be a number");return i?(l=i.required?l.required(i.requiredMessage?i.requiredMessage:"Required").nullable(!0):l.notRequired().nullable(!0),i.unique&&r&&n&&(l=l.test("unique","This value already exists and should be unique",a=>r({name:n,property:e,parentProperty:t,value:a,entityId:s}))),(i.min||i.min===0)&&(l=l.min(i.min,`${e.name} must be higher or equal to ${i.min}`)),(i.max||i.max===0)&&(l=l.max(i.max,`${e.name} must be lower or equal to ${i.max}`)),(i.lessThan||i.lessThan===0)&&(l=l.lessThan(i.lessThan,`${e.name} must be higher than ${i.lessThan}`)),(i.moreThan||i.moreThan===0)&&(l=l.moreThan(i.moreThan,`${e.name} must be lower than ${i.moreThan}`)),i.positive&&(l=l.positive(`${e.name} must be positive`)),i.negative&&(l=l.negative(`${e.name} must be negative`)),i.integer&&(l=l.integer(`${e.name} must be an integer`))):l=l.notRequired().nullable(!0),l}function _a({property:e,parentProperty:t,customFieldValidator:r,name:n,entityId:s}){let i=me.object();const l=e.validation;return l?.unique&&r&&n&&(i=i.test("unique","This value already exists and should be unique",a=>r({name:n,property:e,parentProperty:t,value:a,entityId:s}))),l?.required?i=i.required(l.requiredMessage).nullable(!0):i=i.notRequired().nullable(!0),i}function ja({property:e,parentProperty:t,customFieldValidator:r,name:n,entityId:s}){if(e.autoValue)return me.object().nullable();let i=me.date();const l=e.validation;return l?(i=l.required?i.required(l?.requiredMessage?l.requiredMessage:"Required"):i.notRequired(),l.unique&&r&&n&&(i=i.test("unique","This value already exists and should be unique",a=>r({name:n,property:e,parentProperty:t,value:a,entityId:s}))),l.min&&(i=i.min(l.min,`${e.name} must be after ${l.min}`)),l.max&&(i=i.max(l.max,`${e.name} must be before ${l.min}`))):i=i.notRequired(),i.transform(a=>a instanceof Date?a:null).nullable()}function Ja({property:e,parentProperty:t,customFieldValidator:r,name:n,entityId:s}){let i=me.object();const l=e.validation;return l?(i=l.required?i.required(l?.requiredMessage?l.requiredMessage:"Required").nullable(!0):i.notRequired().nullable(!0),l.unique&&r&&n&&(i=i.test("unique","This value already exists and should be unique",a=>r({name:n,property:e,parentProperty:t,value:a,entityId:s})))):i=i.notRequired().nullable(!0),i}function qa({property:e,parentProperty:t,customFieldValidator:r,name:n,entityId:s}){let i=me.boolean();const l=e.validation;return l?(i=l.required?i.required(l?.requiredMessage?l.requiredMessage:"Required").nullable(!0):i.notRequired().nullable(!0),l.unique&&r&&n&&(i=i.test("unique","This value already exists and should be unique",a=>r({name:n,property:e,parentProperty:t,value:a,entityId:s})))):i=i.notRequired().nullable(!0),i}function Za(e){return e.validation?.uniqueInArray?!0:e.dataType==="map"&&e.properties?Object.entries(e.properties).filter(([t,r])=>r.validation?.uniqueInArray):!1}function Xa({property:e,parentProperty:t,customFieldValidator:r,name:n,entityId:s}){let i=me.array();if(e.of)if(Array.isArray(e.of)){const a=e.of.map((A,u)=>({[`${n}[${u}]`]:Mo({property:A,parentProperty:e,entityId:s})})).reduce((A,u)=>({...A,...u}),{});return me.array().of(me.mixed().test("Dynamic object validation","Dynamic object validation error",(A,u)=>Ve(a,u.path).validate(A)))}else{i=i.of(Mo({property:e.of,parentProperty:e,entityId:s}));const a=Za(e.of);a&&(typeof a=="boolean"?i=i.uniqueInArray(A=>A,`${e.name} should have unique values within the array`):Array.isArray(a)&&a.forEach(([A,u])=>{i=i.uniqueInArray(f=>f&&f[A],`${e.name} → ${u.name??A}: should have unique values within the array`)}))}const l=e.validation;return l?(i=l.required?i.required(l?.requiredMessage?l.requiredMessage:"Required").nullable(!0):i.notRequired().nullable(!0),(l.min||l.min===0)&&(i=i.min(l.min,`${e.name} should be min ${l.min} entries long`)),l.max&&(i=i.max(l.max,`${e.name} should be max ${l.max} entries long`))):i=i.notRequired().nullable(!0),i}const Ka=({containerRef:e})=>{const{isSubmitting:t,isValidating:r,errors:n}=we.useFormikContext();return d.useEffect(()=>{const s=Object.keys(n);if(s.length>0&&t&&!r){const i=e?.current?.querySelector(`#form_field_${s[0]}`);if(i&&e?.current){const l=yi(e.current);if(l){const A=i.getBoundingClientRect().top;l.scrollTo({top:l.scrollTop+A-64,behavior:"smooth"})}const a=i.querySelector("input");a&&a.focus()}}},[t,r,n,e]),null},Ra=e=>{const t=e&&e.scrollHeight>e.clientHeight,r=e?window.getComputedStyle(e).overflowY:null,n=r&&r.indexOf("hidden")!==-1;return t&&!n},yi=e=>!e||e===document.body?document.body:Ra(e)?e:yi(e.parentNode),pe=({collection:e,path:t,entityId:r,values:n,previousValues:s,userConfigPersistence:i,fields:l})=>{const a=i?.getCollectionConfig(t),A=Ve(a,"properties"),u=Po(e.properties),f=n??u,h=s??n??u,b=Object.entries(e.properties).map(([p,w])=>{const C=f?we.getIn(f,p):void 0;return{[p]:Ie({propertyKey:p,propertyOrBuilder:w,values:f,previousValues:h,path:t,propertyValue:C,entityId:r,fields:l})}}).filter(p=>p!==null).reduce((p,w)=>({...p,...w}),{}),v=Le(b,A),g=Object.entries(v).filter(([p,w])=>!!w?.dataType).map(([p,w])=>({[p]:w})).reduce((p,w)=>({...p,...w}),{});return{...e,properties:g,originalCollection:e}};function Ie({propertyOrBuilder:e,propertyValue:t,fromBuilder:r=!1,...n}){if(typeof e=="object"&&"resolved"in e)return e;let s=null;if(e)if(Te(e)){const i=n.path;if(!i)throw Error("Trying to resolve a property builder without specifying the entity path");const l=e({...n,path:i,propertyValue:t,values:n.values??{},previousValues:n.previousValues??n.values??{}});if(!l)return console.debug("Property builder not returning `Property` so it is not rendered",i,n.entityId,e),null;s=Ie({...n,propertyValue:t,propertyOrBuilder:l,fromBuilder:!0})}else{const i=e;if(i.dataType==="map"&&i.properties){const l=pr({...n,properties:i.properties,propertyValue:t});s={...i,resolved:!0,fromBuilder:r,properties:l}}else i.dataType==="array"?s=_e({property:i,propertyValue:t,fromBuilder:r,...n}):(i.dataType==="string"||i.dataType==="number")&&i.enumValues&&(s=br(i,r))}else return null;if(s||(s={...e,resolved:!0,fromBuilder:r}),s.fieldConfig){const i=n.fields;if(!i)throw Error("Trying to resolve a property that inherits from a custom field but no custom fields were provided. Use the property `fields` in your top level component to provide them");const l=i[s.fieldConfig];if(!l)throw Error(`Trying to resolve a property that inherits from a custom field but no custom field with id ${s.fieldConfig} was found. Check the \`fields\` in your top level component`);if(l.defaultProperty){const a=Ie({propertyOrBuilder:l.defaultProperty,propertyValue:t,...n});a&&(s=Le(a,s))}l.Field&&(s.Field=l.Field)}return s?{...s,resolved:!0}:null}function _e({propertyKey:e,property:t,propertyValue:r,...n}){if(t.of){if(Array.isArray(t.of))return{...t,resolved:!0,fromBuilder:n.fromBuilder,resolvedProperties:t.of.map((s,i)=>Ie({propertyKey:`${e}.${i}`,propertyOrBuilder:s,propertyValue:Array.isArray(r)?r[i]:void 0,...n,index:i}))};{const s=t.of,i=Array.isArray(r)?r.map((a,A)=>Ie({propertyKey:`${e}.${A}`,propertyOrBuilder:s,propertyValue:a,...n,index:A})).filter(a=>!!a):[],l=Ie({propertyKey:`${e}`,propertyOrBuilder:s,propertyValue:void 0,...n});if(!l)throw Error("When using a property builder as the 'of' prop of an ArrayProperty, you must return a valid child property");return{...t,resolved:!0,fromBuilder:n.fromBuilder,of:l,resolvedProperties:i}}}else if(t.oneOf){const s=t.oneOf?.typeField??To,i=Array.isArray(r)?r.map((a,A)=>{const u=a&&a[s],f=t.oneOf?.properties[u];return!u||!f?null:Ie({propertyKey:`${e}.${A}`,propertyOrBuilder:f,propertyValue:r,...n})}).filter(a=>!!a):[],l=pr({properties:t.oneOf.properties,propertyValue:void 0,...n});return{...t,resolved:!0,oneOf:{...t.oneOf,properties:l},fromBuilder:n.fromBuilder,resolvedProperties:i}}else{if(t.Field)return{...t,resolved:!0,fromBuilder:n.fromBuilder};throw Error("The array property needs to declare an 'of' or a 'oneOf' property, or provide a custom `Field`")}}function pr({properties:e,propertyValue:t,...r}){return Object.entries(e).map(([n,s])=>({[n]:Ie({propertyKey:n,propertyOrBuilder:s,propertyValue:t&&typeof t=="object"?Ve(t,n):void 0,...r})})).filter(n=>n!==null).reduce((n,s)=>({...n,...s}),{})}function br(e,t){return typeof e.enumValues=="object"?{...e,resolved:!0,enumValues:Qo(e.enumValues)?.filter(r=>r&&r.id&&r.label)??[],fromBuilder:t??!1}:e}function Qo(e){return typeof e=="object"?Object.entries(e).map(([t,r])=>typeof r=="string"?{id:t,label:r}:r):Array.isArray(e)?e:void 0}const wi="CustomIdField",vr={input:`${wi}-input`,select:`${wi}-select`},ec=ge.styled(c.FormControl)(({theme:e})=>({marginBottom:"16px",[`& .${vr.input}`]:{minHeight:"64px"},[`& .${vr.select}`]:{paddingTop:e.spacing(1/2)}}));function oc({customId:e,entityId:t,status:r,onChange:n,error:s,entity:i}){const l=r==="existing"||!e,a=r!=="existing"&&!e,A=d.useMemo(()=>{if(!(!e||typeof e=="boolean"||e==="optional"))return Qo(e)},[e]),u=He(),{copy:f}=Sn({onSuccess:g=>u.open({type:"success",message:`Copied ${g}`})}),h=oe(),b={sx:g=>({minHeight:"64px",borderRadius:`${g.shape.borderRadius}px`}),disableUnderline:!0,endAdornment:i?o.jsxs(c.InputAdornment,{position:"end",children:[o.jsx(c.IconButton,{onClick:g=>f(i.id),"aria-label":"copy-id",size:"large",children:o.jsx(c.Tooltip,{title:"Copy",children:o.jsx("svg",{className:"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall",fill:"currentColor",width:"20",height:"20",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})})})}),h?.entityLinkBuilder&&o.jsx("a",{href:h.entityLinkBuilder({entity:i}),rel:"noopener noreferrer",target:"_blank",children:o.jsx(c.IconButton,{onClick:g=>g.stopPropagation(),"aria-label":"go-to-datasource",size:"large",children:o.jsx(c.Tooltip,{title:"Open in the console",children:o.jsx(xo,{fontSize:"small"})})})})]}):void 0},v={label:a?"ID is set automatically":"ID",disabled:l,name:"id",type:null,value:(i&&r==="existing"?i.id:t)??"",variant:"filled",sx:g=>({minHeight:"64px",borderRadius:`${g.shape.borderRadius}px`})};return gl.createElement(ec,{fullWidth:!0,error:s,...v,key:"custom-id-field"},A&&o.jsxs(o.Fragment,{children:[o.jsx(c.InputLabel,{id:"id-label",children:v.label}),o.jsx(c.Select,{labelId:"id-label",fullWidth:!0,className:vr.select,disableUnderline:!0,error:s,...v,onChange:g=>n(g.target.value),children:A.map(g=>o.jsx(c.MenuItem,{value:g.id,children:`${g.id} - ${g.label}`},`custom-id-item-${g.id}`))})]}),!A&&o.jsx(c.TextField,{...v,error:s,InputProps:b,helperText:e==="optional"?"Autogenerated ID, it can be manually changed":r==="new"||r==="copy"?"ID of the new document":"ID of the document",onChange:g=>{let p=g.target.value;return p&&(p=p.trim()),n(p.length?p:void 0)}}),o.jsx(we.ErrorMessage,{name:"id",component:"div",children:g=>"You need to specify an ID"}))}const Ci=d.memo(tc,(e,t)=>e.status===t.status&&e.path===t.path&&le(e.entity?.values,t.entity?.values));function tc({status:e,path:t,collection:r,entity:n,onEntitySave:s,onDiscard:i,onModified:l,onValuesChanged:a,onIdChange:A,onFormContextChange:u,hideId:f}){const h=oe(),b=Se(),v=h.plugins,g=d.useMemo(()=>pe({collection:r,path:t,values:n?.values,fields:h.fields}),[n?.values,t]),p=(e==="new"||e==="copy")&&!!g.customId&&g.customId!=="optional",w=d.useMemo(()=>e==="new"||e==="copy"?p?void 0:b.generateEntityId(t):n?.id,[]),C=d.useRef(!1),x=d.useMemo(()=>{const D=g.properties;if((e==="existing"||e==="copy")&&n)return n.values??Po(D);if(e==="new")return Po(D);throw console.error({status:e,entity:n}),new Error("Form has not been initialised with the correct parameters")},[e,g,n]),[B,E]=d.useState(w),[m,k]=d.useState(!1),[S,F]=d.useState(),[I,T]=d.useState(n?.values??x),[P,M]=d.useState(I),L=d.useCallback(D=>{M(D),a&&a(D)},[a]);d.useEffect(()=>{B&&A&&A(B)},[B,A]);const W=d.useMemo(()=>pe({collection:r,path:t,entityId:B,values:P,previousValues:I,fields:h.fields}),[r,t,B,P,I]),$=W.callbacks?.onIdUpdate;d.useEffect(()=>{if($&&P&&(e==="new"||e==="copy"))try{E($({collection:W,path:t,entityId:B,values:P,context:h}))}catch(D){console.error(D)}},[W,h,B,P,t,e]);const Z=d.useMemo(()=>I&&e==="existing"?Object.entries(W.properties).map(([D,Q])=>{if(tt(Q))return{};const j=I[D],V=x[D];return le(j,V)?{}:{[D]:V}}).reduce((D,Q)=>({...D,...Q}),{}):{},[x,W.properties,I,e]),z=d.useCallback((D,Q)=>{if(p&&!B){console.error("Missing custom Id"),k(!0),Q.setSubmitting(!1);return}if(F(void 0),k(!1),e==="existing"){if(!n?.id)throw Error("Form misconfiguration when saving, no id for existing entity")}else if(e==="new"||e==="copy"){if(W.customId&&W.customId!=="optional"&&!B)throw Error("Form misconfiguration when saving, entityId should be set")}else throw Error("New FormType added, check EntityForm");s?.({collection:W,path:t,entityId:B,values:D,previousValues:n?.values,closeAfterSave:C.current}).then(j=>{const V=e==="new"?"new_entity_saved":e==="copy"?"entity_copied":e==="existing"?"entity_edited":"unmapped_event";h.onAnalyticsEvent?.(V,{path:t}),T(D),Q.resetForm({values:D,submitCount:0,touched:{}})}).catch(j=>{console.error(j),F(j)}).finally(()=>{C.current=!1,Q.setSubmitting(!1)})},[e,t,W,n,s,p,B]),J=d.useCallback(({name:D,value:Q,property:j})=>b.checkUniqueField(t,D,Q,j,B),[b,t,B]),O=d.useMemo(()=>B?vi(B,W.properties,J):void 0,[B,W.properties]);return o.jsx(we.Formik,{initialValues:x,onSubmit:z,validationSchema:O,validate:D=>console.debug("Validating",D),onReset:()=>i&&i(),children:D=>{const Q=[],j={setFieldValue:D.setFieldValue,values:D.values,collection:pe({collection:W,path:t}),entityId:B,path:t};if(d.useEffect(()=>{u&&u(j)},[u,j]),v&&W){const V={entityId:B,path:t,status:e,collection:W,context:h,currentEntityId:B,formContext:j};Q.push(...v.map((re,G)=>re.form?.Actions?o.jsx(re.form.Actions,{...V},`actions_${re.name}`):null).filter(Boolean))}return o.jsx(o.Fragment,{children:o.jsxs(c.Box,{sx:V=>({paddingLeft:V.spacing(4),paddingRight:V.spacing(4),paddingTop:V.spacing(3),paddingBottom:V.spacing(4),marginBottom:V.spacing(2),[V.breakpoints.down("lg")]:{paddingLeft:V.spacing(2),paddingRight:V.spacing(2),paddingTop:V.spacing(2),paddingBottom:V.spacing(3)},[V.breakpoints.down("md")]:{padding:V.spacing(2)}}),children:[Q.length>0&&o.jsx(c.Box,{sx:V=>({width:"100%",display:"flex",justifyContent:"flex-end",background:V.palette.mode==="light"?"rgba(255,255,255,0.6)":c.alpha(V.palette.background.paper,.1),backdropFilter:"blur(8px)",borderBottom:`1px solid ${V.palette.divider}`,flexDirection:"row",alignItems:"center",position:"absolute",top:0,right:0,left:0,textAlign:"right",zIndex:2,"& > *:not(:last-child)":{[V.breakpoints.down("md")]:{mr:V.spacing(1)},mr:V.spacing(2)}}),children:Q}),o.jsx(c.Box,{sx:V=>({width:"100%",marginTop:V.spacing(4+(Q?4:0)),paddingY:2,display:"flex",alignItems:"center",[V.breakpoints.down("lg")]:{marginTop:V.spacing(3+(Q?4:0))},[V.breakpoints.down("md")]:{marginTop:V.spacing(2+(Q?4:0))}}),children:o.jsx(c.Typography,{sx:{marginTop:4,marginBottom:W.hideIdFromForm?0:4,flexGrow:1},variant:"h4",children:W.singularName??W.name+" entry"})}),!f&&o.jsx(oc,{customId:W.customId,entityId:B,status:e,onChange:E,error:m,entity:n}),B&&o.jsx(rc,{...D,initialValues:I,onModified:l,onValuesChanged:L,underlyingChanges:Z,path:t,entity:n,entityId:B,collection:W,formContext:j,status:e,savingError:S,closeAfterSaveRef:C})]})})}})}function rc(e){const{initialValues:t,values:r,onModified:n,onValuesChanged:s,underlyingChanges:i,entityId:l,formContext:a,entity:A,touched:u,setFieldValue:f,collection:h,path:b,isSubmitting:v,status:g,handleSubmit:p,savingError:w,dirty:C,errors:x,closeAfterSaveRef:B}=e,E=C;d.useEffect(()=>{n&&n(E),s&&s(r)},[E,r]),d.useEffect(()=>{i&&A&&Object.entries(i).forEach(([F,I])=>{const T=r[F];!le(I,T)&&!u[F]&&(console.debug("Updated value from the datasource:",F,I),f(F,I!==void 0?I:null))})},[i,A,r,u,f]);const m=o.jsx(c.Grid,{container:!0,spacing:6,children:Object.entries(h.properties).map(([F,I])=>{const T=!!i&&Object.keys(i).includes(F)&&!!u[F],P=v||uo(I)||!!I.disabled,M={propertyKey:F,disabled:P,property:I,includeDescription:!0,underlyingValueHasChanged:T,context:a,tableMode:!1,partOfArray:!1,autoFocus:!1};return o.jsx(c.Grid,{item:!0,xs:12,id:`form_field_${F}`,children:o.jsx(oo,{...M})},`field_${h.name}_${F}`)})}),k=v||!E&&g==="existing",S=d.createRef();return o.jsxs(we.Form,{onSubmit:p,noValidate:!0,children:[o.jsxs(c.Box,{sx:{mt:4},ref:S,children:[m,o.jsx(Ka,{containerRef:S})]}),o.jsx(c.Box,{sx:{height:56}}),o.jsxs(je,{position:"absolute",children:[w&&o.jsx(c.Box,{textAlign:"right",children:o.jsx(c.Typography,{color:"error",children:w.message})}),g==="existing"&&o.jsx(c.Button,{variant:"text",color:"primary",disabled:k,type:"reset",children:"Discard"}),o.jsxs(c.Button,{variant:"text",color:"primary",type:"submit",disabled:k,onClick:()=>{B.current=!1},children:[g==="existing"&&"Save",g==="copy"&&"Create copy",g==="new"&&"Create"]}),o.jsxs(c.Button,{variant:"contained",color:"primary",type:"submit",disabled:k,onClick:()=>{B.current=!0},children:[g==="existing"&&"Save and close",g==="copy"&&"Create copy and close",g==="new"&&"Create and close"]})]})]})}function nc({propertyKey:e,value:t,error:r,showError:n,isSubmitting:s,setValue:i,tableMode:l,property:a,includeDescription:A,underlyingValueHasChanged:u,context:f,disabled:h}){if(!Array.isArray(a.resolvedProperties))throw Error("ArrayCustomShapedFieldBinding misconfiguration. Property `of` not set");const b=a.expanded===void 0?!0:a.expanded;ke({property:a,value:t,setValue:i});const v=o.jsx(Ee,{icon:ve(a),title:a.name}),g=a.resolvedProperties.map((p,w)=>{const C={propertyKey:`${e}[${w}]`,disabled:h,property:p,includeDescription:A,underlyingValueHasChanged:u,context:f,tableMode:!1,partOfArray:!0,autoFocus:!1};return o.jsx(c.Box,{pb:1,children:o.jsx(oo,{...C})},`custom_shaped_array_${w}`)});return o.jsxs(c.FormControl,{fullWidth:!0,error:n,children:[!l&&o.jsx(to,{initiallyExpanded:b,title:v,children:g}),l&&g,A&&o.jsx(Be,{property:a}),n&&typeof r=="string"&&o.jsx(c.FormHelperText,{error:!0,children:r})]})}const xi={text_field:{name:"Text field",description:"Simple short text",dataType:"string",Icon:Ms,color:"#2d7ff9",Field:ho},multiline:{name:"Multiline",description:"Text with multiple lines",dataType:"string",Icon:Qs,color:"#2d7ff9",Field:ho},markdown:{name:"Markdown",description:"Text with advanced markdown syntax",dataType:"string",Icon:Hs,color:"#2d7ff9",Field:bi},url:{name:"Url",description:"Text with URL validation",dataType:"string",Icon:zs,color:"#154fb3",Field:ho},email:{name:"Email",description:"Text with email validation",dataType:"string",Icon:on,color:"#154fb3",Field:ho},select:{name:"Select/enum",description:"Select one text value from within an enumeration",dataType:"string",Icon:Os,color:"#4223c9",Field:ar},multi_select:{name:"Multi select",description:"Select multiple text values from within an enumeration",dataType:"array",Icon:Ys,color:"#4223c9",Field:cr},number_input:{name:"Number input",description:"Simple number field with validation",dataType:"number",Icon:Ns,color:"#bec920",Field:ho},number_select:{name:"Number select",description:"Select a number value from within an enumeration",dataType:"number",Icon:en,color:"#bec920",Field:ar},multi_number_select:{name:"Multiple number select",description:"Select multiple number values from within an enumeration",dataType:"array",Icon:en,color:"#bec920",Field:cr},file_upload:{name:"File upload",description:"Input for uploading single files",dataType:"string",Icon:$s,color:"#f92d9a",Field:fr},multi_file_upload:{name:"Multiple file upload",description:"Input for uploading multiple files",dataType:"array",Icon:Vs,color:"#f92d9a",Field:fr},reference:{name:"Reference",description:"The value refers to a different collection",dataType:"reference",Icon:Rr,color:"#ff0042",Field:fi},multi_references:{name:"Multiple references",description:"Multiple values that refer to a different collection",dataType:"array",Icon:Ls,color:"#ff0042",Field:ei},switch:{name:"Switch",description:"True or false field (or yes or no, 0 or 1...)",dataType:"boolean",Icon:Us,color:"#20d9d2",Field:Ai},date_time:{name:"Date/time",description:"A date time select field",dataType:"date",Icon:Gs,color:"#8b46ff",Field:ui},group:{name:"Group",description:"Group of multiple fields",dataType:"map",Icon:_s,color:"#ff9408",Field:gi},repeat:{name:"Repeat/list",description:"A field that gets repeated multiple times (e.g. multiple text fields)",dataType:"array",Icon:Kr,color:"#ff9408",Field:hi},custom_array:{name:"Custom array",description:"A field that saved its value as an array of custom objects",dataType:"array",Icon:Kr,color:"#ff9408",Field:nc},block:{name:"Block",description:"A complex field that allows the user to compose different fields together, with a key->value format",dataType:"array",Icon:Ws,color:"#ff9408",Field:pi}};function at(e){const t=yr(e);return t?xi[t]:void 0}function yr(e){if(e.dataType==="string")return e.multiline?"multiline":e.markdown?"markdown":e.storage?"file_upload":e.url?"url":e.email?"email":e.enumValues?"select":"text_field";if(e.dataType==="number")return e.enumValues?"number_select":"number_input";if(e.dataType==="map"){if(e.properties)return"group"}else if(e.dataType==="array"){const t=e.of,r=e.oneOf;return Array.isArray(t)?"custom_array":Te(t)?"repeat":t?.dataType==="string"&&t.enumValues?"multi_select":t?.dataType==="number"&&t.enumValues?"multi_number_select":t?.dataType==="string"&&t.storage?"multi_file_upload":t?.dataType==="reference"?"multi_references":r?"block":"repeat"}else{if(e.dataType==="boolean")return"switch";if(e.dataType==="date")return"date_time";if(e.dataType==="reference")return"reference"}console.error("Unsupported field config mapping",e)}function Bi(e,t){const r=Ie({propertyKey:"ignore",propertyOrBuilder:e,fields:t});return r?r.dataType==="reference"?!0:r.dataType==="array"?Array.isArray(r.of)?!1:r.of?.dataType==="reference":!1:null}function Ei(e="inherit",t="inherit"){return o.jsx(Ts,{color:e,fontSize:t})}function mi(e,t,r){const n=e?.Icon??Ps;return o.jsx(n,{color:t,fontSize:r})}function ve(e,t="inherit",r="inherit"){if(Te(e))return o.jsx(Ds,{color:t,fontSize:r});{const n=at(e);return mi(n,t,r)}}function ic(e,t="inherit"){return o.jsx(c.Box,{sx:{background:e?.color??"#888",height:"32px",width:"32px",padding:.5,borderRadius:"50%",boxShadow:"0px 2px 1px -1px rgb(0 0 0 / 20%), 0px 1px 1px 0px rgb(0 0 0 / 14%), 0px 1px 3px 0px rgb(0 0 0 / 12%)",color:"white"},children:mi(e,t,"medium")})}function sc(e){return Te(e)?"#888":at(e)?.color??"#666"}function wr(e,t){if(typeof e=="object"){if(t in e)return e[t];if(t.includes(".")){const r=t.split("."),n=e[r[0]];if(typeof n=="object"&&n.dataType==="map"&&n.properties)return wr(n.properties,r.slice(1).join("."))}}}function Cr(e,t){if(typeof e=="object"){if(t in e)return e[t];if(t.includes(".")){const r=t.split("."),n=e[r[0]];if(n.dataType==="map"&&n.properties)return Cr(n.properties,r.slice(1).join("."))}}}function lc(e){return e.replace(/\.([^.]*)/g,"[$1]")}const ct={read:!0,edit:!0,create:!0,delete:!0};function Lo(e,t,r,n){const s=e.permissions;if(s===void 0)return ct;if(typeof s=="object")return s;if(typeof s=="function")return s({entity:n,user:t.user,authController:t,collection:e,pathSegments:r});throw console.error("Permissions:",s),Error("New type of permission added and not mapped")}function xr(e,t,r,n){return Lo(e,t,r,n).edit??ct.edit}function dt(e,t,r,n){return Lo(e,t,r,n).create??ct.create}function Br(e,t,r,n){return Lo(e,t,r,n).delete??ct.delete}function ki(e){if(e)return e in Mt?Mt[e]:void 0}function At(e){const t=ki(e.icon);if(e?.icon&&t)return t;const r=Er.length,n=Er[Tn(e.path)%r];return Mt[n]}const Er=["AcUnit","Adjust","AlignHorizontalCenter","Album","AllInclusive","AllOut","Animation","Assistant","Attractions","Audiotrack","AutoAwesome","AutoAwesomeMosaic","BeachAccess","Bolt","Brightness1","BreakfastDining","BrokenImage","Brightness5","Cable","CalendarViewMonth","CatchingPokemon","Casino","Category","Cloud","ColorLens","CreditCard","Coronavirus","Earbuds","EggAlt","FiberSmartRecord","Flag","Healing","HeatPump","Hive","Hub","LocalFireDepartment","LocalPizza","Memory","Outlet","Pages","PanoramaPhotosphere","SignalCellular0Bar","SportsBaseball","Storm","Stairs"];function ac(e,t){if(t!==void 0&&t===1)return e;const r={"(quiz)$":"$1zes","^(ox)$":"$1en","([m|l])ouse$":"$1ice","(matr|vert|ind)ix|ex$":"$1ices","(x|ch|ss|sh)$":"$1es","([^aeiouy]|qu)y$":"$1ies","(hive)$":"$1s","(?:([^f])fe|([lr])f)$":"$1$2ves","(shea|lea|loa|thie)f$":"$1ves",sis$:"ses","([ti])um$":"$1a","(tomat|potat|ech|her|vet)o$":"$1oes","(bu)s$":"$1ses","(alias)$":"$1es","(octop)us$":"$1i","(ax|test)is$":"$1es","(us)$":"$1es","([^s]+)$":"$1s"},n={move:"moves",foot:"feet",goose:"geese",sex:"sexes",child:"children",man:"men",tooth:"teeth",person:"people"};if(["sheep","fish","deer","moose","series","species","money","rice","information","equipment","bison","cod","offspring","pike","salmon","shrimp","swine","trout","aircraft","hovercraft","spacecraft","sugar","tuna","you","wood"].indexOf(e.toLowerCase())>=0)return e;for(const i in n){const l=new RegExp(`${i}$`,"i"),a=n[i];if(l.test(e))return e.replace(l,a)}for(const i in r){const l=new RegExp(i,"i");if(l.test(e))return e.replace(l,r[i])}return e}function cc(e,t){if(t!==void 0&&t!==1)return e;const r={"(quiz)zes$":"$1","(matr)ices$":"$1ix","(vert|ind)ices$":"$1ex","^(ox)en$":"$1","(alias)es$":"$1","(octop|vir)i$":"$1us","(cris|ax|test)es$":"$1is","(shoe)s$":"$1","(o)es$":"$1","(bus)es$":"$1","([m|l])ice$":"$1ouse","(x|ch|ss|sh)es$":"$1","(m)ovies$":"$1ovie","(s)eries$":"$1eries","([^aeiouy]|qu)ies$":"$1y","([lr])ves$":"$1f","(tive)s$":"$1","(hive)s$":"$1","(li|wi|kni)ves$":"$1fe","(shea|loa|lea|thie)ves$":"$1f","(^analy)ses$":"$1sis","((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$":"$1$2sis","([ti])a$":"$1um","(n)ews$":"$1ews","(h|bl)ouses$":"$1ouse","(corpse)s$":"$1","(us)es$":"$1",s$:""},n={move:"moves",foot:"feet",goose:"geese",sex:"sexes",child:"children",man:"men",tooth:"teeth",person:"people"};if(["sheep","fish","deer","moose","series","species","money","rice","information","equipment","bison","cod","offspring","pike","salmon","shrimp","swine","trout","aircraft","hovercraft","spacecraft","sugar","tuna","you","wood"].indexOf(e.toLowerCase())>=0)return e;for(const i in n){const l=new RegExp(`${n[i]}$`,"i");if(l.test(e))return e.replace(l,i)}for(const i in r){const l=new RegExp(i,"i");if(l.test(e))return e.replace(l,r[i])}return e}function mr(e,t,r,n=3){const s=Object.keys(e.properties);let i=r?.filter(l=>s.includes(l));return i&&i.length>0?i:(i=s,i.filter(l=>{const a=e.properties[l];return a&&!Te(a)&&!Bi(a,t)}).slice(0,n))}const ut="EntityPreview",Oe={property:`${ut}-property`,valuePreview:`${ut}-valuePreview`,iconCell:`${ut}-iconCell`,titleCell:`${ut}-titleCell`},dc=ge.styled(c.TableContainer)(({theme:e})=>({[`& .${Oe.property}`]:{display:"flex"},[`& .${Oe.valuePreview}`]:{height:"72px",padding:e.spacing(2,3)},[`& .${Oe.iconCell}`]:{paddingTop:e.spacing(1)},[`& .${Oe.titleCell}`]:{width:"25%",padding:e.spacing(1)}}));function kr({entity:e,collection:t,path:r}){const n=oe(),s=Ce.useMemo(()=>pe({collection:t,path:r,entityId:e.id,values:e.values,fields:n.fields}),[t,r,e]),i=oe(),l=s.properties;return o.jsxs(o.Fragment,{children:[o.jsx(c.Box,{sx:a=>({width:"100%",marginTop:a.spacing(3),paddingLeft:a.spacing(4),paddingRight:a.spacing(4),paddingTop:a.spacing(3),[a.breakpoints.down("lg")]:{marginTop:a.spacing(2),paddingLeft:a.spacing(2),paddingRight:a.spacing(2),paddingTop:a.spacing(2)},[a.breakpoints.down("md")]:{marginTop:a.spacing(1),paddingLeft:a.spacing(2),paddingRight:a.spacing(2),paddingTop:a.spacing(2)}}),children:o.jsx(c.Typography,{sx:{marginTop:4,marginBottom:4},variant:"h4",children:t.singularName??t.name+" entry"})}),o.jsx(dc,{children:o.jsx(c.Table,{"aria-label":"entity table",children:o.jsxs(c.TableBody,{children:[o.jsxs(c.TableRow,{children:[o.jsx(c.TableCell,{align:"right",component:"td",scope:"row",className:Oe.titleCell,children:o.jsx(c.Typography,{variant:"caption",color:"textSecondary",children:"Id"})}),o.jsx(c.TableCell,{padding:"none",className:Oe.iconCell,children:Ei("disabled","small")}),o.jsx(c.TableCell,{className:Oe.valuePreview,children:o.jsxs(c.Box,{display:"flex",alignItems:"center",children:[e.id,i?.entityLinkBuilder&&o.jsx("a",{href:i.entityLinkBuilder({entity:e}),rel:"noopener noreferrer",target:"_blank",children:o.jsx(c.IconButton,{"aria-label":"go-to-entity-datasource",size:"large",children:o.jsx(xo,{fontSize:"small"})})})]})})]}),t&&Object.entries(l).map(([a,A])=>{const u=e.values[a];return o.jsxs(c.TableRow,{children:[o.jsx(c.TableCell,{align:"right",component:"td",scope:"row",className:Oe.titleCell,children:o.jsx(c.Typography,{sx:{paddingLeft:2},variant:"caption",color:"textSecondary",children:A.name})}),o.jsx(c.TableCell,{padding:"none",className:Oe.iconCell,children:ve(A,"disabled","small")}),o.jsx(c.TableCell,{className:Oe.valuePreview,children:o.jsx(ne,{children:o.jsx(xe,{propertyKey:a,value:u,entity:e,property:A,size:"regular"})})})]},"entity_prev"+A.name+a)})]})})})]})}function Ac(e){return e.dataType==="boolean"?"center":e.dataType==="number"?e.enumValues?"left":"right":e.dataType==="date"?"right":"left"}function Si(e){if(e.columnWidth)return e.columnWidth;if(e.dataType==="string")return e.url?280:e.storage?160:e.enumValues?200:e.multiline||e.markdown?300:(e.email,200);if(e.dataType==="array"){const t=e;return t.of?Array.isArray(e.of)?300:Si(t.of):300}else return e.dataType==="number"?e.enumValues?200:140:e.dataType==="map"?360:e.dataType==="date"?200:e.dataType==="reference"?220:e.dataType==="boolean"?140:200}function Fi(e){return`subcollection:${e.alias??e.path}`}function uc(e){const{disabled:t,value:r,multiline:n,updateValue:s,focused:i}=e,[l,a]=d.useState(r),A=d.useRef(!1),u=d.useCallback(()=>{!r&&!l||l!==r&&s(l)},[l,r]);lr(l,u,3e3),d.useEffect(()=>{r!==l&&a(r)},[r]);const f=d.createRef();return d.useEffect(()=>{f.current&&i&&!A.current?(A.current=!0,f.current.focus({preventScroll:!0}),f.current.selectionStart=f.current.value.length,f.current.selectionEnd=f.current.value.length):A.current=i},[i,f]),o.jsx(gr,{ref:f,style:{padding:0,margin:0,width:"100%",color:"unset",fontWeight:"unset",lineHeight:"unset",fontSize:"unset",fontFamily:"unset",background:"unset",border:"unset",resize:"none",outline:"none"},value:l??"",onChange:h=>{const b=h.target.value;(n||!b.endsWith(`
`))&&a(b)},onBlur:()=>{u()}})}function Sr(e){const{name:t,enumValues:r,error:n,internalValue:s,disabled:i,small:l,focused:a,updateValue:A,multiple:u,valueType:f}=e,[h,b]=d.useState(!1),v=d.useCallback(()=>{b(!0)},[]),g=d.useCallback(()=>{b(!1)},[]),p=Array.isArray(s)&&u||!Array.isArray(s)&&!u,w=d.createRef();d.useEffect(()=>{w.current&&a&&w.current?.focus({preventScroll:!0})},[a,w]);const C=d.useCallback(B=>{if(f==="number")if(u){const E=B.target.value.map(m=>parseFloat(m));A(E)}else A(parseFloat(B.target.value));else if(f==="string")B.target.value?A(B.target.value):A(null);else throw Error("Missing mapping in TableSelect")},[u,A,f]),x=B=>u&&Array.isArray(B)?o.jsx(Xo,{value:B,name:t,enumValues:r,size:l?"small":"regular"}):o.jsx(Fe,{enumKey:B,enumValues:r,small:l});return o.jsx(c.Select,{variant:"standard",inputRef:w,sx:{height:"100%"},open:h,disabled:i,multiple:u,onClose:g,onOpen:v,fullWidth:!0,inputProps:{sx:{height:"100% !important",display:"flex",alignItems:"center",padding:"0px 0 0px",background:"transparent !important"}},disableUnderline:!0,error:!!n,value:p?u?s.map(B=>B.toString()):s:u?[]:"",onChange:C,renderValue:x,children:qo(r).map(B=>{const E=B.id,m=o.jsx(Fe,{enumKey:E,enumValues:r,small:!0});return u?o.jsxs(c.MenuItem,{value:E,disabled:Zo(B),dense:!0,children:[o.jsx(c.Checkbox,{checked:Array.isArray(s)&&s.map(k=>k.toString()).includes(E.toString())}),o.jsx(c.ListItemText,{primary:m})]},`select-${t}-${E}`):o.jsx(c.MenuItem,{value:E,disabled:Zo(B),dense:!0,children:m},`select-${t}-${E}`)})},`table_select_${t}`)}function fc(e){const{align:t,value:r,updateValue:n,focused:s,onBlur:i,disabled:l}=e,a=r&&typeof r=="number"?r.toString():"",[A,u]=d.useState(a),f=d.useCallback(()=>{if(A!==a)if(A!=null){const v=parseFloat(A);if(isNaN(v))return;v!=null&&n(v)}else n(null)},[A,r]);lr(A,f,3e3),d.useEffect(()=>{!s&&a!==A&&u(r!=null?r.toString():null)},[r,s]);const h=d.createRef();d.useEffect(()=>{h.current&&s&&h.current.focus({preventScroll:!0})},[s,h]);const b=/^-?[0-9]+[,.]?[0-9]*$/;return o.jsx(c.Input,{inputRef:h,sx:{width:"100%",fontSize:"unset",fontFamily:"unset",background:"unset",border:"unset",resize:"none",outline:"none",padding:0,margin:0,color:"unset",fontWeight:"unset",lineHeight:"unset",textAlign:"right"},inputProps:{style:{textAlign:t}},disabled:l,disableUnderline:!0,value:A??"",onBlur:i,onChange:v=>{const g=v.target.value.replace(",",".");g.length===0&&u(null),(b.test(g)||g.startsWith("-"))&&u(g)}})}function gc(e){const{disabled:t,internalValue:r,updateValue:n,focused:s}=e,i=d.createRef();return d.useEffect(()=>{i.current&&s&&i.current.focus({preventScroll:!0})},[s,i]),o.jsx(c.Switch,{inputRef:i,color:"secondary",checked:!!r,disabled:t,onChange:l=>{const a=l.target.checked;n(a)}})}function hc(e){const{disabled:t,error:r,mode:n,internalValue:s,updateValue:i}=e,l=n===void 0||n==="date_time"?Dt.DateTimePicker:Tt.DatePicker;return o.jsx(l,{value:s??null,disabled:t,onChange:a=>{i(a)},renderInput:a=>o.jsx(c.TextField,{...a,fullWidth:!0,variant:"standard",error:!!r,style:{height:"100%"},InputProps:{...a.InputProps,style:{fontSize:14},disableUnderline:!0,endAdornment:o.jsx(c.Box,{sx:{pr:1},children:a.InputProps?.endAdornment})}}),InputAdornmentProps:{style:{fontSize:"small",height:26}}})}function Ii(e){const{name:t,internalValue:r,updateValue:n,multiselect:s,path:i,size:l,previewProperties:a,title:A,disabled:u,forceFilter:f}=e,[h,b]=d.useState(!1),v=d.useCallback(()=>b(!0),[]),g=d.useCallback(()=>b(!1),[]),w=he().getCollection(i);if(!w)throw Error(`Couldn't find the corresponding collection view for the path: ${i}`);const C=d.useCallback(I=>{n(I?Re(I):null)},[n]),x=d.useCallback(I=>{n(I.map(T=>Re(T)))},[n]),B=r?Array.isArray(r)?r.map(I=>I.id):r.id?[r.id]:[]:[],E=So({multiselect:s,path:i,collection:w,onMultipleEntitiesSelected:x,onSingleEntitySelected:C,selectedEntityIds:B,forceFilter:f}),m=d.useCallback(()=>{u||E.open()},[u,E]),k=!r||Array.isArray(r)&&r.length===0,S=()=>r instanceof Me?o.jsx(Ke,{onClick:u?void 0:m,size:Ze(l),reference:r,onHover:h,disabled:!i,previewProperties:a}):o.jsx(ue,{error:"Data is not a reference"}),F=()=>Array.isArray(r)?o.jsx(o.Fragment,{children:r.map((I,T)=>o.jsx(c.Box,{sx:{m:.5,width:"100%"},children:o.jsx(Ke,{onClick:u?void 0:m,size:"tiny",reference:I,onHover:h,disabled:!i,previewProperties:a})},`preview_array_ref_${t}_${T}`))}):o.jsx(ue,{error:"Data is not an array of references"});return w?o.jsxs(c.Box,{sx:{width:"100%"},onMouseEnter:v,onMouseMove:v,onMouseLeave:g,children:[r&&!s&&S(),r&&s&&F(),k&&o.jsxs(c.Button,{onClick:m,size:"small",variant:"outlined",color:"primary",children:["Edit ",A]})]}):o.jsx(ue,{error:"The specified collection does not exist"})}const pc=e=>({transition:"background-color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms",position:"relative",height:"100%",width:"100%",outline:0,display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:e?"start":"center",alignItems:"center",border:"2px solid",borderColor:"transparent"}),bc=e=>({background:(e.palette.mode==="light","repeating-linear-gradient( 45deg, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.2) 10px, rgba(128, 128, 128, 0.25) 10px, rgba(128, 128, 128, 0.25) 20px) !important"),borderRadius:`${e.shape.borderRadius}px`,border:"2px solid",borderColor:"transparent"}),vc=e=>({background:"repeating-linear-gradient( 45deg, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.2) 10px, rgba(128, 128, 128, 0.25) 10px, rgba(128, 128, 128, 0.25) 20px) !important",borderColor:e.palette.success.light,border:"2px solid"}),yc=e=>({borderColor:e.palette.error.light,border:"2px solid"});function wc(e){const{propertyKey:t,error:r,value:n,disabled:s,property:i,entity:l,path:a,previewSize:A,updateValue:u}=e,f=lo(),{internalValue:h,setInternalValue:b,onFilesAdded:v,storage:g,onFileUploadComplete:p,storagePathBuilder:w,multipleFilesSupported:C}=ti({entityValues:l.values,entityId:l.id,path:a,property:i,propertyKey:t,storageSource:f,onChange:u,value:n,disabled:s});return o.jsx(Cc,{internalValue:h,setInternalValue:b,name:t,disabled:s,autoFocus:!1,property:i,onChange:u,entity:l,storagePathBuilder:w,storage:g,multipleFilesSupported:C,onFilesAdded:v,onFileUploadComplete:p,previewSize:A})}function Cc({property:e,name:t,internalValue:r,setInternalValue:n,entity:s,onChange:i,multipleFilesSupported:l,previewSize:a,disabled:A,autoFocus:u,storage:f,onFilesAdded:h,onFileUploadComplete:b,storagePathBuilder:v}){const[g,p]=d.useState(!1),w=l&&a==="regular"?"small":a;if(l){const $=e;if(Array.isArray($.of))throw Error("Using array properties instead of single one in `of` in ArrayProperty");if($.of){if($.of.dataType!=="string")throw Error("Storage field using array must be of data type string")}else throw Error("Storage field using array must be of data type string")}const C=f?.metadata,x=!!r,B=He(),{open:E,getRootProps:m,getInputProps:k,isDragActive:S,isDragAccept:F,isDragReject:I}=tn.useDropzone({accept:f.acceptedFiles?f.acceptedFiles.map($=>({[$]:[]})).reduce(($,Z)=>({...$,...Z}),{}):void 0,disabled:A,maxSize:f.maxSize,noClick:!0,noKeyboard:!0,onDrop:h,onDropRejected:($,Z)=>{for(const z of $)for(const J of z.errors)B.open({type:"error",message:`Error uploading file: File is larger than ${f.maxSize} bytes`})}}),{...T}=m(),P=l?"Drag 'n' drop some files here, or click here to edit":"Drag 'n' drop a file here, or click here edit",M=l?e.of:e,L=d.useMemo(()=>co(w),[w]),W=c.useTheme();return o.jsxs(c.Box,{...T,onMouseEnter:()=>p(!0),onMouseMove:()=>p(!0),onMouseLeave:()=>p(!1),sx:{...pc(x),...S?bc(W):{},...F?vc(W):{},...I?yc(W):{}},children:[o.jsx("input",{autoFocus:u,...k()}),r.map(($,Z)=>{let z;return $.storagePathOrDownloadUrl?z=o.jsx(xc,{property:M,value:$.storagePathOrDownloadUrl,entity:s,size:w},`storage_preview_${Z}`):$.file&&(z=o.jsx(si,{entry:$,metadata:C,storagePath:v($.file),onFileUploadComplete:b,imageSize:L,simple:!0},`storage_progress_${Z}`)),z}),!r&&o.jsx(c.Box,{sx:{flexGrow:1,m:2,maxWidth:200},onClick:E,children:o.jsx(c.Typography,{sx:{color:$=>$.palette.mode==="light"?"#999":"#444"},variant:"body2",align:"center",children:P})}),g&&o.jsx(c.IconButton,{color:"inherit",size:"small",onClick:E,sx:{position:"absolute",bottom:2,right:2},children:o.jsx(kl,{sx:{width:16,height:16,fill:"#888"}})})]})}function xc({property:e,value:t,size:r,entity:n}){return o.jsx(c.Box,{m:1,position:"relative",children:t&&o.jsx(ne,{children:o.jsx(xe,{propertyKey:"ignore",value:t,property:e,entity:n,size:r})})})}function po(e){switch(e){case"xl":return 400;case"l":return 280;case"m":return 140;case"s":return 80;case"xs":return 54;default:throw Error("Missing mapping for collection size -> height")}}function Bc(e,t,r,n,s,i){if(e&&!r)return s.palette.mode==="dark"?c.lighten(s.palette.background.paper,.03):c.darken(s.palette.background.default,.02);if(i)return s.palette.mode==="dark"?c.lighten(s.palette.background.paper,.035):c.darken(s.palette.background.default,.025);if(t||n)return s.palette.mode==="dark"?c.lighten(s.palette.background.paper,.022):c.darken(s.palette.background.default,.008)}const Ec=Wo.styled("div",{})(({theme:e,justifyContent:t,padding:r,border:n,width:s,alignItems:i,backgroundColor:l})=>({width:s??"100%",alignItems:i,backgroundColor:l,padding:r,border:n,justifyContent:t,display:"flex",position:"relative",height:"100%",borderRadius:"4px",overflow:"hidden",contain:"content",transition:"border-color 400ms ease-in-out, background-color 600ms ease"})),mc=Wo.styled("div",{})(({theme:e,justifyContent:t,scrollable:r,faded:n,fullHeight:s})=>({display:"flex",width:"100%",flexDirection:"column",height:s?"100%":void 0,justifyContent:t,overflow:r?"auto":void 0,WebkitMaskImage:n?"linear-gradient(to bottom, black 60%, transparent 100%)":void 0,maskImage:n?"linear-gradient(to bottom, black 60%, transparent 100%)":void 0,alignItems:n||r?"start":void 0})),Fr=d.memo(function({children:t,focused:r,size:n,selected:s,disabled:i,disabledTooltip:l,saved:a,selectedRow:A,error:u,align:f,allowScroll:h,openPopup:b,removePadding:v,fullHeight:g,onSelect:p,width:w,showExpandIcon:C=!0}){const[x,B]=Ft(),E=c.useTheme(),m=d.createRef(),[k,S]=d.useState(!1),F=d.useMemo(()=>po(n),[n]),[I,T]=d.useState(!1),[P,M]=d.useState(a),L=!i&&u,W=d.createRef();d.useEffect(()=>{W.current&&r&&W.current.focus({preventScroll:!0})},[r]),d.useEffect(()=>{a&&M(!0);const N=setTimeout(()=>{M(!1)},500);return()=>{clearTimeout(N)}},[a]);let $=E.spacing(0);if(!v)switch(n){case"l":case"xl":$=E.spacing(2);break;case"m":$=E.spacing(1);break;case"s":$=E.spacing(.5);break;default:$=E.spacing(.25);break}let Z;switch(f){case"right":Z="flex-end";break;case"center":Z="center";break;case"left":default:Z="flex-start"}const z=d.useCallback(()=>{if(b){const N=m&&m?.current?.getBoundingClientRect();b(N)}},[m]),J=d.useCallback(N=>{N.detail===3&&z()},[z]),O=d.useCallback(()=>{if(!p)return;const N=m&&m?.current?.getBoundingClientRect();i?p(void 0):!s&&N&&p(N)},[m,p,s,i]),D=d.useCallback(N=>{O(),N.stopPropagation()},[O]);d.useEffect(()=>{if(B){const N=B.height>F;k!==N&&S(N)}},[B,k,F]);const Q=!L&&s;let j;P?j=`2px solid ${E.palette.success.light}`:Q?j="2px solid #5E9ED6":L?j=`2px solid ${E.palette.error.light} !important`:j="2px solid transparent";const V=!i&&h&&k,re=!i&&!h&&k,G=d.useCallback(()=>T(!0),[]),_=d.useCallback(()=>T(!1),[]);return o.jsxs(Ec,{tabIndex:s||i?void 0:0,ref:m,onFocus:D,onClick:J,onMouseEnter:G,onMouseMove:G,onMouseLeave:_,padding:$,contain:V?"content":"size",border:j,justifyContent:Z,width:w,alignItems:i||!k?"center":void 0,backgroundColor:Bc(I,A,i,P??!1,E,Q??!1),children:[o.jsxs(ne,{children:[g&&!re&&t,(!g||re)&&o.jsx(mc,{fullHeight:g??!1,justifyContent:Z,scrollable:V??!1,faded:re,children:!g&&o.jsx("div",{ref:x,style:{display:"flex",width:"100%",justifyContent:Z,height:g?"100%":void 0},children:t})})]}),i&&I&&l&&o.jsx(c.Box,{sx:{position:"absolute",top:4,right:4,fontSize:"14px"},children:o.jsx(c.Tooltip,{title:l,children:o.jsx(Fl,{color:"disabled",fontSize:"inherit"})})}),(L||C)&&o.jsxs(c.Box,{sx:{position:"absolute",top:"2px",right:"2px"},children:[s&&!i&&C&&o.jsx(c.IconButton,{ref:W,color:"inherit",size:"small",onClick:z,children:o.jsxs("svg",{className:"MuiSvgIcon-root MuiSvgIcon-fontSizeSmall",fill:"#888",width:"20",height:"20",viewBox:"0 0 24 24",children:[o.jsx("path",{className:"cls-2",d:"M20,5a1,1,0,0,0-1-1L14,4h0a1,1,0,0,0,0,2h2.57L13.29,9.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L18,7.42V10a1,1,0,0,0,1,1h0a1,1,0,0,0,1-1Z"}),o.jsx("path",{className:"cls-2",d:"M10.71,13.29a1,1,0,0,0-1.42,0L6,16.57V14a1,1,0,0,0-1-1H5a1,1,0,0,0-1,1l0,5a1,1,0,0,0,1,1h5a1,1,0,0,0,0-2H7.42l3.29-3.29A1,1,0,0,0,10.71,13.29Z"})]})}),L&&o.jsx(In,{arrow:!0,placement:"left",title:L.message,children:o.jsx(Sl,{fontSize:"inherit",color:"error"})})]})]})},le);function kc(e){return e.dataType==="string"&&e.storage?!0:e.dataType==="array"?Array.isArray(e.of)?!1:e.of?.dataType==="string"&&e.of?.storage:!1}const Sc=d.memo(function({propertyKey:t,columnIndex:r,customFieldValidator:n,value:s,property:i,align:l,width:a,height:A,collection:u,path:f,entity:h,readonly:b}){const v=Se(),g=oe(),{onValueChange:p,size:w,selectedCell:C,focused:x,select:B,setPopupCell:E,selectedEntityIds:m}=Rc(),k=m?.includes(h.id)??!1,S=C?.columnIndex===r&&C?.entity.id===h.id,[F,I]=d.useState(s),T=d.useRef(s),[P,M]=d.useState(),[L,W]=d.useState(!1),$=d.useCallback(()=>{W(!0),setTimeout(()=>{W(!1)},100)},[]),Z=!!i.Field,z=!!i.Preview,J=uo(i),O=typeof i.disabled=="object"?i.disabled.disabledMessage:void 0,D=!!i.disabled,Q=d.useMemo(()=>Mo({property:i,entityId:h.id,customFieldValidator:n,name:t}),[h.id,i,t]);d.useEffect(()=>{le(s,T.current)||(I(s),T.current=s,$())},[$,s]);const j=d.useCallback(ee=>{W(!1),Q.validate(ee).then(()=>{M(void 0),p&&p({value:ee,propertyKey:t,setError:M,onValueUpdated:$,entity:h,fullPath:f,collection:u,dataSource:v,context:g})}).catch(H=>{M(H)})},[h,p,t,Q]);d.useEffect(()=>{Q.validate(F).catch(ee=>{M(ee)})},[F,Q]);const V=d.useCallback(ee=>{let H;ee===void 0?H=null:H=ee,T.current=H,I(H),j(H)},[j]);ke({property:i,value:F,setValue:V});const re=d.useCallback(ee=>{B(ee?{columnIndex:r,width:a,height:A,entity:h,cellRect:ee,propertyKey:t,collection:u}:void 0)},[u,r,h,A,t,B,a]),G=d.useCallback(ee=>{E(ee?{columnIndex:r,width:a,height:A,entity:h,cellRect:ee,propertyKey:t,collection:u}:void 0)},[u,r,h,A,t,a]);let _,N=!1,R=!1,Y=!1,te=!1;if(b||J)return o.jsx(Fr,{size:w,width:a,focused:x,saved:L,selectedRow:k,value:F,align:l??"left",disabledTooltip:O??(J?"Read only":void 0),disabled:!0,children:o.jsx(xe,{width:a,height:po(w),propertyKey:t,property:i,entity:h,value:s,size:Ze(w)})},`preview_cell_${t}_${h.id}`);if(!Z&&(!z||S)){if(kc(i))_=o.jsx(wc,{error:P,disabled:D,focused:x,property:i,entity:h,path:f,value:F,previewSize:Ze(w),updateValue:V,propertyKey:t}),R=!0,te=!0,Y=!0;else if(S&&i.dataType==="number"){const H=i;H.enumValues?(_=o.jsx(Sr,{name:t,multiple:!1,disabled:D,focused:x,valueType:"number",small:Ze(w)!=="regular",enumValues:H.enumValues,error:P,internalValue:F,updateValue:V}),te=!0):(_=o.jsx(fc,{align:l,error:P,focused:x,disabled:D,value:F,updateValue:V}),N=!0)}else if(S&&i.dataType==="string"){const H=i;if(H.enumValues)_=o.jsx(Sr,{name:t,multiple:!1,focused:x,disabled:D,valueType:"string",small:Ze(w)!=="regular",enumValues:H.enumValues,error:P,internalValue:F,updateValue:V}),te=!0;else if(!H.storage){const Ye=!!H.multiline||!!H.markdown;_=o.jsx(uc,{error:P,disabled:D,multiline:Ye,focused:x,value:F,updateValue:V}),N=!0}}else if(i.dataType==="boolean")_=o.jsx(gc,{error:P,disabled:D,focused:x&&S,internalValue:F,updateValue:V});else if(i.dataType==="date")_=o.jsx(hc,{name:t,error:P,disabled:D,mode:i.mode,focused:x,internalValue:F,updateValue:V}),N=!0;else if(i.dataType==="reference")typeof i.path=="string"&&(_=o.jsx(Ii,{name:t,internalValue:F,updateValue:V,disabled:D,size:w,path:i.path,multiselect:!1,previewProperties:i.previewProperties,title:i.name,forceFilter:i.forceFilter})),N=!1;else if(i.dataType==="array"){const H=i;if(!H.of&&!H.oneOf)throw Error(`You need to specify an 'of' or 'oneOf' prop (or specify a custom field) in your array property ${t}`);H.of&&!Array.isArray(H.of)&&(H.of.dataType==="string"||H.of.dataType==="number"?S&&H.of.enumValues&&(_=o.jsx(Sr,{name:t,multiple:!0,disabled:D,focused:x,small:Ze(w)!=="regular",valueType:H.of.dataType,enumValues:H.of.enumValues,error:P,internalValue:F,updateValue:V}),N=!0,te=!0):H.of.dataType==="reference"&&(typeof H.of.path=="string"&&(_=o.jsx(Ii,{name:t,disabled:D,internalValue:F,updateValue:V,size:w,multiselect:!0,path:H.of.path,previewProperties:H.of.previewProperties,title:H.of.name,forceFilter:H.of.forceFilter})),N=!1))}}return _||(N=!1,R=S&&!_&&!D&&!J,_=o.jsx(xe,{width:a,height:A,entity:h,propertyKey:t,value:F,property:i,size:Ze(w)})),o.jsx(Fr,{size:w,width:a,focused:x,onSelect:re,selected:S,selectedRow:k,disabled:D||J,disabledTooltip:O??"Disabled",removePadding:Y,fullHeight:te,saved:L,error:P,align:l,allowScroll:N,showExpandIcon:R,openPopup:D?void 0:G,value:F,children:_},`table_cell_${h.id}_${t}`)},Fc);function Fc(e,t){return e.height===t.height&&e.propertyKey===t.propertyKey&&e.align===t.align&&e.width===t.width&&le(e.property,t.property)&&le(e.value,t.value)&&le(e.entity.values,t.entity.values)}function Ic({containerRef:e,innerRef:t,x:r,y:n,onMove:s}){let i=0,l=0;const a=d.useRef(!1),A=g=>{if(g.button!==0||!e.current||g.defaultPrevented||g.innerClicked)return;const{x:p,y:w}=e.current.getBoundingClientRect();i=g.screenX-p,l=g.screenY-w,document.addEventListener("mousemove",b),document.addEventListener("mouseup",h),document.addEventListener("selectstart",f),a.current=!0},u=g=>{g.innerClicked=!0},f=g=>{g.preventDefault(),g.stopPropagation()},h=g=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",h),document.removeEventListener("selectstart",f),g.stopPropagation(),a.current=!1},b=g=>{g.target.localName==="input"||!a.current||(s(g.screenX-i,g.screenY-l),g.stopPropagation())},v=()=>{e.current&&(e.current.style.top=`${n}px`,e.current.style.left=`${r}px`)};d.useEffect(()=>{const g=e.current,p=t.current;if(!(!g||!p))return p&&p.addEventListener("mousedown",u),g&&g.addEventListener("mousedown",A),v(),()=>{g&&g.removeEventListener("mousedown",A),p&&p.removeEventListener("mousedown",u)}})}function Tc(){const[e,t]=d.useState({width:0,height:0});return d.useLayoutEffect(()=>{function r(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)},[]),e}const Dc=({onResize:e})=>{const t=d.useRef(0),r=d.useRef(null),n=d.useRef(e);n.current=e;const s=d.useCallback(l=>{t.current&&cancelAnimationFrame(t.current),t.current=requestAnimationFrame(()=>{n.current(l)})},[]),i=d.useCallback(()=>{const l=r.current;l&&l.contentDocument&&l.contentDocument.defaultView&&l.contentDocument.defaultView.addEventListener("resize",s)},[s]);return d.useEffect(()=>{const l=r.current;return()=>{l&&l.contentDocument&&l.contentDocument.defaultView&&l.contentDocument.defaultView.removeEventListener("resize",s)}},[s]),o.jsx("object",{onLoad:i,ref:r,tabIndex:-1,type:"text/html",data:"about:blank",title:"",style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",pointerEvents:"none",zIndex:-1,opacity:0}})};function je({children:e,position:t="sticky",maxWidth:r,translucent:n=!0}){const s=r?o.jsx(c.Container,{maxWidth:r,children:e}):e;return o.jsx(c.Box,{sx:i=>({background:n?i.palette.mode==="light"?"rgba(255,255,255,0.6)":c.alpha(i.palette.background.paper,.1):void 0,backdropFilter:n?"blur(8px)":void 0,borderTop:`1px solid ${i.palette.divider}`,py:1,px:2,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",position:t,bottom:0,right:0,left:0,textAlign:"right",zIndex:2,"& > *:not(:last-child)":{[i.breakpoints.down("md")]:{mr:i.spacing(1)},mr:i.spacing(2)}}),children:s})}function Pc(e){return e.open?o.jsx(Mc,{...e}):null}function Mc({tableKey:e,entity:t,customFieldValidator:r,propertyKey:n,collection:s,path:i,cellRect:l,open:a,onClose:A,columnIndex:u,onCellValueChange:f}){const h=Se(),b=oe(),[v,g]=d.useState(),[p,w]=d.useState(),[C,x]=d.useState(t?.values),B=s?pe({collection:s,path:i,values:C,entityId:t?.id,fields:b.fields}):void 0,E=Tc(),m=d.useRef(null),k=d.useRef(null),S=d.useRef(!1);Ic({containerRef:m,innerRef:k,x:p?.x,y:p?.y,onMove:(z,J)=>L({x:z,y:J})}),d.useEffect(()=>{S.current=!1},[n,t]);const F=d.useCallback(()=>{if(!l)throw Error("getInitialLocation error");return{x:l.left<E.width-l.right?l.x+l.width/2:l.x-l.width/2,y:l.top<E.height-l.bottom?l.y+l.height/2:l.y-l.height/2}},[l,E.height,E.width]),I=d.useCallback(({x:z,y:J})=>{const O=m.current?.getBoundingClientRect();if(!O)throw Error("normalizePosition called before draggableBoundingRect is set");return{x:Math.max(0,Math.min(z,E.width-O.width)),y:Math.max(0,Math.min(J,E.height-O.height))}},[E]),T=d.useCallback(z=>{const J=m.current?.getBoundingClientRect();if(!l||!J)return;const O=I(z??F());(!p||O.x!==p.x||O.y!==p.y)&&w(O)},[l,F,I,p]);d.useEffect(()=>{S.current=!1},[n]),d.useLayoutEffect(()=>{const z=m.current?.getBoundingClientRect();!l||!z||S.current||(T(),S.current=!0)},[l,T,S.current]),d.useLayoutEffect(()=>{T(p)},[E,l]);const P=d.useMemo(()=>{if(!(!B||!t))return vi(t.id,n&&B.properties[n]?{[n]:B.properties[n]}:{},r)},[i,n,B,t]),M=d.useCallback(()=>T(p),[p,T]),L=d.useCallback(z=>T(z),[T]),W=async z=>(g(null),s&&t&&f&&n?f({value:z[n],propertyKey:n,entity:t,setError:g,onValueUpdated:()=>{},fullPath:i,collection:s,dataSource:h,context:b}):Promise.resolve());if(!t)return o.jsx(o.Fragment,{});const $=t&&o.jsxs(c.Box,{sx:z=>({overflow:"auto",borderRadius:`${z.shape.borderRadius}px`,backgroundColor:z.palette.background.paper,visibility:a?void 0:"hidden",cursor:"grab"}),children:[o.jsx(we.Formik,{initialValues:t?.values??{},validationSchema:P,validateOnMount:!0,validate:z=>console.debug("Validating",z),onSubmit:(z,J)=>{W(z).then(()=>A()).finally(()=>J.setSubmitting(!1))},children:({handleChange:z,values:J,errors:O,touched:D,dirty:Q,setFieldValue:j,setFieldTouched:V,handleSubmit:re,isSubmitting:G})=>{if(le(J,C)||x(J),!t)return o.jsx(ue,{error:"PopupFormField misconfiguration"});if(!B)return o.jsx(o.Fragment,{});const _=G,N={collection:B,entityId:t.id,values:J,path:i,setFieldValue:j},R=n&&B.properties[n],Y=n&&R?{propertyKey:n,disabled:G||uo(R)||!!R.disabled,property:R,includeDescription:!1,underlyingValueHasChanged:!1,context:N,tableMode:!0,partOfArray:!1,autoFocus:a}:void 0;let te=o.jsx(o.Fragment,{children:o.jsx(c.Box,{sx:{width:520,maxWidth:"100vw",maxHeight:"85vh"},children:o.jsxs(we.Form,{onSubmit:re,noValidate:!0,children:[o.jsx(c.Box,{sx:{mb:1,padding:2,display:"flex",flexDirection:"column",position:"relative"},children:o.jsx(c.Box,{ref:k,sx:{cursor:"auto !important"},children:Y&&o.jsx(oo,{...Y})})}),o.jsx(je,{children:o.jsx(c.Button,{variant:"contained",color:"primary",type:"submit",disabled:_,children:"Save"})})]})},`popup_form_${e}_${t.id}_${u}`)});const ee=b.plugins;return ee&&ee.forEach(H=>{H.form?.provider&&(te=o.jsx(H.form.provider.Component,{status:"existing",path:i,collection:B,entity:t,context:b,currentEntityId:t.id,formContext:N,...H.form.provider.props,children:te}))}),te}}),v&&o.jsx(c.Typography,{color:"error",children:v.message})]}),Z=o.jsxs(c.Box,{sx:z=>({display:"inline-block",position:"fixed",zIndex:1300,boxShadow:"0 0 0 2px rgba(128,128,128,0.2)",backgroundColor:z.palette.background.paper,borderRadius:`${z.shape.borderRadius}px`,visibility:a?void 0:"hidden",cursor:"grab"}),ref:m,children:[o.jsx(Dc,{onResize:M}),o.jsxs(c.Box,{sx:{overflow:"hidden"},children:[$,o.jsx(c.Box,{sx:{position:"absolute",top:-14,right:-14,backgroundColor:"#888",borderRadius:"32px"},children:o.jsx(c.IconButton,{size:"small",onClick:z=>{z.stopPropagation(),A()},children:o.jsx(Pe,{sx:{color:"white"},fontSize:"small"})})})]})]},`draggable_${n}_${t.id}_${a}`);return o.jsx(c.Portal,{container:document.body,children:Z})}function ro(e){return o.jsx(c.Box,{sx:{display:"flex",width:"100vw",maxHeight:"100%",maxWidth:"100%",height:"100vh","@supports (height: 100dvh)":{height:"100dvh"}},children:o.jsx(c.Box,{m:"auto",children:o.jsx(c.CircularProgress,{...e})})})}const Qc=d.memo(function({resizeHandleRef:t,columnIndex:r,isResizingIndex:n,sort:s,onColumnSort:i,onFilterUpdate:l,filter:a,column:A,onClickResizeColumn:u,createFilterField:f}){const h=d.useRef(null),[b,v]=d.useState(!1),[g,p]=d.useState(!1),w=d.useCallback(m=>{p(!0)},[]);d.useCallback(()=>{p(!1)},[]);const C=d.useCallback((m,k)=>{l(A,m),k!==void 0&&p(k)},[A,l]),x=n===r,E=!(n!==r&&n>0)&&(b||x);return o.jsxs(ne,{children:[o.jsxs(c.Grid,{sx:m=>({width:A.width,padding:"0px 12px",color:E?m.palette.text.primary:m.palette.text.secondary,backgroundColor:E?c.darken(m.palette.background.default,.05):m.palette.background.default,transition:"color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",height:"100%",fontSize:"0.750rem",textTransform:"uppercase",fontWeight:600,position:A.frozen?"sticky":"relative",left:A.frozen?0:void 0,zIndex:A.frozen?1:0,userSelect:"none"}),ref:h,wrap:"nowrap",alignItems:"center",onMouseEnter:()=>v(!0),onMouseMove:()=>v(!0),onMouseLeave:()=>v(!1),container:!0,children:[o.jsx(c.Grid,{item:!0,xs:!0,sx:{overflow:"hidden",flexShrink:1},children:o.jsxs(c.Box,{sx:{display:"flex",justifyContent:A.headerAlign,alignItems:"center",flexDirection:"row"},children:[o.jsx(c.Box,{sx:{paddingTop:"4px"},children:A.icon&&A.icon(b||g)}),o.jsx(c.Box,{sx:{display:"-webkit-box",margin:"0px 4px",overflow:"hidden",justifyContent:A.align,WebkitLineClamp:2,WebkitBoxOrient:"vertical",textOverflow:"ellipsis"},children:A.title})]})}),A.sortable&&(s||E||g)&&o.jsx(c.Grid,{item:!0,children:o.jsx(c.Badge,{color:"secondary",variant:"dot",overlap:"circular",invisible:!s,children:o.jsxs(c.IconButton,{size:"small",sx:m=>({backgroundColor:m.palette.mode==="light"?"#f5f5f5":m.palette.background.default}),onClick:()=>{i(A.key)},children:[!s&&o.jsx(ln,{fontSize:"small"}),s==="asc"&&o.jsx(ln,{fontSize:"small"}),s==="desc"&&o.jsx(rl,{fontSize:"small"})]})})}),A.filter&&o.jsx(c.Grid,{item:!0,children:o.jsx(c.Badge,{color:"secondary",variant:"dot",overlap:"circular",invisible:!a,children:o.jsx(c.IconButton,{sx:m=>({backgroundColor:m.palette.mode==="light"?"#f5f5f5":m.palette.background.default}),size:"small",onClick:w,children:o.jsx(nl,{fontSize:"small",color:b||g?void 0:"disabled"})})})}),A.resizable&&o.jsx(c.Box,{ref:t,sx:m=>({position:"absolute",height:"100%",width:"4px",top:0,right:0,cursor:"col-resize",backgroundColor:E?m.palette.mode==="dark"?c.lighten(m.palette.background.default,.1):c.darken(m.palette.background.default,.15):void 0}),onMouseDown:u?()=>u(r,A):void 0})]}),A.filter&&f&&o.jsx(Lc,{column:A,filter:a,onHover:b,onFilterUpdate:C,createFilterField:f,popupOpen:g,setPopupOpen:p,anchorEl:h})]})},le);function Lc({column:e,onFilterUpdate:t,filter:r,onHover:n,createFilterField:s,popupOpen:i,setPopupOpen:l,anchorEl:a}){const A=e.key,[u,f]=d.useState(r);if(d.useEffect(()=>{f(r)},[r]),!e.filter)return null;const h=()=>{t(u,!1)},b=p=>{t(void 0,!1)},v=!!r,g=s({id:A,filterValue:u,setFilterValue:f,column:e,popupOpen:i,setPopupOpen:l});return g?o.jsx(c.Popover,{id:`popover_${e.key}`,open:i,elevation:3,anchorEl:a.current,onClose:()=>l(!1),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:o.jsxs(c.Box,{sx:p=>({}),children:[o.jsx(c.Box,{sx:p=>({p:2,fontSize:"0.750rem",fontWeight:600,textTransform:"uppercase"}),children:e.title??A}),o.jsx(c.Divider,{}),g&&o.jsx(c.Box,{p:2,children:g}),o.jsxs(c.Box,{display:"flex",justifyContent:"flex-end",m:2,children:[o.jsx(c.Box,{mr:1,children:o.jsx(c.Button,{disabled:!v,color:"primary",type:"reset","aria-label":"filter clear",onClick:b,children:"Clear"})}),o.jsx(c.Button,{variant:"outlined",color:"primary",onClick:h,children:"Filter"})]})]})}):null}const Oc=({columns:e,currentSort:t,onColumnSort:r,onFilterUpdate:n,sortByProperty:s,filter:i,onColumnResize:l,onColumnResizeEnd:a,createFilterField:A})=>{const u=e.map(()=>d.createRef()),[f,h]=d.useState(-1),b=d.useCallback((E,m,k)=>{const S=e[E],F=100,I=800,T=m>I?I:m<F?F:m,P={width:T,key:S.key,column:{...S,width:T}};k?a(P):l(P)},[e,l,a]),v=d.useCallback(E=>{if(f>=0){const m=u[f].current?.parentElement?.getBoundingClientRect().left;return m?E.clientX-m:void 0}},[u,f]),g=d.useCallback(E=>{document.body.style.cursor=E?"col-resize":"auto"},[]),p=d.useCallback(E=>{E.stopPropagation(),E.preventDefault();const m=v(E);m&&b(f,m,!1)},[b,v,f]),w=d.useCallback(E=>{E.stopPropagation(),E.preventDefault();const m=v(E);m&&b(f,m,!0),h(-1),g(!1)},[b,v,f,g]),C=d.useCallback(()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",w)},[p,w]),x=d.useCallback(()=>{document.addEventListener("mousemove",p),document.addEventListener("mouseup",w)},[p,w]);d.useEffect(()=>(f>=0?x():C(),()=>{C()}),[x,f,C]);const B=d.useCallback(E=>{h(E),g(!0)},[g]);return o.jsx(c.Box,{sx:E=>({position:"sticky",minWidth:"100%",backgroundColor:E.palette.background.default,display:"flex",width:"fit-content",flexDirection:"row",top:0,left:0,zIndex:2,height:50,borderBottom:`1px solid ${E.palette.divider}`}),children:e.map((E,m)=>{const k=e[m],S=k&&i&&i[k.key]?i[k.key]:void 0;return o.jsx(ne,{children:o.jsx(Qc,{resizeHandleRef:u[m],columnIndex:m,isResizingIndex:f,onFilterUpdate:n,filter:S,sort:s===k.key?t:void 0,onColumnSort:r,onClickResizeColumn:B,column:k,createFilterField:A})},"header_"+k.key)})})},Gc=c.styled("div",{})(({theme:e,size:t,cursor:r,hovered:n})=>({display:"flex",minWidth:"100%",height:po(t),cursor:r,flexDirection:"row",fontSize:"0.875rem",borderBottom:`1px solid ${e.palette.divider}`,backgroundColor:n?e.palette.mode==="dark"?c.lighten(e.palette.background.paper,.01):"rgb(252, 252, 253)":void 0})),$c=d.memo(function({rowData:t,rowIndex:r,children:n,onRowClick:s,size:i,style:l,hoverRow:a}){const[A,u]=d.useState(!1),f=d.useCallback(v=>s?s({rowData:t,rowIndex:r,event:v}):void 0,[s,t,r]),h=d.useCallback(()=>u(!0),[]),b=d.useCallback(()=>u(!1),[]);return o.jsx(Gc,{onClick:f,size:i,cursor:s?"pointer":void 0,hovered:a&&A,style:{...l,width:"fit-content"},onMouseEnter:h,onMouseMove:h,onMouseLeave:b,children:n})},le),Vc=d.memo(function(t){return t.rowData&&t.cellRenderer({cellData:t.cellData,rowData:t.rowData,rowIndex:t.rowIndex,isScrolling:!1,column:t.column,columns:t.columns,columnIndex:t.columnIndex,width:t.column.width})},(e,t)=>le(e,t)),ft=d.createContext({});ft.displayName="VirtualListContext";const Wc=d.forwardRef(({children:e,...t},r)=>o.jsx(ft.Consumer,{children:n=>{const s=n.customView;return o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{position:"relative",height:"100%"},children:o.jsxs("div",{ref:r,...t,style:{...t?.style,minHeight:"100%",position:"relative"},children:[o.jsx(Oc,{...n}),!s&&e]})}),s&&o.jsx("div",{style:{position:"sticky",top:"56px",flexGrow:1,height:"calc(100% - 56px)",marginTop:"calc(56px - 100vh)",left:0},children:s})]})}})),Ti=d.memo(function({data:t,onResetPagination:r,onEndReached:n,size:s="m",columns:i,onRowClick:l,onColumnResize:a,filter:A,checkFilterCombination:u,onFilterUpdate:f,sortBy:h,error:b,emptyMessage:v,onSortByUpdate:g,loading:p,cellRenderer:w,hoverRow:C,createFilterField:x}){const B=h?h[0]:void 0,E=h?h[1]:void 0,[m,k]=d.useState(i),S=d.useRef(null),F=d.useRef(0);d.useEffect(()=>{k(i)},[i]);const[I,T]=Ft(),P=d.useCallback(G=>{k(m.map(_=>_.key===G.column.key?G.column:_))},[m]),M=d.useCallback(G=>{k(m.map(_=>_.key===G.column.key?G.column:_)),a&&a(G)},[m,a]),L=d.useRef();d.useEffect(()=>{L.current=A},[A]);const W=d.useCallback(()=>{F.current=0,S.current&&S.current.scrollTo(S.current?.scrollLeft,0)},[]),$=d.useCallback(G=>{const _=B===G&&E==="desc",R=B===G&&E==="asc"?"desc":_?void 0:"asc",Y=_?void 0:G,te=L.current,ee=R&&Y?[Y,R]:void 0;te&&u&&!u(te,ee)&&f&&f(void 0),r&&r(),g&&g(ee),W()},[u,E,f,r,g,W,B]),Z=d.useCallback(()=>{F.current=0,g&&g(void 0)},[g]),z=Math.max((t?.length??0)*po(s)-T.height,0),J=d.useCallback(G=>{n&&(t?.length??0)>0&&G>F.current+500&&(F.current=G,n())},[t,n]),O=d.useCallback(({scrollOffset:G,scrollUpdateWasRequested:_})=>{!_&&G>=z-500&&J(G)},[z,J]),D=d.useCallback((G,_)=>{F.current=0;const N=L.current;let R=N?{...N}:{};_?R[G.key]=_:delete R[G.key],!u||u(R,B&&E?[B,E]:void 0)||(R=_?{[G.key]:_}:{}),f&&f(R),G.key!==B&&Z()},[u,E,f,Z,B]),Q=d.useCallback(()=>o.jsxs(c.Box,{sx:{height:"calc(100% - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"sticky",left:0},children:[o.jsx(c.Typography,{variant:"h6",children:"Error fetching data from the data source"}),b?.message&&o.jsx(c.Typography,{children:b?.message})]}),[b?.message]),j=d.useCallback(()=>p?o.jsx(ro,{}):o.jsxs(c.Box,{sx:{display:"flex",overflow:"auto",alignItems:"center",justifyContent:"center",p:2,gap:2,height:"100%"},children:[o.jsx(ol,{}),o.jsx(c.Typography,{children:v})]}),[v,p]),V=!p&&(t?.length??0)===0,re=b?Q():V?j():void 0;return o.jsx(c.Box,{ref:I,sx:{height:"100%",width:"100%"},children:o.jsx(ft.Provider,{value:{data:t,size:s,cellRenderer:w,columns:m,currentSort:E,onRowClick:l,customView:re,onColumnResize:P,onColumnResizeEnd:M,filter:L.current,onColumnSort:$,onFilterUpdate:D,sortByProperty:B,hoverRow:C??!1,createFilterField:x},children:o.jsx(Yc,{outerRef:S,width:T.width,height:T.height,itemCount:t?.length??0,onScroll:O,itemSize:po(s)},s)})})},le);function Yc({outerRef:e,width:t,height:r,itemCount:n,onScroll:s,itemSize:i}){const l=d.useCallback(({index:a,style:A})=>o.jsx(ft.Consumer,{children:({onRowClick:u,data:f,columns:h,size:b="m",cellRenderer:v,hoverRow:g})=>{const p=f&&f[a];return o.jsx($c,{rowData:p,rowIndex:a,onRowClick:u,columns:h,hoverRow:g,style:{...A,top:`calc(${A.top}px + 50px)`},size:b,children:h.map((w,C)=>{const x=p&&p[w.key];return o.jsx(Vc,{dataKey:w.key,cellRenderer:v,column:w,columns:h,rowData:p,cellData:x,rowIndex:a,columnIndex:C},`cell_${w.key}`)})},`row_${a}`)}}),[]);return o.jsx(tl.FixedSizeList,{outerRef:e,innerElementType:Wc,width:t,height:r,overscanCount:4,itemCount:n,onScroll:s,itemSize:i,children:l})}function Ir({entity:e,width:t,frozen:r,isSelected:n,selectionEnabled:s,size:i,toggleEntitySelection:l,onCopyClicked:a,onEditClicked:A,onDeleteClicked:u,hideId:f}){const h=c.useTheme(),b=c.useMediaQuery(h.breakpoints.up("md")),v=!!A,g=!!a,p=!!u,[w,C]=d.useState(null),x=d.useCallback(F=>{C(F.currentTarget),F.stopPropagation()},[C]),B=d.useCallback(()=>{C(null)},[C]),E=d.useCallback(F=>{l&&l(e),F.preventDefault(),F.stopPropagation()},[e,l]),m=d.useCallback(F=>{F.stopPropagation(),u&&u(e),C(null)},[e,u,C]),k=d.useCallback(F=>{F.stopPropagation(),a&&a(e),C(null)},[e,a,C]),S=d.useCallback(F=>{F.stopPropagation(),l&&l(e)},[e,l]);return o.jsxs(c.Box,{style:{width:t},onClick:S,sx:F=>({height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",position:r?"sticky":"initial",left:r?0:"initial",background:(F.palette.mode==="dark",c.alpha(F.palette.background.default,.96)),contain:"strict",zIndex:1}),children:[(v||p||s)&&o.jsxs(c.Box,{sx:{minWidth:138,display:"flex",justifyContent:"center"},children:[v&&o.jsx(c.Tooltip,{title:`Edit ${e.id}`,children:o.jsx(c.IconButton,{onClick:F=>{F.stopPropagation(),A&&A(e)},size:b?"medium":"small",children:o.jsx(ye.KeyboardTab,{})})}),s&&o.jsx(c.Tooltip,{title:`Select ${e.id}`,children:o.jsx(c.Checkbox,{size:b?"medium":"small",checked:n,onChange:E})}),(g||p)&&o.jsx(c.IconButton,{onClick:x,size:b?"medium":"small",children:o.jsx(ye.MoreVert,{})}),(g||p)&&o.jsxs(c.Menu,{anchorEl:w,open:!!w,onClose:B,elevation:3,children:[p&&o.jsxs(c.MenuItem,{onClick:m,children:[o.jsx(c.ListItemIcon,{children:o.jsx(ye.Delete,{})}),o.jsx(c.ListItemText,{primary:"Delete"})]}),g&&o.jsxs(c.MenuItem,{onClick:k,children:[o.jsx(c.ListItemIcon,{children:o.jsx(ye.FileCopy,{})}),o.jsx(c.ListItemText,{primary:"Copy"})]})]})]}),!f&&i!=="xs"&&o.jsx(c.Box,{sx:{width:138,textAlign:"center",textOverflow:"ellipsis",overflow:"hidden"},children:e?o.jsxs(c.Typography,{className:"mono",variant:"caption",color:"textSecondary",children:[" ",e.id," "]}):o.jsx(c.Skeleton,{variant:"text"})})]})}function Di({onTextSearch:e,placeholder:t="Search",expandable:r=!1,large:n=!1}){const[s,i]=d.useState(""),[l,a]=d.useState(!1),A=d.useDeferredValue(s);d.useEffect(()=>{e(A||void 0)},[A]);const u=d.useCallback(()=>{i(""),e(void 0)},[]);return o.jsxs(c.Box,{sx:f=>({position:"relative",display:"flex",alignItems:"center",height:n?56:40,width:r?void 0:"100%",minWidth:"200px",borderRadius:`${f.shape.borderRadius}px`,backgroundColor:f.palette.mode==="light"?ge.darken(f.palette.background.default,.05):ge.darken(f.palette.background.default,.2),"&:hover":{backgroundColor:f.palette.mode==="light"?ge.darken(f.palette.background.default,.08):ge.darken(f.palette.background.default,.3)},[f.breakpoints.up("sm")]:{width:"auto"}}),children:[o.jsx(c.Box,{sx:f=>({padding:f.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}),children:o.jsx(yl,{htmlColor:"#888"})}),o.jsx(an,{placeholder:t,value:s,onChange:f=>{i(f.target.value)},onFocus:()=>a(!0),onBlur:()=>a(!1),sx:{width:r?void 0:"100%",color:"inherit",minHeight:"inherit"},inputProps:{sx:f=>({padding:f.spacing(1,1,1,0),paddingLeft:`calc(1em + ${f.spacing(4)})`,transition:f.transitions.create("width"),width:"100%",[f.breakpoints.up("sm")]:{width:r?l?"20ch":"12ch":"100%"}}),"aria-label":t},endAdornment:s?o.jsx(c.IconButton,{sx:{mr:n?2:1},size:"small",onClick:u,children:o.jsx(Pe,{fontSize:"small"})}):o.jsx("div",{style:{width:26}})})]})}const zc=ge.styled(an)(({theme:e})=>({"label + &":{},"& .MuiInputBase-input":{borderRadius:4,position:"relative",backgroundColor:e.palette.mode==="light"?ge.alpha(e.palette.common.black,.05):ge.darken(e.palette.background.default,.2),fontSize:14,fontWeight:e.typography.fontWeightMedium,padding:"8px 26px 8px 12px",transition:e.transitions.create(["border-color","box-shadow"]),"&:focus":{borderRadius:4}}}));function Pi(e){return o.jsx(cl,{input:o.jsx(zc,{}),renderValue:t=>t.toUpperCase(),...e,MenuProps:{MenuListProps:{disablePadding:!0,style:{borderRadius:4}},elevation:1},children:e.children})}function Mi(e){return o.jsx(dl,{...e,sx:t=>({backgroundColor:t.palette.background.default,fontSize:14,fontWeight:t.typography.fontWeightMedium,paddingTop:t.spacing(1),paddingBottom:t.spacing(1),"&:hover":{backgroundColor:ge.darken(t.palette.background.default,.1)},"&:focus":{backgroundColor:ge.darken(t.palette.background.default,.2),"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:t.palette.text.primary}}}),children:e.children})}function Uc(e){const t=c.useTheme(),r=c.useMediaQuery(t.breakpoints.up("md")),n=!e.forceFilter&&e.filterIsSet&&o.jsx(c.Tooltip,{title:"Clear filter",children:o.jsx(c.IconButton,{sx:{height:"fit-content"},"aria-label":"filter clear",onClick:e.clearFilter,size:"medium",children:o.jsx(Il,{})})}),s=o.jsx(Pi,{variant:"standard",value:e.size,sx:{width:56,height:40},onChange:i=>e.onSizeChanged(i.target.value),renderValue:i=>i.toUpperCase(),children:["xs","s","m","l","xl"].map(i=>o.jsx(Mi,{value:i,children:i.toUpperCase()},`size-select-${i}`))});return o.jsxs(c.Box,{sx:{minHeight:56,overflowX:"auto",[t.breakpoints.down("sm")]:{px:t.spacing(1)},px:t.spacing(2),backgroundColor:t.palette.background.default,borderBottom:`1px solid ${t.palette.divider}`,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[o.jsxs(c.Box,{display:"flex",alignItems:"center",sx:{"& > *":{[t.breakpoints.down("md")]:{marginRight:`${t.spacing(1)} !important`},marginRight:`${t.spacing(2)} !important`}},children:[e.title&&o.jsx(c.Hidden,{lgDown:!0,children:e.title}),s,e.actionsStart,n]}),o.jsxs(c.Box,{sx:{display:"flex",alignItems:"center","& > *":{[t.breakpoints.down("md")]:{marginRight:`${t.spacing(.5)} !important`},marginRight:`${t.spacing(1)} !important`}},children:[r&&o.jsx(c.Box,{width:22,children:e.loading&&o.jsx(c.CircularProgress,{size:16,thickness:8})}),e.onTextSearch&&o.jsx(Di,{onTextSearch:e.onTextSearch,expandable:!0},"search-bar"),e.actions]})]})}const Nc={"==":"==","!=":"!=",">":">","<":"<",">=":">=","<=":"<=",in:"In","not-in":"Not in","array-contains":"Contains","array-contains-any":"Contains Any"},Tr=["array-contains-any","in","not-in"];function Hc({name:e,value:t,setValue:r,isArray:n,path:s,title:i,previewProperties:l,setPopupOpen:a}){const A=n?["array-contains"]:["==","!=",">","<",">=","<="],[u,f]=d.useState(!1);n?A.push("array-contains-any"):A.push("in","not-in");const[h,b]=t||[A[0],void 0],[v,g]=d.useState(h),[p,w]=d.useState(b),C=p?Array.isArray(p)?p.map(P=>P.id):[p.id]:[];function x(P,M){const L=Tr.includes(v),W=Tr.includes(P);let $=M;L!==W&&($=W?$ instanceof Me?[$]:[]:void 0),g(P),w($);const Z=$!==null&&Array.isArray($)?$.length>0:$!==void 0;r(P&&Z?[P,$]:void 0)}const B=he(),E=d.useMemo(()=>s?B.getCollection(s):void 0,[s]),m=P=>{x(v,Re(P))},k=P=>{x(v,P.map(M=>Re(M)))},S=Tr.includes(v),F=So({multiselect:S,path:s,collection:E,onSingleEntitySelected:m,onMultipleEntitiesSelected:k,selectedEntityIds:C,onClose:()=>{a(!0)}}),I=()=>{a(!1),F.open()},T=P=>o.jsx(c.Box,{sx:{mb:.5},onMouseEnter:()=>f(!0),onMouseMove:()=>f(!0),onMouseLeave:()=>f(!1),children:o.jsx(Ke,{disabled:!s,previewProperties:l,size:"regular",onClick:I,reference:P,onHover:u,allowEntityNavigation:!1})});return o.jsxs(c.Box,{display:"flex",width:440,flexDirection:"row",children:[o.jsx(c.Box,{width:120,children:o.jsx(c.FormControl,{fullWidth:!0,children:o.jsx(c.Select,{value:v,fullWidth:!0,onChange:P=>{x(P.target.value,p)},children:A.map(P=>o.jsx(c.MenuItem,{value:P,children:Nc[P]},`filter_op_${e}_${P}`))})})}),o.jsx(c.Box,{flexGrow:1,ml:1,children:o.jsxs(c.FormControl,{fullWidth:!0,sx:{height:"100%"},children:[p&&Array.isArray(p)&&o.jsx(c.Box,{children:p.map((P,M)=>T(P))}),p&&!Array.isArray(p)&&o.jsx(c.Box,{children:T(p)}),(!p||Array.isArray(p)&&p.length===0)&&o.jsx(c.Button,{onClick:I,sx:{height:"100%"},children:S?"Select references":"Select reference"})]})})]})}const _c={"==":"==","!=":"!=",">":">","<":"<",">=":">=","<=":"<=",in:"In","not-in":"Not in","array-contains":"Contains","array-contains-any":"Any"},Dr=["array-contains-any","in","not-in"];function jc({name:e,value:t,setValue:r,dataType:n,isArray:s,enumValues:i,title:l}){const a=s?["array-contains"]:["==","!=",">","<",">=","<="];i&&(s?a.push("array-contains-any"):a.push("in","not-in"));const[A,u]=t||[a[0],void 0],[f,h]=d.useState(A),[b,v]=d.useState(u);function g(w,C){let x=C;const B=Dr.includes(f),E=Dr.includes(w);B!==E&&(x=E?typeof C=="string"||typeof C=="number"?[C]:[]:""),typeof x=="number"&&isNaN(x)&&(x=void 0),h(w),v(x);const m=x!==null&&Array.isArray(x)?x.length>0:x!==void 0;r(w&&m?[w,x]:void 0)}const p=Dr.includes(f);return o.jsxs(c.Box,{display:"flex",width:440,alignItems:"center",children:[o.jsx(c.Box,{width:80,children:o.jsx(c.FormControl,{fullWidth:!0,children:o.jsx(c.Select,{value:f,fullWidth:!0,onChange:w=>{g(w.target.value,b)},children:a.map(w=>o.jsx(c.MenuItem,{value:w,children:_c[w]},`filter_op_${e}_${w}`))})})}),o.jsx(c.Box,{flexGrow:1,ml:1,children:o.jsxs(c.FormControl,{fullWidth:!0,children:[!i&&o.jsx(c.OutlinedInput,{fullWidth:!0,type:n==="number"?"number":void 0,value:b!==void 0?b:"",onChange:w=>{const C=n==="number"?parseFloat(w.target.value):w.target.value;g(f,C)},endAdornment:b&&o.jsx(c.IconButton,{sx:{position:"absolute",right:"12px",top:"8px"},onClick:w=>g(f,void 0),children:o.jsx(Pe,{})})},`filter_${e}`),i&&o.jsx(c.Select,{fullWidth:!0,multiple:p,value:b!==void 0?b:s?[]:"",onChange:w=>g(f,n==="number"?parseInt(w.target.value):w.target.value),endAdornment:b&&o.jsx(c.IconButton,{sx:{position:"absolute",right:"12px",top:"8px"},onClick:w=>g(f,void 0),children:o.jsx(Pe,{})}),renderValue:p?w=>o.jsx("div",{children:w.map(C=>o.jsx(Fe,{enumKey:C,enumValues:i,small:!0},`select_value_${e}_${C}`))}):void 0,children:i.map(w=>o.jsx(c.MenuItem,{value:w.id,children:o.jsx(Fe,{enumKey:w.id,enumValues:i,small:!0})},`select_${e}_${w.id}`))},`filter-select-${p}-${e}`)]})})]})}const Qi="BooleanFilterField",Pr={formControl:`${Qi}-formControl`,label:`${Qi}-label`},Jc=ge.styled("div")(({theme:e})=>({[`& .${Pr.formControl}`]:{width:"200px"},[`& .${Pr.label}`]:{width:"100%",height:"100%"}}));function qc({name:e,title:t,value:r,setValue:n}){function s(a){n(a!==void 0?["==",a]:void 0)}const i=r&&r[1],l=!!r;return o.jsx(Jc,{children:o.jsx(c.FormControlLabel,{className:Pr.formControl,labelPlacement:"end",checked:l&&i,control:o.jsx(c.Checkbox,{indeterminate:!l,onChange:a=>{s(i?!1:l?void 0:!0)}},`filter-${e}`),label:l?i?`${t} is true`:`${t} is false`:"No filter"})})}const Zc={"==":"==","!=":"!=",">":">","<":"<",">=":">=","<=":"<=",in:"in","array-contains":"Contains","array-contains-any":"Any"},Li=["array-contains-any","in"];function Xc({name:e,isArray:t,mode:r,value:n,setValue:s,title:i}){const l=t?["array-contains"]:["==","!=",">","<",">=","<="],[a,A]=n||[l[0],void 0],[u,f]=d.useState(a),[h,b]=d.useState(A);function v(p,w){let C=w;const x=Li.includes(u),B=Li.includes(p);x!==B&&(C=B?w?[w]:[]:""),f(p),b(C===null?void 0:C);const E=C!==null&&Array.isArray(C)?C.length>0:C!==void 0;s(p&&E?[p,C]:void 0)}const g=r===void 0||r==="date_time"?Dt.DateTimePicker:Tt.DatePicker;return o.jsxs(c.Box,{display:"flex",width:440,alignItems:"center",children:[o.jsx(c.Box,{width:80,children:o.jsx(c.FormControl,{fullWidth:!0,children:o.jsx(c.Select,{value:u,fullWidth:!0,onChange:p=>{v(p.target.value,h)},children:l.map(p=>o.jsx(c.MenuItem,{value:p,children:Zc[p]},`filter_op_${e}_${p}`))})})}),o.jsx(c.Box,{flexGrow:1,ml:1,children:o.jsx(g,{value:h??null,renderInput:p=>o.jsx(c.TextField,{...p,fullWidth:!0,sx:{minHeight:"56px"},InputProps:{...p.InputProps,sx:{minHeight:"56px"},endAdornment:o.jsxs(c.Box,{sx:{pr:2,gap:2},children:[o.jsx(c.IconButton,{sx:{position:"absolute",right:"56px",top:"12px"},onClick:w=>v(u,void 0),children:o.jsx(Pe,{})}),p.InputProps?.endAdornment]})},variant:"outlined"}),onChange:p=>{v(u,p===null?void 0:p)}})})]})}const Kc={},Oi=d.createContext(Kc),Rc=()=>d.useContext(Oi),Mr=d.memo(function({fullPath:t,initialFilter:r,initialSort:n,filterCombinations:s,forceFilter:i,actionsStart:l,actions:a,title:A,tableRowActionsBuilder:u,selectionController:f,highlightedEntities:h,onEntityClick:b,onColumnResize:v,onSizeChanged:g,textSearchEnabled:p=!1,hoverRow:w=!0,inlineEditing:C=!1,tableController:{data:x,dataLoading:B,noMoreToLoad:E,dataLoadingError:m,filterValues:k,setFilterValues:S,sortBy:F,setSortBy:I,searchString:T,setSearchString:P,clearFilter:M,itemCount:L,setItemCount:W,pageSize:$,paginationEnabled:Z,checkFilterCombination:z},...J}){const O=c.useTheme(),D=c.useMediaQuery(O.breakpoints.up("md")),Q=!!i,j=f?.selectedEntities?.length>0?f?.selectedEntities:h,V=d.useRef(Math.random().toString(36)),re=oe(),G=Se(),_=Ne(),N=d.useMemo(()=>pe({collection:J,path:t,fields:re.fields}),[J,t]),[R,Y]=d.useState(N.defaultSize??"m"),[te,ee]=d.useState(void 0),[H,Ye]=d.useState(void 0),[bo,ze]=d.useState(!1),vo=j?.map(q=>q.id),yt=!!k&&Object.keys(k).length>0,Ue=d.useMemo(()=>{const q=J.subcollections?.map(ie=>({id:Fi(ie),name:ie.name,width:200,dependencies:[],Builder:({entity:de})=>o.jsx(c.Button,{color:"primary",variant:"outlined",startIcon:o.jsx(It,{fontSize:"small"}),onClick:se=>{se.stopPropagation(),_.open({path:t,entityId:de.id,selectedSubPath:ie.alias??ie.path,collection:J,updateUrl:!0})},children:ie.name})}))??[];return[...J.additionalFields??J.additionalColumns??[],...q]},[J,t]),wt=d.useCallback(({name:q,value:ie,property:de,entityId:se})=>G.checkUniqueField(t,q,ie,de,se),[t]),Ct=()=>{!Z||B||E||L!==void 0&&W(L+$)},Nr=d.useCallback(()=>{W($)},[$]),Hr=d.useCallback(({rowData:q})=>{if(!C)return b&&b(q)},[b,C]),_r=d.useCallback(q=>{g&&g(q),Y(q)},[]),jr=d.useCallback(q=>P(q),[]),yo=d.useMemo(()=>Ue?Ue.map(q=>({[q.id]:q})).reduce((q,ie)=>({...q,...ie}),{}):{},[Ue]);d.useEffect(()=>{const q=ie=>{ie.keyCode===27&&U()};return document.addEventListener("keydown",q,!1),()=>{document.removeEventListener("keydown",q,!1)}});const Jr=d.useCallback(q=>{ee(q),ze(!0)},[]),U=d.useCallback(()=>{ee(void 0),ze(!1)},[]),ae=d.useCallback(()=>{Ye(void 0),ze(!0)},[]),ce=od(N,!0),$o=wt,xt=d.useCallback(({column:q,columnIndex:ie,rowData:de,rowIndex:se})=>{const fe=de,$e=q.key,Vo=wr(J.properties,$e);if(!Vo)return null;const wo=Ie({propertyKey:$e,propertyOrBuilder:Vo,path:t,propertyValue:fe.values?Ve(fe.values,$e):void 0,values:fe.values,entityId:fe.id,fields:re.fields});return wo?o.jsx(ne,{children:fe?o.jsx(Sc,{readonly:!C,align:q.align??"left",propertyKey:$e,property:wo,setFocused:ze,value:fe?.values?Ve(fe.values,$e):void 0,collection:J,customFieldValidator:$o,columnIndex:ie,width:q.width,height:po(R),entity:fe,path:fe.path},`property_table_cell_${fe.id}_${$e}`):Qe()}):null},[J,$o,t,C,R,vo]),Bt=d.useCallback(({column:q,rowData:ie,width:de})=>{const se=ie,fe=yo[q.key],$e=fe.dependencies?Object.entries(se.values).filter(([wo,Es])=>fe.dependencies.includes(wo)).reduce((wo,Es)=>({...wo,...Es}),{}):se;fe.builder&&console.warn("`additionalField.builder` is deprecated. Use `additionalField.Builder` instead.");const Vo=fe.builder??fe.Builder;if(!Vo)throw new Error("No builder provided for additional field");return o.jsx(Fr,{width:de,size:R,focused:bo,value:$e,selected:!1,selectedRow:vo?.includes(se.id)??!1,disabled:!0,align:"left",allowScroll:!1,showExpandIcon:!1,disabledTooltip:"This column can't be edited directly",children:o.jsx(ne,{children:o.jsx(Vo,{entity:se,context:re})})},`additional_table_cell_${se.id}_${q.key}`)},[yo,R,vo]),Et=d.useMemo(()=>{const q=Object.entries(N.properties).flatMap(([de,se])=>se.dataType==="map"&&se.spreadChildren&&se.properties?Object.keys(se.properties).map(fe=>`${de}.${fe}`):[de]).map(de=>{const se=Cr(N.properties,de);if(!se)throw Error("Internal error: no property found in path "+de);const fe=Vi(se);return{key:de,align:Ac(se),icon:$e=>ve(se,$e?void 0:"disabled","small"),title:se.name??de,sortable:i?Object.keys(i).includes(de):!0,filter:!Q&&fe,width:Si(se),resizable:!0,custom:se}}),ie=Ue?Ue.map(de=>({key:de.id,type:"additional",align:"left",sortable:!1,title:de.name,width:de.width??200})):[];return[...q,...ie]},[Ue,Q,i,N.properties]),Bs=d.useMemo(()=>({key:"id_ewcfedcswdf3",width:D?160:130,title:"ID",resizable:!1,frozen:D,headerAlign:"center"}),[D]),sA=d.useMemo(()=>[Bs,...ce.map(q=>Et.find(ie=>ie.key===q)).filter(q=>!!q)],[Et,ce,Bs]),lA=d.useCallback(q=>{const ie=q.column,de=q.columns,se=ie.key;if(q.columnIndex===0)return u?u({entity:q.rowData,size:R,width:ie.width,frozen:ie.frozen}):o.jsx(Ir,{entity:q.rowData,width:ie.width,frozen:ie.frozen,size:R});if(yo[se])return Bt(q);if(q.columnIndex<de.length+1)return xt(q);throw Error("Internal: columns not mapped properly")},[yo,u,R,Bt,xt]),aA=d.useCallback(q=>{S({...q,...i})},[i]);return o.jsx(Oi.Provider,{value:{setPopupCell:Ye,select:Jr,onValueChange:Gi,size:R,selectedCell:te,selectedEntityIds:vo,focused:bo},children:o.jsxs(c.Box,{sx:q=>({height:"100%",width:"100%",display:"flex",flexDirection:"column",backgroundColor:q.palette.background.paper}),children:[o.jsx(Uc,{forceFilter:Q,filterIsSet:yt,onTextSearch:p?jr:void 0,clearFilter:M,size:R,onSizeChanged:_r,title:A,actionsStart:l,actions:a,loading:B}),o.jsx(c.Box,{sx:{flexGrow:1},children:o.jsx(Ti,{data:x,columns:sA,cellRenderer:lA,onRowClick:C?void 0:Hr,onEndReached:Ct,onResetPagination:Nr,error:m,paginationEnabled:Z,onColumnResize:v,size:R,loading:B,filter:k,onFilterUpdate:aA,sortBy:F,onSortByUpdate:I,hoverRow:w,checkFilterCombination:z,createFilterField:td})}),o.jsx(Pc,{open:!!H,onClose:ae,cellRect:H?.cellRect,columnIndex:H?.columnIndex,propertyKey:H?.propertyKey,collection:H?.collection,entity:H?.entity,tableKey:V.current,customFieldValidator:$o,path:t,onCellValueChange:Gi},`popup_form_${H?.columnIndex}_${H?.entity?.id}`)]})})},le),Gi=({fullPath:e,collection:t,dataSource:r,context:n,value:s,propertyKey:i,onValueUpdated:l,setError:a,entity:A})=>{const u=we.setIn({...A.values},i,s),f={path:e,entityId:A.id,values:u,previousValues:A.values,collection:t,status:"existing"};return Wt({...f,callbacks:t.callbacks,dataSource:r,context:n,onSaveSuccess:()=>l(),onSaveFailure:h=>{console.error("Save failure"),console.error(h),a(h)}})};function ed(e,t){const r=Object.keys(e.properties);e.additionalColumns&&console.warn("`additionalColumns` is deprecated and will be removed in previous versions. Use `additionalFields` instead, with the same structure.");const n=e.additionalFields??e.additionalColumns??[],s=e.subcollections??[],i=[...r,...n.map(l=>l.id)];if(t){const l=s.map(a=>Fi(a));i.push(...l.filter(a=>!i.includes(a)))}return $i(e,i)}function od(e,t){return d.useMemo(()=>e.propertiesOrder?$i(e,e.propertiesOrder):ed(e,t),[e,t])}function $i(e,t){return t.flatMap(r=>{const n=e.properties[r];return n?n.hideFromCollection?[null]:n.disabled&&typeof n.disabled=="object"&&n.disabled.hidden?[null]:n.dataType==="map"&&n.spreadChildren&&n.properties?Object.keys(n.properties).map(i=>`${r}.${i}`):[r]:e.additionalFields?.find(i=>i.id===r)?[r]:[null]}).filter(r=>r!==null)}function td({id:e,filterValue:t,setFilterValue:r,column:n,popupOpen:s,setPopupOpen:i}){const l=n.custom;if(!l)return null;const a=l?.dataType==="array",A=a?l.of:l;if(!A)return null;if(A.dataType==="reference")return o.jsx(Hc,{value:t,setValue:r,name:e,isArray:a,path:A.path,title:l?.name,previewProperties:A?.previewProperties,popupOpen:s,setPopupOpen:i});if(A.dataType==="number"||A.dataType==="string"){const u=A.name,f=A.enumValues?Qo(A.enumValues):void 0;return o.jsx(jc,{value:t,setValue:r,name:e,dataType:A.dataType,isArray:a,enumValues:f,title:u})}else if(A.dataType==="boolean"){const u=A.name;return o.jsx(qc,{value:t,setValue:r,name:e,title:u})}else if(A.dataType==="date"){const u=A.name;return o.jsx(Xc,{value:t,setValue:r,name:e,mode:A.mode,isArray:a,title:u})}return o.jsx("div",{children:`Currently the field ${l.dataType} is not supported`})}function Vi(e,t=!1){return t?["string","number","date","reference"].includes(e.dataType):e.dataType==="array"?e.of?Vi(e.of,!0):!1:["string","number","boolean","date","reference","array"].includes(e.dataType)}const Wi={enter:225,exit:175},rd=d.forwardRef(function(t,r){const{children:n,onClose:s,open:i,offsetPosition:l}=t,a=c.useTheme();return o.jsx(c.Modal,{BackdropProps:{transitionDuration:Wi,sx:{backgroundColor:a.palette.mode==="dark"?"rgba(0, 0, 0, 0.85)":"rgba(0, 0, 0, 0.6)"}},BackdropComponent:c.Backdrop,open:i,onClose:s?()=>s(!1):void 0,ref:r,keepMounted:!0,disableEnforceFocus:!0,disableEscapeKeyDown:!0,sx:{transition:`transform 300ms ${a.transitions.easing.easeOut}`,transform:`translateX(-${l*200}px)`},children:o.jsx(c.Slide,{in:i,timeout:Wi,direction:"left",children:o.jsx(c.Paper,{variant:"outlined",square:!0,sx:{height:"100%",WebkitOverflowScrolling:"touch",position:"fixed",outline:0,left:"auto",right:0,overflow:"hidden",borderRadius:"16px 0 0 16px"},children:n})})})});function nd(e,t){const[r,n]=d.useState(),{navigator:s}=d.useContext(Ae.UNSAFE_NavigationContext),i=Ae.useNavigate(),l=()=>{n(void 0)},a=()=>{t(),n(void 0),i(-1)},A=d.useCallback(({action:u,location:f,retry:h})=>{switch(u){case"REPLACE":{h();return}case"POP":n(f)}},[]);return d.useEffect(()=>{if(!e||r||!("block"in s))return;const u=s.block(f=>{const h={...f,retry(){u(),f.retry()}};A(h)});return u},[s,A,e,r]),{navigationWasBlocked:!!r,handleCancel:l,handleOk:a}}function id({open:e,handleOk:t,handleCancel:r,body:n,title:s}){return o.jsxs(Bl,{keepMounted:!1,open:e,onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[o.jsx(ml,{children:s??"Unsaved changes"}),o.jsxs(El,{children:[n&&o.jsx(An,{children:n}),o.jsx(An,{children:"Are you sure you want to leave this page?"})]}),o.jsxs(je,{children:[o.jsx(dn,{onClick:r,autoFocus:!0,children:" Cancel "}),o.jsx(dn,{onClick:t,children:" Ok "})]})]})}const Yi=d.createContext({width:"",blocked:!1,setBlocked:e=>{},setBlockedNavigationMessage:e=>{},close:()=>{}}),gt=()=>d.useContext(Yi);function zi(){const t=ko().sidePanels,r=[...t];return r.push(void 0),o.jsx(o.Fragment,{children:r.map((n,s)=>o.jsx(sd,{panel:n,offsetPosition:t.length-s-1},`side_dialog_${s}`))})}function sd({offsetPosition:e,panel:t}){const[r,n]=d.useState(!1),[s,i]=d.useState(!1),[l,a]=d.useState(),A=d.useRef(t?.width),u=A.current,f=ko(),{navigationWasBlocked:h,handleOk:b,handleCancel:v}=nd(s&&!r,()=>i(!1));d.useEffect(()=>{t&&(A.current=t.width)},[t]);const g=()=>{i(!1),n(!1),f.close(),t?.onClose?.()},p=()=>{n(!1)},w=C=>{s&&!C?n(!0):(f.close(),t?.onClose?.())};return o.jsxs(Yi.Provider,{value:{blocked:s,setBlocked:i,setBlockedNavigationMessage:a,width:u,close:w},children:[o.jsxs(rd,{open:!!t,onClose:w,offsetPosition:e,children:[t&&o.jsx(c.Box,{sx:{display:"flex",flexDirection:"column",height:"100%",transition:"width 250ms ease-in-out",width:t.width,maxWidth:"100vw"},children:o.jsx(ne,{children:t.component})}),!t&&o.jsx("div",{style:{width:u}})]}),o.jsx(id,{open:h||r,handleOk:r?g:b,handleCancel:r?p:v,body:l})]})}function ld({entityOrEntitiesToDelete:e,collection:t,onClose:r,open:n,callbacks:s,onEntityDelete:i,onMultipleEntitiesDelete:l,path:a,...A}){const u=Se(),f=He(),[h,b]=d.useState(!1),[v,g]=d.useState(),[p,w]=d.useState(),C=oe();d.useEffect(()=>{if(e){const M=Array.isArray(e)&&e.length===1?e[0]:e;g(M),w(Array.isArray(M))}},[e]);const x=d.useMemo(()=>pe({collection:t,path:a,fields:C.fields}),[t,a]),B=d.useCallback(()=>{r()},[r]),E=d.useCallback(M=>{console.debug("Deleted",M)},[]),m=d.useCallback((M,L)=>{f.open({type:"error",message:"Error deleting: "+L?.message}),console.error("Error deleting entity"),console.error(L)},[x.name]),k=d.useCallback((M,L)=>{f.open({type:"error",message:"Error before deleting: "+L?.message}),console.error(L)},[x.name]),S=d.useCallback((M,L)=>{f.open({type:"error",message:"Error after deleting: "+L?.message}),console.error(L)},[x.name]),F=d.useCallback(M=>mn({dataSource:u,entity:M,collection:x,callbacks:s,onDeleteSuccess:E,onDeleteFailure:m,onPreDeleteHookError:k,onDeleteSuccessHookError:S,context:C}),[u,x,s,E,m,k,S,C]),I=d.useCallback(async()=>{v&&(b(!0),p?Promise.all(v.map(F)).then(M=>{b(!1),l&&v&&l(a,v),M.every(Boolean)?f.open({type:"success",message:`${x.name}: multiple deleted`}):M.some(Boolean)?f.open({type:"warning",message:`${x.name}: Some of the entities have been deleted, but not all`}):f.open({type:"error",message:`${x.name}: Error deleting entities`}),r()}):F(v).then(M=>{b(!1),M&&(i&&v&&i(a,v),f.open({type:"success",message:`${x.singularName??x.name} deleted`}),r())}))},[v,p,F,l,a,r,f,x.name,i]);let T;if(v&&p)T=o.jsx("div",{children:"Multiple entities"});else{const M=v;T=M?o.jsx(kr,{entity:M,collection:t,path:a}):o.jsx(o.Fragment,{})}const P=p?`${x.name}: Confirm multiple delete?`:`Would you like to delete this ${x.singularName??x.name}?`;return o.jsxs(c.Dialog,{maxWidth:"md","aria-labelledby":"delete-dialog",open:n,onBackdropClick:r,...A,children:[o.jsx(c.DialogTitle,{id:"delete-dialog-title",children:P}),!p&&o.jsx(c.DialogContent,{dividers:!0,children:T}),o.jsxs(je,{children:[h&&o.jsx(c.CircularProgress,{size:16,thickness:8}),o.jsx(c.Button,{onClick:B,disabled:h,color:"primary",children:"Cancel"}),o.jsx(c.Button,{autoFocus:!0,disabled:h,onClick:I,variant:"contained",color:"primary",children:"Ok"})]})]})}function ad(e,t,r,n,s){const i=r.properties,l=dd(i,n,s),a=cd(e,t,i,l),A=Hi(l.map(f=>f.label)),u=a.map(f=>Hi(f));Ad([A,...u],`${r.name}.csv`,"text/csv")}function cd(e,t,r,n){const s=e.map(i=>({id:i.id,...Ni(i.values,r)}));return t&&t.forEach((i,l)=>{s[l]={...s[l],...i}}),s&&s.map(i=>n.map(l=>Ve(i,l.key)))}function dd(e,t,r){const n=[{label:"id",key:"id"},...Object.entries(e).map(([s,i])=>Ui(i,s,"")).flat()];return r?.additionalFields&&n.push(...r.additionalFields.map(s=>({label:s.key,key:s.key}))),n}function Ui(e,t,r=""){const n=r?`${r}.${t}`:t;return e.dataType==="map"&&e.properties?Object.entries(e.properties).map(([s,i])=>Ui(i,s,n)).flat():[{label:n,key:n}]}function Qr(e,t){let r;if(t.dataType==="map"&&t.properties)r=Ni(e,t.properties);else if(t.dataType==="array")t.of&&Array.isArray(e)?Array.isArray(t.of)?r=t.of.map((n,s)=>Qr(e[s],n)):t.of.dataType==="map"?r=e.map(n=>JSON.stringify(n)):r=e.map(n=>Qr(n,t.of)):r=e;else if(t.dataType==="reference"){const n=e||void 0;r=n?n.pathWithId:null}else t.dataType==="date"?r=e?e.getTime():null:r=e;return r}function Ni(e,t){const r=Object.entries(t).map(([n,s])=>{const i=e&&e[n],l=Qr(i,s);return l===void 0?{}:{[n]:l}}).reduce((n,s)=>({...n,...s}),{});return{...e,...r}}function Hi(e){return e.map(t=>t==null?"":'"'+String(t).replaceAll('"','""')+'"').join(",")+`\r
`}function Ad(e,t,r){const n=new Blob(e,{type:r}),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.setAttribute("download",t),i.click()}const Lr=200;function ud({collection:e,path:t,exportConfig:r}){const n=oe(),s=Se(),l=he().resolveAliasesFrom(t),a=d.useMemo(()=>pe({collection:e,path:l,fields:n.fields}),[e,l]),A=d.useRef(),u=d.useRef(),[f,h]=d.useState(!1),[b,v]=d.useState(),[g,p]=d.useState(!1),[w,C]=d.useState(!1),[x,B]=d.useState(!1),E=d.useCallback(()=>{B(!0)},[B]),m=d.useCallback(()=>{B(!1)},[B]),k=d.useCallback((P,M,L,W,$)=>{if(!P)throw Error("Trying to perform export without loading data first");ad(P,M,L,W,$)},[]),S=d.useCallback(async P=>{if(!r?.additionalFields)return;const M=r.additionalFields;return await Promise.all(P.map(async W=>(await Promise.all(M.map(async $=>({[$.key]:await $.builder({entity:W,context:n})})))).reduce(($,Z)=>({...$,...Z}),{})))},[r?.additionalFields]),F=d.useCallback(async P=>{P.length>=Lr&&p(!0);const M=A.current&&P.length>A.current.length&&w;A.current=P;const L=await S(P);u.current=L,v(void 0),M&&(k(P,L,a,l,r),m())},[a,k,r,S,w,m,l]);d.useEffect(()=>{x&&(h(!0),s.fetchCollection({path:l,collection:a,limit:w?void 0:Lr}).then(F).catch(v).finally(()=>h(!1)))},[a,s,w,x,l,F]);const I=g&&!w,T=d.useCallback(()=>{I?C(!0):(k(A.current,u.current,a,l,r),m())},[I,k,a,l,r,m]);return o.jsxs(o.Fragment,{children:[o.jsx(c.Tooltip,{title:"Export",children:o.jsx(c.IconButton,{color:"primary",onClick:E,children:o.jsx(wl,{})})}),o.jsxs(c.Dialog,{keepMounted:!1,open:x,onClose:m,children:[o.jsx(c.DialogTitle,{children:"Export data"}),o.jsx(c.DialogContent,{children:o.jsxs(c.DialogContentText,{children:[o.jsx("div",{children:"Download the the content of this table as a CSV"}),o.jsx("br",{}),I&&o.jsxs(c.Alert,{elevation:3,variant:"filled",severity:"warning",children:[o.jsxs("div",{children:["This collections has a large number of documents (more than ",Lr,")."]}),o.jsx("div",{children:"Would you like to proceed?"})]})]})}),o.jsxs(je,{children:[f&&o.jsx(c.CircularProgress,{size:16,thickness:8}),o.jsx(c.Button,{color:"primary",onClick:m,children:"Cancel"}),o.jsx(c.Button,{color:"primary",variant:"contained",disabled:f,onClick:T,children:"Download"})]})]})]})}function fd({collection:e,onNewClick:t,exportable:r,onMultipleDeleteClick:n,selectionEnabled:s,path:i,selectionController:l,loadedEntities:a}){const A=oe(),u=Je(),f=c.useTheme(),h=c.useMediaQuery(f.breakpoints.up("md")),b=l.selectedEntities,v=dt(e,u,We(i),null)&&t&&(h?o.jsxs(c.Button,{id:`add_entity_${i}`,onClick:t,startIcon:o.jsx(ye.Add,{}),size:"large",variant:"contained",color:"primary",children:["Add ",e.singularName??e.name]}):o.jsx(c.Button,{id:`add_entity_${i}`,onClick:t,size:"medium",variant:"contained",color:"primary",children:o.jsx(ye.Add,{})})),g=Br(e,u,We(i),null);let p;if(s){const B=h?o.jsxs(c.Button,{disabled:!b?.length||!g,startIcon:o.jsx(ye.Delete,{}),onClick:n,color:"primary",sx:{minWidth:68},children:["(",b?.length,")"]}):o.jsx(c.IconButton,{color:"primary",disabled:!b?.length||!g,onClick:n,children:o.jsx(ye.Delete,{})});p=o.jsx(c.Tooltip,{title:g?"Delete":"You have selected at least one entity you cannot delete",children:o.jsx("span",{children:B})})}const w={path:i,collection:e,selectionController:l,context:A,loadedEntities:a},C=e.Actions?Array.isArray(e.Actions)?o.jsx(o.Fragment,{children:e.Actions.map((B,E)=>o.jsx(B,{...w},`actions_${E}`))}):o.jsx(e.Actions,{...w}):void 0,x=r&&o.jsx(ud,{collection:e,exportConfig:typeof e.exportable=="object"?e.exportable:void 0,path:i});return o.jsxs(o.Fragment,{children:[C,p,x,v]})}function gd({data:e,entitiesDisplayedFirst:t}){if(!t)return e;const r=new Set(t.map(n=>n.id));return[...t,...e.filter(n=>!r.has(n.id))]}function hd(e,t,r=5e3){const[n,s]=d.useState(e),i=d.useRef(n.length??0),l=d.useRef(!1),a=d.useRef(t),A=!le(a.current,t),u=e.length>=i.current||A;return d.useEffect(()=>{const f=()=>{le(n,e)||(a.current=t,i.current=e.length,s(e)),l.current=!1};l.current=!0;let h;return u?f():h=setTimeout(f,r),()=>{clearTimeout(h),l.current&&u&&f()}},[e,r,t,u]),u?e:n}const pd=50;function _i({fullPath:e,collection:t,entitiesDisplayedFirst:r,isFilterCombinationValid:n,lastDeleteTimestamp:s}){const{filterCombinations:i,initialFilter:l,initialSort:a,forceFilter:A}=t,u=t.pagination===void 0||!!t.pagination,f=typeof t.pagination=="number"?t.pagination:pd,[h,b]=d.useState(),[v,g]=d.useState(u?f:void 0),p=d.useCallback((M,L)=>n(M,L,i),[i]),w=d.useMemo(()=>{if(a&&A&&!p(A,a)){console.warn("Initial sort is not compatible with the force filter. Ignoring initial sort");return}return a},[a,A]),[C,x]=d.useState(A??l??void 0),[B,E]=d.useState(w),m=d.useCallback(()=>x(A??void 0),[A]),{data:k,dataLoading:S,noMoreToLoad:F,dataLoadingError:I}=En({path:e,collection:t,filterValues:C,sortBy:B,searchString:h,itemCount:v}),T=gd({data:k,entitiesDisplayedFirst:r});return{data:hd(T,{filterValues:C,sortBy:B,searchString:h,lastDeleteTimestamp:s}),dataLoading:S,noMoreToLoad:F,dataLoadingError:I,filterValues:C,setFilterValues:x,sortBy:B,setSortBy:E,searchString:h,setSearchString:b,clearFilter:m,itemCount:v,setItemCount:g,paginationEnabled:u,pageSize:f,checkFilterCombination:p}}function ji(e,t,r){const n=t?t[0]:void 0,s=t?t[1]:void 0,i=Object.values(e);if(n&&i.map(A=>A[0]).includes("=="))return!1;const l=Object.keys(e),a=l.length;return a===1&&(!n||n===l[0])?!0:!r&&a>1?!1:!!r&&r.filter(A=>!n||n in A).find(A=>Object.entries(e).every(([u,f])=>A[u]!==void 0&&(!s||A[u]===s)))!==void 0}const Or=d.memo(function({fullPath:t,isSubCollection:r,...n}){const s=Ne(),i=Je(),l=ao(),a=oe(),A=d.useMemo(()=>{const Y=l?.getCollectionConfig(t);return Y?Le(n,Y):n},[n,t,l?.getCollectionConfig]),u=c.useTheme(),[f,h]=d.useState(void 0),[b,v]=d.useState(void 0),[g,p]=d.useState(0),w=d.useCallback(()=>{const Y=f;setTimeout(()=>{Y===f&&h(void 0)},2400)},[f]),C=d.useCallback(Y=>xr(A,i,We(t),Y??null)?A.inlineEditing===void 0||A.inlineEditing:!1,[A,i,t]),x=A.exportable===void 0||A.exportable,B=A.selectionEnabled===void 0||A.selectionEnabled,E=!C(),[m,k]=d.useState(null),S=Gr(),F=A.selectionController??S,{selectedEntities:I,toggleEntitySelection:T,isEntitySelected:P,setSelectedEntities:M}=F;d.useEffect(()=>{v(void 0)},[I]);const L=_i({fullPath:t,collection:A,entitiesDisplayedFirst:[],isFilterCombinationValid:ji,lastDeleteTimestamp:g}),W=d.useCallback(Y=>(h(Y),a.onAnalyticsEvent?.("edit_entity_clicked",{path:Y.path,entityId:Y.id}),s.open({entityId:Y.id,path:t,collection:A,updateUrl:!0,onClose:w})),[t,A,s]),$=d.useCallback(()=>{a.onAnalyticsEvent?.("new_entity_click",{path:t}),s.open({path:t,collection:A,updateUrl:!0,onClose:w})},[t,A,s]),Z=d.useCallback(Y=>{a.onAnalyticsEvent?.("single_delete_dialog_open",{path:t}),v(Y)},[a,t]),z=d.useCallback(()=>{a.onAnalyticsEvent?.("multiple_delete_dialog_open",{path:t}),v(I)},[a,t,I]),J=d.useCallback((Y,te)=>{a.onAnalyticsEvent?.("single_entity_deleted",{path:t}),M(ee=>ee.filter(H=>H.id!==te.id)),p(Date.now())},[a,t,M]),O=d.useCallback((Y,te)=>{a.onAnalyticsEvent?.("multiple_entities_deleted",{path:t}),M([]),v(void 0),p(Date.now())},[M]),D=d.useCallback((Y,te)=>{if(l){const ee=l.getCollectionConfig(Y),H=Le(ee,te);l.onCollectionModified(Y,H)}},[l]),Q=d.useCallback(({width:Y,key:te})=>{if(!A.properties[te])return;const ee={columnWidth:Y},H={properties:{[te]:ee}};D(t,H)},[A,D,t]),j=d.useCallback(Y=>{l&&D(t,{defaultSize:Y})},[D,t,l]),V=m!=null,re=d.useMemo(()=>o.jsx(c.Box,{sx:{display:"flex",flexDirection:"row",contain:"content","& > *:not(:last-child)":{[u.breakpoints.down("md")]:{mr:u.spacing(1)},mr:u.spacing(2)}},children:o.jsxs(c.Box,{children:[o.jsx(c.Typography,{variant:"h6",sx:{lineHeight:"1.15",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:"164px",cursor:A.description?"pointer":"inherit"},onClick:A.description?Y=>{k(Y.currentTarget),Y.stopPropagation()}:void 0,children:`${A.name}`}),o.jsx(bd,{fullPath:t}),A.description&&o.jsx(c.Popover,{id:"info-dialog",open:V,anchorEl:m,elevation:3,onClose:()=>{k(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:o.jsx(c.Box,{m:2,children:o.jsx(et,{source:A.description})})})]})}),[u,A.description,A.name,t,V,m]),G=dt(A,i,We(t),null),_=d.useCallback(Y=>{h(Y),a.onAnalyticsEvent?.("copy_entity_click",{path:Y.path,entityId:Y.id}),s.open({entityId:Y.id,path:t,copy:!0,collection:A,updateUrl:!0,onClose:w})},[s,A,t,w]),N=d.useCallback(Y=>{h(Y),a.onAnalyticsEvent?.("entity_click",{path:Y.path,entityId:Y.id}),s.open({entityId:Y.id,path:t,collection:A,updateUrl:!0,onClose:w})},[s,A,t,w]),R=d.useCallback(({entity:Y,size:te,width:ee,frozen:H})=>{const Ye=P(Y),bo=Br(A,i,We(t),Y);return o.jsx(Ir,{entity:Y,width:ee,frozen:H,isSelected:Ye,selectionEnabled:B,size:te,toggleEntitySelection:T,onEditClicked:N,onCopyClicked:G?_:void 0,onDeleteClicked:bo?Z:void 0,hideId:A?.hideIdFromCollection})},[P,A,i,t,B,T,N,G,_]);return o.jsxs(c.Box,{sx:{overflow:"hidden",height:"100%",width:"100%"},children:[o.jsx(Mr,{fullPath:t,tableController:L,onSizeChanged:j,onEntityClick:W,onColumnResize:Q,tableRowActionsBuilder:R,title:re,selectionController:F,highlightedEntities:f?[f]:[],...A,actions:o.jsx(fd,{collection:A,exportable:x,onMultipleDeleteClick:z,onNewClick:$,path:t,loadedEntities:L.data,selectionController:F,selectionEnabled:B}),hoverRow:E,inlineEditing:C()},`collection_table_${t}`),b&&o.jsx(ld,{entityOrEntitiesToDelete:b,path:t,collection:A,callbacks:A.callbacks,open:!!b,onEntityDelete:J,onMultipleEntitiesDelete:O,onClose:()=>v(void 0)})]})},le);function Gr(){const[e,t]=d.useState([]),r=d.useCallback(s=>{let i;e.map(l=>l.id).includes(s.id)?i=e.filter(l=>l.id!==s.id):i=[...e,s],t(i)},[e]),n=d.useCallback(s=>e.map(i=>i.id).includes(s.id),[e]);return{selectedEntities:e,setSelectedEntities:t,isEntitySelected:n,toggleEntitySelection:r}}function bd({fullPath:e}){const t=Se(),r=he(),[n,s]=d.useState(void 0),[i,l]=d.useState(void 0);return d.useEffect(()=>{t.countEntities(r.resolveAliasesFrom(e)).then(s).catch(l)},[e,t,r]),i?null:o.jsx(c.Typography,{sx:{display:"block",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:"160px",textAlign:"left"},variant:"caption",color:"textSecondary",children:n!==void 0?`${n} entities`:Qe()})}function Ji({onSingleEntitySelected:e,onMultipleEntitiesSelected:t,multiselect:r,collection:n,path:s,selectedEntityIds:i,description:l,forceFilter:a,maxSelection:A}){const u=gt(),f=Ne(),h=he(),b=oe(),v=h.resolveAliasesFrom(s),g=Se(),[p,w]=d.useState([]),C=Gr();d.useEffect(()=>{let I=!1;return i&&n?Promise.all(i.map(T=>g.fetchEntity({path:v,entityId:T,collection:n}))).then(T=>{if(!I){const P=T.filter(M=>M!==void 0);C.setSelectedEntities(P),w(P)}}):(C.setSelectedEntities([]),w([])),()=>{I=!0}},[g,v,i,n,C.setSelectedEntities]);const x=d.useCallback(()=>{b.onAnalyticsEvent?.("reference_selection_clear",{path:v}),C.setSelectedEntities([]),!r&&e?e(null):t&&t([])},[r,t,e]),B=d.useCallback(I=>{let T;const P=C.selectedEntities;if(b.onAnalyticsEvent?.("reference_selection_toggle",{path:v,entityId:I.id}),P){if(P.map(M=>M.id).indexOf(I.id)>-1)T=P.filter(M=>M.id!==I.id);else{if(A&&P.length>=A)return;T=[...P,I]}C.setSelectedEntities(T),t&&t(T)}},[t,C.selectedEntities]),E=d.useCallback(I=>{!r&&e?(b.onAnalyticsEvent?.("reference_selected_single",{path:v,entityId:I.id}),e(I),u.close(!1)):B(I)},[u,r,e,B]),m=d.useCallback(()=>{b.onAnalyticsEvent?.("reference_selection_new_entity",{path:v}),f.open({path:v,collection:n,updateUrl:!0,onUpdate:({entity:I})=>{w([I,...p]),E(I)},closeOnSave:!0})},[f,v,n,p,E]),k=d.useCallback(({entity:I,size:T,width:P,frozen:M})=>{const L=C.selectedEntities,W=L&&L.map($=>$.id).indexOf(I.id)>-1;return o.jsx(Ir,{width:P,frozen:M,entity:I,size:T,isSelected:W,selectionEnabled:r,toggleEntitySelection:B,hideId:n?.hideIdFromCollection})},[r,C.selectedEntities,B,n?.hideIdFromCollection]),S=d.useCallback(I=>{I.stopPropagation(),u.close(!1)},[u]);if(!n)return o.jsx(ue,{error:"Could not find collection with id "+n});const F=_i({fullPath:v,collection:n,entitiesDisplayedFirst:p,isFilterCombinationValid:ji});return o.jsxs(c.Box,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[o.jsx(c.Box,{sx:{flexGrow:1},children:p&&o.jsx(Mr,{fullPath:v,onEntityClick:E,forceFilter:a,tableController:F,tableRowActionsBuilder:k,title:o.jsx(c.Typography,{variant:"h6",children:n.singularName?`Select ${n.singularName}`:`Select from ${n.name}`}),...n,inlineEditing:!1,selectionController:C,actions:o.jsx(vd,{collection:n,path:v,onNewClick:m,onClear:x})})}),o.jsxs(je,{translucent:!1,children:[l&&o.jsx(c.Typography,{variant:"body2",sx:{flexGrow:1,textAlign:"left"},children:l}),o.jsx(c.Button,{onClick:S,color:"primary",variant:"outlined",children:"Done"})]})]})}function vd({collection:e,path:t,onClear:r,onNewClick:n}){const s=Je(),i=c.useTheme(),l=c.useMediaQuery(i.breakpoints.up("md")),a=dt(e,s,We(t),null)&&n&&(l?o.jsxs(c.Button,{onClick:n,startIcon:o.jsx(ye.Add,{}),size:"large",variant:"contained",color:"primary",children:["Add ",e.singularName??e.name]}):o.jsx(c.Button,{onClick:n,size:"medium",variant:"contained",color:"primary",children:o.jsx(ye.Add,{})}));return o.jsxs(o.Fragment,{children:[o.jsx(c.Button,{onClick:r,color:"primary",children:"Clear"}),a]})}function $r(e){return Array.isArray(e)?e:e?[e]:[]}function ht({children:e,group:t}){const r=ao();return o.jsx(to,{invisible:!0,initiallyExpanded:!(r?.collapsedGroups??[]).includes(t??"ungrouped"),onExpandedChange:n=>{if(r)if(n)r.setCollapsedGroups((r.collapsedGroups??[]).filter(s=>s!==(t??"ungrouped")));else{const s=(r.collapsedGroups??[]).concat(t??"ungrouped");r.setCollapsedGroups(s)}},title:o.jsx(c.Typography,{color:"textSecondary",className:"weight-500",sx:{ml:1},children:t?.toUpperCase()??"Ungrouped views".toUpperCase()}),children:o.jsx(c.Box,{mb:2,children:e})})}function Vr({view:e,path:t,collection:r,url:n,name:s,description:i,onClick:l}){const a=ao(),A=At(r??e),u=Ae.useNavigate(),f=oe(),h=(a?.favouritePaths??[]).includes(t);let b;if(f.plugins&&r){const v={path:t,collection:r,context:f};b=o.jsx(o.Fragment,{children:f.plugins.map((g,p)=>g.homePage?.CollectionActions?o.jsx(g.homePage.CollectionActions,{...v,extraProps:g.homePage.extraProps},`actions_${p}`):null)})}return o.jsx(c.Paper,{elevation:0,sx:{height:"100%"},children:o.jsxs(c.CardActionArea,{component:"div",sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",minHeight:248,height:"100%"},onClick:()=>{l?.(),u(n),a&&a.setRecentlyVisitedPaths([t,...(a.recentlyVisitedPaths??[]).filter(v=>v!==t)])},children:[o.jsxs(c.CardContent,{sx:{flexGrow:1,width:"100%"},children:[o.jsxs(c.Box,{sx:{height:40,display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},children:[o.jsx(A,{color:"disabled"}),o.jsxs(c.Box,{sx:{display:"flex",alignItems:"center",gap:1},onClick:v=>{v.preventDefault(),v.stopPropagation()},children:[b,a&&o.jsx(c.IconButton,{size:"small",onClick:v=>{v.preventDefault(),v.stopPropagation(),h?a.setFavouritePaths(a.favouritePaths.filter(g=>g!==t)):a.setFavouritePaths([...a.favouritePaths,t])},children:h?o.jsx(sn,{color:"secondary"}):o.jsx(nn,{color:"disabled"})})]})]}),o.jsx(c.Typography,{gutterBottom:!0,variant:"h5",component:"h2",children:s}),i&&o.jsx(c.Typography,{variant:"body2",color:"textSecondary",component:"div",children:o.jsx(et,{source:i})})]}),o.jsx(c.CardActions,{style:{alignSelf:"flex-end"},children:o.jsx(c.Box,{p:1,children:o.jsx(Rs,{color:"primary"})})})]})})}function yd({entry:e}){const t=Ae.useNavigate(),r=ao();if(!r)return null;const n=r.favouritePaths.includes(e.path);return o.jsx(c.Chip,{label:e.name,onClick:()=>t(e.url),onDelete:s=>{s.preventDefault(),s.stopPropagation(),n?r.setFavouritePaths(r.favouritePaths.filter(i=>i!==e.path)):r.setFavouritePaths([...r.favouritePaths,e.path])},deleteIcon:n?o.jsx(sn,{color:"secondary"}):o.jsx(nn,{color:"disabled"})},e.path)}function wd({hidden:e}){const t=oe(),r=he(),n=ao();if(!n)return null;const s=(n?.favouritePaths??[]).map(a=>r.topLevelNavigation?.navigationEntries.find(A=>A.path===a)).filter(Boolean),i=(n?.recentlyVisitedPaths??[]).map(a=>r.topLevelNavigation?.navigationEntries.find(A=>A.path===a)).filter(Boolean).slice(0,5),l=o.jsx(c.Collapse,{in:!e&&s.length>0,children:o.jsx(ht,{group:"Favourites",children:o.jsx(c.Grid,{container:!0,spacing:2,children:s.map(a=>o.jsx(c.Grid,{item:!0,xs:12,sm:6,lg:4,children:o.jsx(Vr,{...a,onClick:()=>{const A=a.type==="collection"?"home_favorite_navigate_to_collection":a.type==="view"?"home_favorite_navigate_to_view":"unmapped_event";t.onAnalyticsEvent?.(A,{path:a.path})}})},`nav_${a.group}_${a.name}`))})})});return o.jsxs(c.Box,{children:[o.jsx(c.Box,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:1,pb:2},children:i.map(a=>o.jsx(yd,{entry:a},a.path))}),l]})}function qi(){const e=d.useRef({}),t=Ae.useLocation(),r=d.createRef(),[n,s]=d.useState(0),[i,l]=d.useState("down"),a=d.useCallback(()=>{!r.current||!t.key||(e.current[t.key]=r.current.scrollTop,s(r.current.scrollTop),l(r.current.scrollTop>n?"down":"up"))},[r,t.key,n]);return d.useEffect(()=>{const A=r.current;if(A)return A.addEventListener("scroll",a,{passive:!0}),()=>{A&&A.removeEventListener("scroll",a)}},[r,a,t]),d.useEffect(()=>{!r.current||!e.current||!e.current[t.key]||r.current.scrollTo({top:e.current[t.key],behavior:"auto"})},[t]),{containerRef:r,scroll:n,direction:i}}const Wr=new vl({charset:"latin:advanced",tokenize:"full"});function Zi({additionalChildren:e}){const t=oe(),r=he();if(!r.topLevelNavigation)throw Error("Navigation not ready in FireCMSHomePage");const{containerRef:n,scroll:s,direction:i}=qi(),{navigationEntries:l,groups:a}=r.topLevelNavigation,[A,u]=d.useState(null),f=A?l.filter(g=>A.includes(g.url)):l;d.useEffect(()=>{f.forEach(g=>{Wr.addAsync(g.url,`${g.name} ${g.description} ${g.group} ${g.path}`)})},[l]);const h=d.useCallback(g=>{!g||g===""?u(null):Wr.searchAsync(g).then(p=>{u(p)})},[]),b=[...a];(f.filter(g=>!g.group).length>0||f.length===0)&&b.push(void 0);let v;if(t.plugins){const g={context:t};v=o.jsx(o.Fragment,{children:t.plugins.filter(p=>p.homePage?.includeSection).map((p,w)=>{const C=p.homePage.includeSection(g);return o.jsx(ht,{group:C.title,children:C.children},`plugin_section_${p.name}`)})})}return o.jsx(c.Box,{ref:n,sx:{py:2,overflow:"auto",height:"100%",width:"100%"},children:o.jsxs(c.Container,{children:[o.jsx(c.Box,{sx:{position:"sticky",py:2,transition:"top 0.4s ease-in-out",top:0,zIndex:10},children:o.jsx(Di,{onTextSearch:h,placeholder:"Search collections",large:!1})}),o.jsx(wd,{hidden:!!A}),b.map((g,p)=>{const w=[],C={group:g,context:t};t.plugins&&t.plugins.forEach(B=>{B.homePage?.AdditionalCards&&w.push(...$r(B.homePage?.AdditionalCards))});const x=f.filter(B=>B.group===g||!B.group&&g===void 0);return x.length===0&&w.length===0?null:o.jsx(ht,{group:g,children:o.jsxs(c.Grid,{container:!0,spacing:2,children:[x.map(B=>o.jsx(c.Grid,{item:!0,xs:12,sm:6,lg:4,children:o.jsx(Vr,{...B,onClick:()=>{const E=B.type==="collection"?"home_navigate_to_collection":B.type==="view"?"home_navigate_to_view":"unmapped_event";t.onAnalyticsEvent?.(E,{path:B.path})}})},`nav_${B.group}_${B.name}`)),w&&w.map((B,E)=>o.jsx(c.Grid,{item:!0,xs:12,sm:6,lg:4,children:o.jsx(B,{...C})},`nav_${g}_"add_${E}`))]})},`plugin_section_${g}`)}),v,e]})})}function Cd({children:e,title:t,path:r}){const n=Jo();return d.useEffect(()=>{n.set({breadcrumbs:[{title:t,url:r}]})},[r,t]),o.jsx(o.Fragment,{children:e})}function Xi(){return o.jsx(c.Box,{display:"flex",width:"100%",height:"100%",children:o.jsxs(c.Box,{m:"auto",display:"flex",alignItems:"center",flexDirection:"column",children:[o.jsx(c.Typography,{variant:"h4",align:"center",gutterBottom:!0,children:"Page not found"}),o.jsx(c.Typography,{align:"center",gutterBottom:!0,children:"This page does not exist or you may not have access to it"}),o.jsx(c.Button,{component:Ae.Link,to:"/",children:"Back to home"})]})})}function xd({open:e,onAccept:t,onCancel:r,title:n,loading:s,body:i}){return o.jsxs(c.Dialog,{open:e,onClose:r,children:[o.jsx(c.DialogTitle,{children:n}),i&&o.jsx(c.DialogContent,{children:o.jsx(c.DialogContentText,{children:i})}),o.jsxs(je,{children:[o.jsx(c.Button,{onClick:r,autoFocus:!0,children:"Cancel"}),o.jsx(il.LoadingButton,{variant:"contained",color:"primary",type:"submit",loading:s,onClick:t,children:"Ok"})]})]})}function Yr({width:e,height:t,style:r}){return o.jsxs("svg",{width:e??"100%",height:t??"100%",viewBox:"0 0 599 599",version:"1.1",style:r,xmlns:"http://www.w3.org/2000/svg",children:[o.jsxs("defs",{children:[o.jsxs("radialGradient",{cx:"28.6213569%",cy:"43.1133328%",fx:"28.6213569%",fy:"43.1133328%",r:"71.5003456%",gradientTransform:"translate(0.286214,0.431133),rotate(3.343450),scale(1.000000,0.996175),translate(-0.286214,-0.431133)",id:"radialGradient-1",children:[o.jsx("stop",{stopColor:"#FF5B79",offset:"0%"}),o.jsx("stop",{stopColor:"#FA5574",offset:"28.0930803%"}),o.jsx("stop",{stopColor:"#EC4C51",offset:"44.7242531%"}),o.jsx("stop",{stopColor:"#9543C1",offset:"71.4578165%"}),o.jsx("stop",{stopColor:"#3857B3",offset:"100%"})]}),o.jsxs("radialGradient",{cx:"53.6205516%",cy:"47.2473036%",fx:"53.6205516%",fy:"47.2473036%",r:"50.8229649%",gradientTransform:"translate(0.536206,0.472473),rotate(90.000000),scale(1.000000,1.206631),translate(-0.536206,-0.472473)",id:"radialGradient-2",children:[o.jsx("stop",{stopColor:"#68294F",stopOpacity:"0",offset:"0%"}),o.jsx("stop",{stopColor:"#5E2548",stopOpacity:"0.04641108",offset:"75.3503173%"}),o.jsx("stop",{stopColor:"#0D060B",stopOpacity:"0.437431709",offset:"100%"})]}),o.jsxs("radialGradient",{cx:"53.8605015%",cy:"48.1990423%",fx:"53.8605015%",fy:"48.1990423%",r:"59.9151549%",gradientTransform:"translate(0.538605,0.481990),rotate(180.000000),scale(1.000000,0.925027),translate(-0.538605,-0.481990)",id:"radialGradient-3",children:[o.jsx("stop",{stopColor:"#68294F",stopOpacity:"0",offset:"0%"}),o.jsx("stop",{stopColor:"#5E2548",stopOpacity:"0.04641108",offset:"84.0867343%"}),o.jsx("stop",{stopColor:"#FF0000",stopOpacity:"0.567324765",offset:"100%"})]})]}),o.jsx("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:o.jsxs("g",{id:"firecms_logo",children:[o.jsx("circle",{fill:"url(#radialGradient-1)",cx:"299.5",cy:"299.5",r:"299.5"}),o.jsx("circle",{fill:"url(#radialGradient-2)",cx:"299.5",cy:"299.5",r:"299.5"}),o.jsx("circle",{fill:"url(#radialGradient-3)",cx:"299.5",cy:"299.5",r:"299.5"})]})})]})}function pt({children:e,maxWidth:t,fullScreen:r=!1,fadeTimeout:n=800}){return o.jsx(c.Fade,{in:!0,appear:!0,timeout:n,mountOnEnter:!0,unmountOnExit:!0,children:o.jsxs(c.Box,{sx:{display:"flex",flexDirection:"column",alignItems:"center",height:r?"100vh":"100%","@supports (height: 100dvh)":{height:r?"100dvh":"100%"},justifyContent:t?void 0:"center",maxHeight:"100%",gap:2,p:2},children:[t&&o.jsx(c.Box,{sx:{width:"100%",margin:"auto",maxWidth:t},children:e}),!t&&e]})})}function Bd({children:e,mode:t="info"}){const r=c.useTheme(),n=t==="info"?r.palette.mode==="dark"?"#193c47":"#b9f4fe":r.palette.mode==="dark"?"#4d3800":"#f9e3b9";return o.jsx(c.Box,{sx:s=>({my:3,py:1,px:2,borderRadius:1,background:n}),children:e})}function Ki({hovered:e,drawerOpen:t,closeDrawer:r}){const n=oe(),s=he(),i=e&&!t;if(!s.topLevelNavigation)throw Error("Navigation not ready in Drawer");const{navigationEntries:l,groups:a}=s.topLevelNavigation,A=Object.values(l).filter(h=>!h.group),u=d.useCallback(h=>t?o.jsx(c.Box,{pt:2,pl:2,pr:2,pb:.5,sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:o.jsx(c.Typography,{variant:"caption",color:"textSecondary",className:"weight-500",sx:{flexGrow:1},children:h?h.toUpperCase():"Ungrouped views".toUpperCase()})}):o.jsx(c.Box,{sx:{height:16}}),[t]),f=h=>{const b=h.type==="collection"?"drawer_navigate_to_collection":h.type==="view"?"drawer_navigate_to_view":"unmapped_event";n.onAnalyticsEvent?.(b,{url:h.url})};return o.jsxs(c.List,{children:[a.map(h=>o.jsxs(d.Fragment,{children:[u(h),Object.values(l).filter(b=>b.group===h).map((b,v)=>o.jsx(zr,{Icon:At(b.collection??b.view),tooltipsOpen:i,drawerOpen:t,onClick:()=>f(b),url:b.url,name:b.name},`navigation_${v}`))]},`drawer_group_${h}`)),A.length>0&&u(),A.map((h,b)=>o.jsx(zr,{Icon:At(h.collection??h.view),tooltipsOpen:i,onClick:()=>f(h),drawerOpen:t,url:h.url,name:h.name},`navigation_${b}`))]})}function zr({name:e,Icon:t,drawerOpen:r,tooltipsOpen:n,url:s,onClick:i}){const l=c.useTheme(),a=o.jsx(t,{fontSize:"medium",sx:u=>({color:u.palette.mode==="dark"?Yo.grey[500]:Yo.grey[700]})}),A=o.jsxs(c.ListItem,{button:!0,component:Ae.NavLink,onClick:i,style:({isActive:u})=>({fontWeight:u?"600":"500",background:u?l.palette.mode==="light"?c.darken(l.palette.background.default,.1):c.lighten(l.palette.background.default,.08):"inherit",minHeight:"48px",borderRadius:"0 16px 16px 0"}),sx:u=>({pl:3,alignItems:"center"}),to:s,children:[a,o.jsx(c.Typography,{variant:"subtitle2",sx:{opacity:r?1:0,fontWeight:"inherit",ml:3,p:.5},children:e.toUpperCase()})]});return r?A:o.jsx(c.Tooltip,{open:n,placement:"right",title:e,children:A})}const Oo=280,Ri=d.memo(function(t){const{children:r,name:n,logo:s,drawerUrl:i,drawerUrlLabel:l,toolbarExtraWidget:a,Drawer:A,autoOpenDrawer:u,FireCMSAppBarComponent:f=ts}=t,h=c.useTheme(),b=c.useMediaQuery(h.breakpoints.up("md")),v=he(),{containerRef:g}=qi(),[p,w]=d.useState(!1),[C,x]=d.useState(!1),B=d.useCallback(()=>x(!0),[]),E=d.useCallback(()=>x(!1),[]),m=A||Ki,k=d.useCallback(()=>{console.log("handleDrawerClose"),w(!1)},[]),S=p||!!(b&&u&&C);return o.jsxs(c.Box,{sx:{display:"flex",height:"100vh","@supports (height: 100dvh)":{height:"100dvh"},width:"100vw",pt:"env(safe-area-inset-top)",pl:"env(safe-area-inset-left)",pr:"env(safe-area-inset-right)",pb:"env(safe-area-inset-bottom)"},children:[o.jsx(f,{title:n,drawerOpen:S,toolbarExtraWidget:a}),o.jsx(md,{onMouseEnter:B,onMouseMove:B,onMouseLeave:E,open:S,logo:s,drawerUrl:i,drawerUrlLabel:l,hovered:u?C:!1,setDrawerOpen:w,children:o.jsx("nav",{children:v.loading?o.jsx(ro,{}):o.jsx(m,{hovered:C,drawerOpen:S,closeDrawer:k})})}),o.jsxs(c.Box,{component:"main",sx:{display:"flex",flexDirection:"column",flexGrow:1,width:"100%",height:"100%",overflow:"auto"},children:[o.jsx(Ed,{}),o.jsx(c.Box,{ref:g,sx:{flexGrow:1,m:b?2:0,mt:b?0:1,borderRadius:b?"12px":void 0,border:b?`1px solid ${h.palette.divider}`:void 0,height:"100%",overflow:"auto"},children:o.jsx(ne,{children:r})})]})]})},le),Ed=ge.styled("div")(({theme:e})=>({display:"flex",flexDirection:"column",...e.mixins.toolbar}));function md(e){const t=oe(),r=c.useTheme(),n=c.useMediaQuery(r.breakpoints.up("md")),{open:s,logo:i,setDrawerOpen:l,drawerUrl:a="https://firecms.co/?utm_source=drawer",drawerUrlLabel:A="firecms.co",hovered:u,...f}=e;let h;i?h=o.jsx("img",{style:{maxWidth:"100%",maxHeight:"100%"},src:i,alt:"Logo"}):h=o.jsx(Yr,{});const b=o.jsx(cn,{color:"inherit","aria-label":"Open drawer",edge:"start",onClick:()=>l(!0),size:"large",sx:{position:"absolute",top:8,left:24},children:o.jsx(hl,{})});return o.jsxs(o.Fragment,{children:[!n&&b,o.jsxs(c.Drawer,{...f,variant:n?"permanent":"temporary",open:s,onClose:n?void 0:()=>{l(!1)},sx:{width:Oo,flexShrink:0,height:"100%",whiteSpace:"nowrap",boxSizing:"border-box",border:"none",...s&&{...es(r),"& .MuiDrawer-paper":es(r)},...!s&&{...os(r,n),"& .MuiDrawer-paper":os(r,n)}},children:[o.jsx(cn,{onClick:()=>l(!1),sx:{position:"absolute",right:16,top:16,opacity:s?1:0,transition:r.transitions.create("opacity",{easing:r.transitions.easing.sharp,duration:r.transitions.duration.enteringScreen})},children:r.direction==="rtl"?o.jsx(bl,{}):o.jsx(pl,{})}),o.jsx(c.Toolbar,{sx:{position:"absolute",left:s?"-100%":0,right:s?void 0:0,opacity:s?0:1,backgroundColor:r.palette.background.default,transition:r.transitions.create(["left","opacity"],{easing:r.transitions.easing.sharp,duration:r.transitions.duration.enteringScreen})},children:s?b:o.jsx(c.Tooltip,{title:"Open menu",placement:"right",children:b})}),o.jsxs(c.Box,{sx:{height:"100%",width:"100%",overflow:"auto"},children:[o.jsx(c.Link,{color:"inherit",component:Ae.NavLink,to:".",sx:v=>({display:"block",transition:v.transitions.create(["padding"],{easing:v.transitions.easing.sharp,duration:v.transitions.duration.enteringScreen}),p:v.spacing(s?4:9,s?12:2,0,s?3:2)}),children:o.jsx(c.Tooltip,{title:"Home",placement:"right",children:o.jsx("div",{onClick:()=>{t.onAnalyticsEvent?.("drawer_navigate_to_home")},children:h})})},"breadcrumb-home"),e.children]}),o.jsxs(c.Link,{sx:v=>({width:Oo,position:"fixed",bottom:0,left:s?0:"-100%",opacity:s?1:0,transition:v.transitions.create(["left","opacity"],{easing:v.transitions.easing.sharp,duration:v.transitions.duration.enteringScreen}),px:"24px",py:1,display:"flex",alignItems:"center",fontWeight:v.typography.fontWeightMedium,background:v.palette.mode==="light"?"rgba(255,255,255,0.6)":c.alpha(v.palette.background.paper,.1),backdropFilter:"blur(8px)"}),href:a,onMouseDown:v=>{v.preventDefault()},target:"_blank",children:[o.jsx(xo,{style:{marginRight:"24px"},fontSize:"small"}),A]})]})]})}const es=e=>({willChange:"width",pb:"32px",width:Oo,border:"none",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),backgroundColor:e.palette.background.default,overflowX:"hidden"}),os=(e,t)=>({willChange:"width",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),border:"none",overflowX:"hidden",backgroundColor:e.palette.background.default,width:t?`calc(${e.spacing(9)})`:"0px"}),ts=function({title:t,toolbarExtraWidget:r,drawerOpen:n}){const s=Jo(),{breadcrumbs:i}=s,l=Je(),{mode:a,toggleMode:A}=jo(),u=c.useTheme(),f=c.useMediaQuery(u.breakpoints.up("md")),h=l.user?.displayName?l.user.displayName[0].toUpperCase():l.user?.email?l.user.email[0].toUpperCase():"A";return o.jsx(c.Box,{sx:{position:"fixed",marginLeft:u.spacing(8),width:`calc(100% - ${u.spacing(8)})`,zIndex:f?u.zIndex.drawer+1:void 0,transition:u.transitions.create(["width","margin"],{easing:u.transitions.easing.sharp,duration:u.transitions.duration.leavingScreen}),...n&&f&&{marginLeft:`calc(${Oo}px - 8px)`,width:`calc(100% - ${Oo}px)`,transition:u.transitions.create(["width","margin"],{easing:u.transitions.easing.sharp,duration:u.transitions.duration.enteringScreen})}},children:o.jsx(c.Slide,{direction:"down",in:!0,mountOnEnter:!0,unmountOnExit:!0,children:o.jsxs(c.Toolbar,{sx:{gap:1},children:[o.jsx(c.Hidden,{lgDown:!0,children:o.jsx(c.Box,{mr:2,children:o.jsx(c.Link,{underline:"none",color:"inherit",component:Ae.Link,to:".",children:o.jsx(c.Typography,{variant:"h6",noWrap:!0,className:"weight-500",children:t})},"breadcrumb-home")})}),f&&o.jsx(c.Box,{children:o.jsx(c.Breadcrumbs,{separator:o.jsx(al,{htmlColor:"rgb(0,0,0,0.87)",fontSize:"small"}),"aria-label":"breadcrumb",children:i.map((b,v)=>o.jsx(c.Link,{underline:"none",color:"inherit",component:Ae.Link,to:b.url,children:o.jsx(c.Chip,{sx:g=>({backgroundColor:g.palette.grey[200],height:g.spacing(3),color:g.palette.grey[800],fontWeight:g.typography.fontWeightMedium,"&:hover, &:focus":{cursor:"pointer",backgroundColor:g.palette.grey[300]},"&:active":{boxShadow:g.shadows[1],backgroundColor:g.palette.grey[400]}}),label:b.title})},`breadcrumb-${v}`))})}),o.jsx(c.Box,{flexGrow:1}),r&&o.jsx(ne,{children:r}),o.jsx(c.Box,{p:1,children:o.jsx(c.IconButton,{color:"inherit","aria-label":"Open drawer",edge:"start",onClick:()=>A(),size:"large",children:a==="dark"?o.jsx(ll,{}):o.jsx(sl,{})})}),o.jsx(c.Box,{p:1,children:l.user&&l.user.photoURL?o.jsx(c.Avatar,{src:l.user.photoURL}):o.jsx(c.Avatar,{children:h})}),o.jsx(c.Button,{variant:"text",color:"inherit",onClick:l.signOut,children:"Log Out"})]})})})};function kd(){const e=c.useTheme();return c.useMediaQuery(e.breakpoints.up("xl"))}const Sd=d.memo(function({path:t,entityId:r,selectedSubPath:n,copy:s,collection:i,onValuesAreModified:l,formWidth:a,onUpdate:A,onClose:u}){const f=c.useTheme(),h=kd(),b=d.useRef(!h),v=typeof a=="number"?`${a}px`:a??Ho,g=Se(),p=gt(),w=Ne(),C=He(),x=oe(),B=Je(),[E,m]=d.useState(void 0),[k,S]=d.useState(s?"copy":r?"existing":"new"),F=d.useRef(void 0),I=F.current,T=(i.subcollections??[]).filter(U=>!U.hideFromNavigation),P=T?.length??0,M=i.views,L=M?.length??0,W=d.useCallback(U=>{if(M){const ae=M.map(ce=>ce.path).findIndex(ce=>ce===U);if(ae!==-1)return ae}if(T){const ae=T.map(ce=>ce.path).findIndex(ce=>ce===U);if(ae!==-1)return ae+L}return-1},[M,L,T]),$=L>0||P>0,Z=n??i.defaultSelectedView,[z,J]=d.useState(Z?W(Z):-1),O=z===-1||h,{entity:D,dataLoading:Q,dataLoadingError:j}=_o({path:t,entityId:r,collection:i,useCache:!1}),[V,re]=d.useState(r),[G,_]=d.useState(D),[N,R]=d.useState(void 0);d.useEffect(()=>{D&&_(D)},[D]),d.useEffect(()=>{if(k==="new")R(!1);else{const U=G?xr(i,B,We(t),G??null):!1;G&&R(!U)}},[B,G,k]),d.useEffect(()=>{b.current!==h&&(n!==Z&&w.replace({path:t,entityId:r,selectedSubPath:Z,updateUrl:!0}),b.current=h)},[Z,h,n]);const Y=d.useCallback(U=>{C.open({type:"error",message:"Error before saving: "+U?.message}),console.error(U)},[C]),te=d.useCallback(U=>{C.open({type:"error",message:"Error after saving (entity is saved): "+U?.message}),console.error(U)},[C]),ee=(U,ae)=>{C.open({type:"success",message:`${i.singularName??i.name}: Saved correctly`}),_(U),S("existing"),l(!1),A&&A({entity:U}),ae?(p.setBlocked(!1),p.close(!0),u?.()):w.replace({path:t,entityId:U.id,selectedSubPath:n,updateUrl:!0})},H=d.useCallback(U=>{C.open({type:"error",message:"Error saving: "+U?.message}),console.error("Error saving entity",t,r),console.error(U)},[r,t,C]),Ye=d.useCallback(async({collection:U,path:ae,entityId:ce,values:$o,previousValues:xt,closeAfterSave:Bt})=>{if(k)return Wt({path:ae,entityId:ce,values:$o,previousValues:xt,collection:U,status:k,dataSource:g,context:x,onSaveSuccess:Et=>ee(Et,Bt),onSaveFailure:H,onPreSaveHookError:Y,onSaveSuccessHookError:te})},[k,i,g,x,ee,H,Y,te]),bo=M&&M.map((U,ae)=>{if(z!==ae)return null;U.Builder&&console.warn("customView.builder is deprecated, use customView.Builder instead",U);const ce=U.Builder??U.builder;return ce?o.jsx(c.Box,{sx:{width:No,height:"100%",overflow:"auto",borderLeft:`1px solid ${f.palette.divider}`,[f.breakpoints.down("lg")]:{borderLeft:"inherit",width:mo}},role:"tabpanel",flexGrow:1,children:o.jsx(ne,{children:o.jsx(ce,{collection:i,entity:G,modifiedValues:I??G?.values})})},`custom_view_${U.path}`):(console.error("customView.Builder is not defined"),null)}).filter(Boolean),ze=Q&&!G||(!G||N===void 0)&&(k==="existing"||k==="copy"),vo=T&&T.map((U,ae)=>{const ce=G?`${t}/${G?.id}/${be(U.alias??U.path)}`:void 0;return z!==ae+L?null:o.jsxs(c.Box,{sx:{width:No,height:"100%",overflow:"auto",borderLeft:`1px solid ${f.palette.divider}`,[f.breakpoints.down("lg")]:{borderLeft:"inherit",width:mo}},role:"tabpanel",flexGrow:1,children:[ze&&o.jsx(ro,{}),!ze&&(G&&ce?o.jsx(Or,{fullPath:ce,isSubCollection:!0,...U}):o.jsx(c.Box,{sx:{width:"100%",height:"100%",p:3},display:"flex",alignItems:"center",justifyContent:"center",children:o.jsx(c.Typography,{variant:"label",children:"You need to save your entity before adding additional collections"})}))]},`subcol_${U.alias??U.path}`)}).filter(Boolean),yt=d.useCallback(U=>{if(U!==-1){if(M&&U<L)return M[U].path;if(T)return T[U-L].path;throw Error("Something is wrong in getSelectedSubPath")}},[L]),Ue=d.useCallback(()=>{l(!1)},[]),wt=d.useCallback(U=>{J(U),r&&w.replace({path:t,entityId:r,selectedSubPath:yt(U),updateUrl:!0})},[r,w,t,yt]),Ct=d.useCallback(U=>{F.current=U},[]),Nr=d.useCallback(U=>{_(ae=>ae?{...ae,id:U}:void 0),re(U)},[]);function Hr(){const U=x.plugins;let ae=o.jsx(Ci,{status:k,path:t,collection:i,onEntitySave:Ye,onDiscard:Ue,onValuesChanged:Ct,onModified:l,entity:G,onIdChange:Nr,onFormContextChange:m,hideId:i.hideIdFromForm});return U&&U.forEach(ce=>{ce.form?.provider&&(ae=o.jsx(ce.form.provider.Component,{status:k,path:t,collection:i,onEntitySave:Ye,onDiscard:Ue,onValuesChanged:Ct,onModified:l,entity:G,context:x,currentEntityId:V,formContext:E,...ce.form.provider.props,children:ae}))}),o.jsx(ne,{children:ae})}const _r=N===void 0?o.jsx(o.Fragment,{}):N?o.jsx(kr,{entity:G,path:t,collection:i}):Hr(),jr=T&&T.map(U=>o.jsx(c.Tab,{sx:{fontSize:"0.875rem",minWidth:"140px"},wrapped:!0,label:U.name},`entity_detail_collection_tab_${U.name}`)),yo=M&&M.map(U=>o.jsx(c.Tab,{sx:{fontSize:"0.875rem",minWidth:"140px"},wrapped:!0,label:U.name},`entity_detail_custom_tab_${U.name}`)),Jr=o.jsxs(c.Box,{sx:{paddingLeft:2,paddingRight:2,paddingTop:1,display:"flex",alignItems:"end",backgroundColor:f.palette.mode==="light"?f.palette.background.default:f.palette.background.paper},children:[o.jsx(c.Box,{sx:{pb:1,alignSelf:"center"},children:o.jsx(c.IconButton,{onClick:()=>(u?.(),p.close(!1)),size:"large",children:o.jsx(Is,{})})}),o.jsx(c.Box,{flexGrow:1}),ze&&o.jsx(c.Box,{sx:{alignSelf:"center"},children:o.jsx(c.CircularProgress,{size:16,thickness:8})}),o.jsxs(c.Tabs,{value:z+1,indicatorColor:"secondary",textColor:"inherit",onChange:(U,ae)=>{wt(ae-1)},sx:{paddingLeft:f.spacing(1),paddingRight:f.spacing(1),paddingTop:f.spacing(0)},variant:"scrollable",scrollButtons:"auto",children:[o.jsx(c.Tab,{label:i.singularName??i.name,disabled:!$,onClick:()=>{wt(-1)},sx:{display:$?void 0:"none",fontSize:"0.875rem",minWidth:"140px"},wrapped:!0}),yo,jr]})]});return o.jsx(c.Box,{sx:{display:"flex",flexDirection:"column",height:"100%",width:"100%",transition:"width 250ms ease-in-out"},children:o.jsxs(o.Fragment,{children:[Jr,o.jsx(c.Divider,{}),o.jsxs(c.Box,{sx:{flexGrow:1,height:"100%",width:`calc(${No} + ${v})`,maxWidth:"100%",[`@media (max-width: ${v})`]:{width:v},display:"flex",overflow:"auto",flexDirection:"row"},children:[o.jsx(c.Box,{sx:{position:"relative",maxWidth:"100%"},children:o.jsx(c.Box,{role:"tabpanel",hidden:!O,id:`form_${t}`,sx:{width:v,maxWidth:"100%",height:"100%",overflow:"auto",[f.breakpoints.down("sm")]:{maxWidth:mo,width:mo}},children:ze?o.jsx(ro,{}):_r})}),bo,vo]})]})})},le);function Fd(e){const{blocked:t,setBlocked:r,setBlockedNavigationMessage:n}=gt(),s=he(),i=d.useMemo(()=>{if(!e)return;let a=e.collection;if(!a&&(a=e?s.getCollection(e.path,e.entityId):void 0,!a))throw console.error("ERROR: No collection found in path `",e.path,"`. Entity id: ",e.entityId),Error("ERROR: No collection found in path `"+e.path+"`. Make sure you have defined a collection for this path in the root navigation.");return a},[s,e]);d.useEffect(()=>{function a(A){t&&i&&(A.preventDefault(),A.returnValue=`You have unsaved changes in this ${i.name}. Are you sure you want to leave this page?`)}return typeof window<"u"&&window.addEventListener("beforeunload",a),()=>{typeof window<"u"&&window.removeEventListener("beforeunload",a)}},[t,i]);const l=d.useCallback(a=>{r(a),n(a?o.jsxs(o.Fragment,{children:[" You have unsaved changes in this ",o.jsx("b",{children:i?.name}),"."]}):void 0)},[i?.name,r,n]);return!e||!i?o.jsx("div",{style:{width:Ho}}):o.jsx(o.Fragment,{children:o.jsx(ne,{children:o.jsx(Sd,{...e,formWidth:e.width,collection:i,onValuesAreModified:l})})})}const rs="new";function Id(e,t){if(t)return mo;const r=!e.selectedSubPath,n=typeof e.width=="number"?`${e.width}px`:e.width;return r?n??Ho:`calc(${No} + ${n??Ho})`}const Td=(e,t)=>{const r=Ae.useLocation(),n=d.useRef(!1),s=c.useTheme(),i=c.useMediaQuery(s.breakpoints.down("sm"));d.useEffect(()=>{if(!e.loading&&!n.current){if(e.isUrlCollectionPath(r.pathname)){const u=r.hash===`#${rs}`,f=e.urlPathToDataPath(r.pathname),h=Dd(f,e.collections,u);t.replace(h.map(b=>Ur(b,e,i)))}n.current=!0}},[r,e,t,i]);const l=d.useCallback(()=>{t.close()},[t]),a=d.useCallback(u=>{if(u.copy&&!u.entityId)throw Error("If you want to copy an entity you need to provide an entityId");const f=u.collection?u.collection.defaultSelectedView:void 0;t.open(Ur({selectedSubPath:f,...u},e,i))},[t,e,i]),A=d.useCallback(u=>{if(u.copy&&!u.entityId)throw Error("If you want to copy an entity you need to provide an entityId");t.replace(Ur(u,e,i))},[e,t,i]);return{close:l,open:a,replace:A}};function Dd(e,t,r){const n=Gt({path:e,collections:t}),s=[];let i="";for(let l=0;l<n.length;l++){const a=n[l];if(a.type==="collection"&&(i=a.path),l>0){const A=n[l-1];if(a.type==="entity")s.push({path:a.path,entityId:a.entityId,copy:!1});else if(a.type==="custom_view"){if(A.type==="entity"){const u=s[s.length-1];u&&(u.selectedSubPath=a.view.path)}}else if(a.type==="collection"&&A.type==="entity"){const u=s[s.length-1];u&&(u.selectedSubPath=a.collection.alias??a.collection.path)}}}return r&&s.push({path:i,copy:!1}),s}const Ur=(e,t,r)=>{const n=be(e.path),s=e.entityId?t.buildUrlCollectionPath(`${n}/${e.entityId}/${e.selectedSubPath||""}`):t.buildUrlCollectionPath(`${n}#${rs}`);return{key:`${e.path}/${e.entityId}`,component:o.jsx(Fd,{...e}),urlPath:s,parentUrlPath:t.buildUrlCollectionPath(n),width:Id(e,r),onClose:e.onClose}};function Pd({basePath:e,baseCollectionPath:t,authController:r,collections:n,views:s,collectionOverrideHandler:i,userConfigPersistence:l,plugins:a,dataSource:A}){const u=Ae.useLocation(),[f,h]=d.useState(),[b,v]=d.useState(),[g,p]=d.useState(!1),[w,C]=d.useState(void 0),[x,B]=d.useState(!0),[E,m]=d.useState(void 0),k=be(e),S=be(t),F=k?`/${k}`:"/",I=k?`/${k}/${S}`:`/${S}`,T=d.useCallback(Q=>k?`/${k}/${bt(Q)}`:`/${bt(Q)}`,[k]),P=d.useCallback(Q=>`${be(t)}/${bt(Q)}`,[t]),M=d.useCallback((Q,j)=>{const V=[...(Q??[]).map(G=>G.hideFromNavigation?void 0:{url:P(G.alias??G.path),type:"collection",name:G.name.trim(),path:G.alias??G.path,collection:G,description:G.description?.trim(),group:G.group?.trim()}).filter(Boolean),...(j??[]).map(G=>G.hideFromNavigation?void 0:{url:T(Array.isArray(G.path)?G.path[0]:G.path),name:G.name.trim(),type:"view",view:G,description:G.description?.trim(),group:G.group?.trim()}).filter(Boolean)],re=Object.values(V).map(G=>G.group).filter(Boolean).filter((G,_,N)=>N.indexOf(G)===_);return{navigationEntries:V,groups:re}},[T,P]),L=d.useCallback(async()=>{try{const[Q=[],j=[]]=await Promise.all([Md(n,r,A,a),Qd(s,r,A)]);h(Q),v(j),C(M(Q??[],j))}catch(Q){console.error(Q),m(Q)}B(!1),p(!0)},[n,r.user,A,a,s,M]);d.useEffect(()=>{L()},[L]);const W=d.useCallback((Q,j,V=!1)=>{if(!f)return;const re=Uo(be(Q),f),G=V?l?.getCollectionConfig(Q):void 0,_=re?Le(re,G):void 0;let N=_;const R=i&&i({entityId:j,path:be(Q)});if(R&&(N=R),_){const Y=_.subcollections,te=_.callbacks,ee=_.permissions;N={...N,subcollections:N?.subcollections??Y,callbacks:N?.callbacks??te,permissions:N?.permissions??ee}}if(N)return{..._,...N}},[e,t,f,i]),$=d.useCallback(Q=>be(Q+"/").startsWith(be(I)+"/"),[I]),Z=d.useCallback(Q=>{if(Q.startsWith(I))return Q.replace(I,"");throw Error("Expected path starting with "+I)},[I]),z=d.useCallback(({path:Q})=>`s/edit/${bt(Q)}`,[]),J=d.useCallback(Q=>{if(!f)throw Error("Collections have not been initialised yet");return Lt(Q,f)},[f]),O=u.state,D=O&&O.base_location?O.base_location:u;return{collections:f??[],views:b??[],loading:!g||x,navigationLoadingError:E,homeUrl:F,basePath:e,baseCollectionPath:t,initialised:g,getCollection:W,isUrlCollectionPath:$,urlPathToDataPath:Z,buildUrlCollectionPath:P,buildUrlEditCollectionPath:z,buildCMSUrlPath:T,resolveAliasesFrom:J,topLevelNavigation:w,baseLocation:D,refreshNavigation:L}}function bt(e){return encodeURIComponent(be(e)).replaceAll("%2F","/").replaceAll("%23","#")}function ns(e,t){return e.filter(r=>r.permissions?Lo(r,t,[r.path],null).read!==!1:!0).map(r=>r.subcollections?{...r,subcollections:ns(r.subcollections,t)}:r)}async function Md(e,t,r,n){let s=[];return typeof e=="function"?s=await e({user:t.user,authController:t,dataSource:r}):Array.isArray(e)&&(s=e),s=ns(s,t),n&&n.forEach(i=>{i.collections?.injectCollections&&(s=i.collections?.injectCollections(s??[]))}),s}async function Qd(e,t,r){let n=[];return typeof e=="function"?n=await e({user:t.user,authController:t,dataSource:r}):Array.isArray(e)&&(n=e),n}function Ld(){const e=Ae.useLocation(),t=Ae.useNavigate(),[r,n]=d.useState([]),s=d.useRef(r),i=d.useRef({}),l=d.useRef(0),a=h=>{s.current=h,n(h)};d.useEffect(()=>{const v=(e.state?.panels??[]).map(g=>i.current[g]).filter(g=>!!g);le(s.current.map(g=>g.key),v.map(g=>g.key))||a(v)},[e]);const A=d.useCallback(()=>{if(r.length===0)return;const h=r[r.length-1],b=[...r.slice(0,-1)];if(a(b),l.current>0)h.urlPath&&t(-1),l.current--;else if(h.parentUrlPath){const v=e.state?.base_location??e;t(h.parentUrlPath,{replace:!0,state:{base_location:v,panels:b.map(g=>g.key)}})}},[r,t,e]),u=d.useCallback(h=>{const b=Array.isArray(h)?h:[h];b.forEach(p=>{i.current[p.key]=p}),l.current=l.current+b.length;const v=e.state?.base_location??e,g=[...r,...b];a(g),b.forEach(p=>{p.urlPath&&t(p.urlPath,{state:{base_location:v,panels:g.map(w=>w.key)}})})},[e,t,r]),f=d.useCallback(h=>{const b=Array.isArray(h)?h:[h];b.forEach(p=>{i.current[p.key]=p});const v=e.state?.base_location??e,g=[...r.slice(0,-b.length),...b];a(g),b.forEach(p=>{p.urlPath&&t(p.urlPath,{replace:!0,state:{base_location:v,panels:g.map(w=>w.key)}})})},[e,t,r]);return{sidePanels:r,close:A,open:u,replace:f}}const Od="/c";function is(e){const t=jo(),{children:r,collections:n,views:s,entityLinkBuilder:i,userConfigPersistence:l,dateTimeFormat:a,locale:A,authController:u,collectionOverrideHandler:f,storageSource:h,dataSource:b,basePath:v,baseCollectionPath:g,plugins:p,onAnalyticsEvent:w,fields:C}=e,x=v??"/",B=g??Od,E=A?un[A]:void 0,m=Pd({basePath:x,baseCollectionPath:B,authController:u,collections:n,views:s,collectionOverrideHandler:f,userConfigPersistence:l,dataSource:b,plugins:p}),k=Ld(),S=Td(m,k),F=u.initialLoading||m.loading||(p?.some(T=>T.loading)??!1);if(m.navigationLoadingError)return o.jsx(pt,{maxWidth:300,fullScreen:!0,children:o.jsx(ue,{title:"Error loading navigation",error:m.navigationLoadingError})});if(u.authError)return o.jsx(pt,{maxWidth:300,fullScreen:!0,children:o.jsx(ue,{title:"Error loading auth",error:u.authError})});const I={entityLinkBuilder:i,dateTimeFormat:a,locale:A,plugins:p,onAnalyticsEvent:w,fields:C};return o.jsx(Qt.Provider,{value:t,children:o.jsx($t.Provider,{value:I,children:o.jsx(Bn.Provider,{value:l,children:o.jsx(xn.Provider,{value:h,children:o.jsx(bn.Provider,{value:b,children:o.jsx(yn.Provider,{value:u,children:o.jsx(wn.Provider,{value:k,children:o.jsx(Cn.Provider,{value:S,children:o.jsx(vn.Provider,{value:m,children:o.jsx(Pl,{children:o.jsx(ks.LocalizationProvider,{dateAdapter:ms.AdapterDateFns,utils:Ss,locale:E,children:o.jsx(Gd,{loading:F,children:r})})})})})})})})})})})})}function Gd({loading:e,children:t}){const r=oe();let n=t({context:r,loading:e});const s=r.plugins;return!e&&s&&s.forEach(i=>{i.provider&&(n=o.jsx(i.provider.Component,{...i.provider.props,context:r,children:n}))}),o.jsx(o.Fragment,{children:n})}const ss=({mode:e,primaryColor:t,secondaryColor:r,fontFamily:n,headersFontFamily:s})=>{c.createTheme();const l=c.createTheme({palette:{mode:e,background:{default:e==="dark"?"#202024":"#f8f8fa",paper:e==="dark"?"#121215":"#ffffff"},primary:{main:t||"#0070f4"},secondary:{main:r||Yo.pink[400]},error:{main:Yo.red.A400}},shape:{borderRadius:6},typography:{fontFamily:n||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontWeightMedium:500,h6:{fontFamily:n||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontSize:"1.15rem",fontWeight:500},h5:{fontFamily:n||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontSize:"1.55rem"},h4:{fontFamily:n||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontSize:"2rem",fontWeight:500},h3:{fontFamily:n||"'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontWeight:600},h2:{fontFamily:s||"'IBM Plex Mono', 'Space Mono', 'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontWeight:600},h1:{fontFamily:s||"'IBM Plex Mono', 'Space Mono', 'Rubik', 'Roboto', 'Helvetica', 'Arial', sans-serif",fontWeight:600},label:{display:"block",color:"#838383",fontWeight:500,fontSize:"0.875rem",lineHeight:1.43}},components:{MuiSkeleton:{styleOverrides:{root:{borderRadius:6}}},MuiButton:{styleOverrides:{root:{borderRadius:6}}},MuiLoadingButton:{styleOverrides:{root:{borderRadius:6}}},MuiTableRow:{styleOverrides:{root:{"&:last-child td":{borderBottom:0}}}},MuiTypography:{styleOverrides:{root:{"&.mono":{fontFamily:"'IBM Plex Mono', 'Space Mono', monospace, 'Lucida Console'"},"&.weight-500":{fontWeight:500}}}},MuiInputBase:{styleOverrides:{root:{"&.mono":{fontFamily:"'IBM Plex Mono', 'Space Mono', 'Lucida Console', monospace"},"& input::-webkit-outer-spin-button, & input::-webkit-inner-spin-button":{display:"none"},"& input[type=number]":{MozAppearance:"textfield"}}}},MuiDialog:{styleOverrides:{paper:{backgroundImage:"inherit"}}},MuiCardActionArea:{styleOverrides:{root:{borderRadius:6}}}}});return{...l,shadows:l.shadows.map((a,A)=>A===3?"0px 0px 0px 0px rgba(0,0,0,0.18), 0px 0px 10px 0px rgba(0,0,0,0.12), 0px 0px 14px 2px rgba(0,0,0,0.10)":a)}},ls=d.memo(function({HomePage:t=Zi,customRoutes:r}){const n=Ae.useLocation(),s=he(),l=oe().plugins??[];if(!s)return o.jsx(o.Fragment,{});const a=n.state,A=a&&a.base_location?a.base_location:n,u=[];s.views&&s.views.forEach(g=>{Array.isArray(g.path)?u.push(...g.path.map(p=>as(p,g))):u.push(as(g.path,g))});const h=[...s.collections??[]].sort((g,p)=>p.path.length-g.path.length).map(g=>{const p=s.buildUrlCollectionPath(g.alias??g.path),w=[];return l&&l.forEach(C=>{C.collections?.CollectionActions&&w.push(...$r(C.collections?.CollectionActions))}),w.push(...$r(g.Actions)),o.jsx(Ae.Route,{path:p+"/*",element:o.jsx(vt,{path:p,title:g.name,type:"collection",children:o.jsx(Or,{isSubCollection:!1,fullPath:g.alias??g.path,...g,Actions:w},`collection_view_${g.alias??g.path}`)})},`navigation_${g.alias??g.path}`)}),b=o.jsx(Ae.Route,{path:"/",element:o.jsx(vt,{path:s.homeUrl,title:"Home",type:"home",children:o.jsx(t,{})},"navigation_home")}),v=o.jsx(Ae.Route,{path:"*",element:o.jsx(Xi,{})});return o.jsxs(Ae.Routes,{location:A,children:[h,u,b,v,r]})}),as=(e,t)=>o.jsx(Ae.Route,{path:e,element:o.jsx(vt,{path:e,title:t.name,type:"view",children:t.view},`navigation_${e}`)},"navigation_view_"+e),vt=d.memo(function({children:t,title:r,path:n,type:s}){const i=Jo();return d.useEffect(()=>{i.set({breadcrumbs:[{title:r,url:n}]})},[n,r]),o.jsx(o.Fragment,{children:t})},le);function $d(e){return e}function Vd(e){return e}function Wd(e){return e}function Yd(e){return e}function zd(e){return e}function Ud(e){return e}function Nd(e){return e}function Hd(e){return e}function _d(e){return e}function cs(){const e=c.useMediaQuery("(prefers-color-scheme: dark)"),r=(localStorage.getItem("prefers-dark-mode")!=null?localStorage.getItem("prefers-dark-mode")==="true":null)??e,[n,s]=d.useState(r?"dark":"light");d.useEffect(()=>{s(r?"dark":"light"),a(r?"dark":"light")},[r]);const i=d.useCallback(()=>{s("dark"),a("dark")},[e]),l=d.useCallback(()=>{s("light"),a("light")},[]),a=d.useCallback(u=>{document.body.style.setProperty("color-scheme",u)},[document]),A=d.useCallback(()=>{n==="light"?(e?localStorage.removeItem("prefers-dark-mode"):localStorage.setItem("prefers-dark-mode","true"),i()):(e?localStorage.setItem("prefers-dark-mode","false"):localStorage.removeItem("prefers-dark-mode"),l())},[n,e]);return{mode:n,setMode:s,toggleMode:A}}function ds(){const[e,t]=d.useState({}),r=d.useCallback(g=>{const p=localStorage.getItem(g);return p?JSON.parse(p):{}},[]),n=d.useCallback(g=>{const p=`collection_config::${sr(g)}`;return e[p]?e[p]:r(p)},[e,r]),s=d.useCallback((g,p)=>{const w=`collection_config::${sr(g)}`;localStorage.setItem(w,JSON.stringify(p)),t(C=>{const x=C[w],B=Le(x??r(g),p);return Le(C,B)})},[r]),[i,l]=d.useState([]),[a,A]=d.useState([]),[u,f]=d.useState([]);d.useEffect(()=>{l(localStorage.getItem("recently_visited_paths")?JSON.parse(localStorage.getItem("recently_visited_paths")):[]),A(localStorage.getItem("favourite_paths")?JSON.parse(localStorage.getItem("favourite_paths")):[]),f(localStorage.getItem("collapsed_groups")?JSON.parse(localStorage.getItem("collapsed_groups")):[])},[]);const h=d.useCallback(g=>{localStorage.setItem("recently_visited_paths",JSON.stringify(g)),l(g)},[]),b=d.useCallback(g=>{localStorage.setItem("favourite_paths",JSON.stringify(g)),A(g)},[]),v=d.useCallback(g=>{localStorage.setItem("collapsed_groups",JSON.stringify(g)),f(g)},[]);return{onCollectionModified:s,getCollectionConfig:n,recentlyVisitedPaths:i,setRecentlyVisitedPaths:h,favouritePaths:a,setFavouritePaths:b,collapsedGroups:u,setCollapsedGroups:v}}const As=({children:e,maxSnack:t=3,autoHideDuration:r=3500})=>o.jsx(qr.SnackbarProvider,{maxSnack:t,autoHideDuration:r,children:e}),us=({firebaseApp:e,signInOptions:t})=>{const[r,n]=d.useState(void 0),[s,i]=d.useState(),[l,a]=d.useState(),[A,u]=d.useState(!0),[f,h]=d.useState(!0),[b,v]=d.useState(!1),[g,p]=d.useState(),[w,C]=d.useState();d.useEffect(()=>{if(e)try{const O=K.getAuth(e);return i(void 0),n(O.currentUser),K.onAuthStateChanged(O,B,D=>a(D))}catch(O){return i(O),()=>{}}},[e]);const x=d.useCallback(()=>{v(!0),n(null)},[]),B=d.useCallback(async O=>{n(O),u(!1),h(!1)},[]),E=d.useCallback(()=>{const O=K.getAuth(e);K.signOut(O).then(D=>{n(null),a(null)}),v(!1)},[e]),m=d.useCallback(O=>t.find(D=>{if(D===null)throw Error("useFirebaseAuthController");if(typeof D=="object"&&D.provider===O)return D}),[t]),k=d.useCallback(()=>{const O=new K.GoogleAuthProvider,D=m("google.com");D?.scopes&&D.scopes.forEach(j=>O.addScope(j)),D?.customParameters&&O.setCustomParameters(D.customParameters);const Q=K.getAuth();K.signInWithPopup(Q,O).catch(a)},[m]),S=d.useCallback((O,D)=>{h(!0),K.signInWithPopup(O,D).catch(a).then(()=>h(!1))},[]),F=d.useCallback(()=>{const O=K.getAuth();h(!0),K.signInAnonymously(O).catch(a).then(()=>h(!1))},[]),I=d.useCallback((O,D)=>{const Q=K.getAuth();return h(!0),K.signInWithPhoneNumber(Q,O,D).catch(a).then(j=>{h(!1),p(j??void 0)})},[]),T=d.useCallback(()=>{const O=new K.OAuthProvider("apple.com"),D=m("apple.com");D?.scopes&&D.scopes.forEach(j=>O.addScope(j)),D?.customParameters&&O.setCustomParameters(D.customParameters);const Q=K.getAuth();S(Q,O)},[S,m]),P=d.useCallback(()=>{const O=new K.FacebookAuthProvider,D=m("facebook.com");D?.scopes&&D.scopes.forEach(j=>O.addScope(j)),D?.customParameters&&O.setCustomParameters(D.customParameters);const Q=K.getAuth();S(Q,O)},[S,m]),M=d.useCallback(()=>{const O=new K.GithubAuthProvider,D=m("github.com");D?.scopes&&D.scopes.forEach(j=>O.addScope(j)),D?.customParameters&&O.setCustomParameters(D.customParameters);const Q=K.getAuth();S(Q,O)},[S,m]),L=d.useCallback(()=>{const O=new K.OAuthProvider("microsoft.com"),D=m("microsoft.com");D?.scopes&&D.scopes.forEach(j=>O.addScope(j)),D?.customParameters&&O.setCustomParameters(D.customParameters);const Q=K.getAuth();S(Q,O)},[S,m]),W=d.useCallback(()=>{const O=new K.TwitterAuthProvider,D=m("twitter.com");D?.customParameters&&O.setCustomParameters(D.customParameters);const Q=K.getAuth();S(Q,O)},[S,m]),$=d.useCallback((O,D)=>{const Q=K.getAuth();h(!0),K.signInWithEmailAndPassword(Q,O,D).catch(a).then(()=>h(!1))},[]),Z=d.useCallback((O,D)=>{const Q=K.getAuth();h(!0),K.createUserWithEmailAndPassword(Q,O,D).catch(a).then(()=>h(!1))},[]),z=d.useCallback(O=>{const D=K.getAuth();return h(!0),K.fetchSignInMethodsForEmail(D,O).then(Q=>(h(!1),Q))},[]),J=d.useCallback(async()=>{if(!r)throw Error("User is not logged in");return r.getIdToken()},[r]);return{user:r??null,authError:s,authProviderError:l,authLoading:f,initialLoading:A,getAuthToken:J,confirmationResult:g,signOut:E,loginSkipped:b,skipLogin:x,googleLogin:k,anonymousLogin:F,appleLogin:T,facebookLogin:P,githubLogin:M,microsoftLogin:L,twitterLogin:W,emailPasswordLogin:$,phoneLogin:I,fetchSignInMethodsForEmail:z,createUserWithEmailAndPassword:Z,extra:w,setExtra:C}};function jd(e){if(!e)return e;const t=e.toDate();return t.setHours(0,0,0,0),X.Timestamp.fromDate(t)}function fs({firebaseApp:e,textSearchController:t,fields:r}){const n=d.useCallback((a,A,u)=>{const f=no(a.data()),h=a.data()?u.properties?qn(f,u.properties):a.data():void 0;return{id:a.id,path:gs(a.ref.path),values:h}},[]),s=d.useCallback((a,A,u,f,h,b)=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");const v=X.getFirestore(e),g=X.collection(v,a),p=[];return A&&Object.entries(A).filter(([w,C])=>!!C).forEach(([w,C])=>{const[x,B]=C;p.push(X.where(w,x,Go(B,v)))}),u&&f&&p.push(X.orderBy(u,f)),h&&p.push(X.startAfter(h)),b&&p.push(X.limit(b)),X.query(g,...p)},[e]),i=d.useCallback((a,A,u)=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");const f=X.getFirestore(e);return X.getDoc(X.doc(f,a,A)).then(h=>{if(!h.exists())return;const b=pe({collection:u,path:a,entityId:h.id,values:no(h.data()),fields:r});return n(h,a,b)})},[e]),l=d.useCallback(async(a,A,u)=>{if(!t)throw Error("Trying to make text search without specifying a FirestoreTextSearchController");const f=await t({path:a,searchString:A});if(f===void 0)throw Error("The current path is not supported by the specified FirestoreTextSearchController");const h=f.map(async b=>{try{return await i(a,b,u)}catch(v){console.error(v);return}});return Promise.all(h).then(b=>b.filter(v=>v!==void 0&&v.values))},[i]);return{fetchCollection:d.useCallback(({path:a,collection:A,filter:u,limit:f,startAfter:h,searchString:b,orderBy:v,order:g})=>{if(b)return l(a,b,A);console.debug("Fetching collection",a,f,u,h,v,g);const p=s(a,u,v,g,h,f);return X.getDocs(p).then(w=>w.docs.map(C=>{const x=pe({collection:A,path:a,values:no(C.data()),fields:r});return n(C,a,x)}))},[s,l]),listenCollection:d.useCallback(({path:a,collection:A,filter:u,limit:f,startAfter:h,searchString:b,orderBy:v,order:g,onUpdate:p,onError:w})=>{console.debug("Listening collection",{path:a,limit:f,filter:u,startAfter:h,orderBy:v,order:g});const C=s(a,u,v,g,h,f);if(b)return l(a,b,A).then(p).catch(B=>{w&&w(B)}),()=>{};const x=pe({collection:A,path:a,fields:r});return X.onSnapshot(C,{next:B=>{p(B.docs.map(E=>n(E,a,x)))},error:w})},[s,l]),fetchEntity:d.useCallback(({path:a,entityId:A,collection:u})=>i(a,A,u),[i]),listenEntity:d.useCallback(({path:a,entityId:A,collection:u,onUpdate:f,onError:h})=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");const b=X.getFirestore(e);return X.onSnapshot(X.doc(b,a,A),{next:v=>{const g=pe({collection:u,path:a,entityId:v.id,fields:r});f(n(v,a,g))},error:h})},[e]),saveEntity:d.useCallback(({path:a,entityId:A,values:u,collection:f,status:h})=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");const b=X.getFirestore(e),g=pe({collection:f,path:a,entityId:A,fields:r}).properties,p=X.collection(b,a),w=Go(u,b),C=Jn({inputValues:w,properties:g,status:h,timestampNowValue:X.serverTimestamp(),setDateToMidnight:jd});console.debug("Saving entity",a,A,C);let x;return A?x=X.doc(p,A):x=X.doc(p),X.setDoc(x,C,{merge:!0}).then(()=>({id:x.id,path:a,values:no(C)}))},[e]),deleteEntity:d.useCallback(({entity:a})=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");const A=X.getFirestore(e);return X.deleteDoc(X.doc(A,a.path,a.id))},[e]),checkUniqueField:d.useCallback((a,A,u,f,h)=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");const b=X.getFirestore(e);if(console.debug("Check unique field entity",a,A,u,h),f.dataType==="array"&&console.error("checkUniqueField received an array"),u==null)return Promise.resolve(!0);const v=X.query(X.collection(b,a),X.where(A,"==",u));return X.getDocs(v).then(g=>g.docs.filter(p=>p.id!==h).length===0)},[e]),generateEntityId:d.useCallback(a=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");const A=X.getFirestore(e);return X.doc(X.collection(A,a)).id},[e]),countEntities:d.useCallback(async a=>{if(!e)throw Error("useFirestoreDataSource Firebase not initialised");const A=X.getFirestore(e),u=X.collection(A,a);return(await X.getCountFromServer(u)).data().count},[e])}}function no(e){if(e==null||X.serverTimestamp().isEqual(e))return null;if(e instanceof X.Timestamp||typeof e.toDate=="function"&&e.toDate()instanceof Date)return e.toDate();if(e instanceof Date)return e;if(e instanceof Fo)return new Fo(e.latitude,e.longitude);if(e instanceof X.DocumentReference)return new Me(e.id,gs(e.path));if(Array.isArray(e))return e.map(no);if(typeof e=="object"){const t={};for(const r of Object.keys(e))t[r]=no(e[r]);return t}return e}function Go(e,t){return Array.isArray(e)?e.map(r=>Go(r,t)):e instanceof Me?X.doc(t,e.path,e.id):e instanceof Fo?new X.GeoPoint(e.latitude,e.longitude):e instanceof Date?X.Timestamp.fromDate(e):e&&typeof e=="object"?Object.entries(e).map(([r,n])=>({[r]:Go(n,t)})).reduce((r,n)=>({...r,...n}),{}):e}function gs(e){let t=e.lastIndexOf("/");return t=t===-1?e.length:t,e.substring(0,t)}function hs({firebaseApp:e}){const[t,r]=d.useState();d.useEffect(()=>{e&&r(so.getStorage(e))},[e]);const n={};return{uploadFile({file:s,fileName:i,path:l,metadata:a}){if(!t)throw Error("useFirebaseStorageSource Firebase not initialised");const A=i??s.name;return console.debug("Uploading file",A,s,l,a),so.uploadBytes(so.ref(t,`${l}/${A}`),s,a).then(u=>({path:u.ref.fullPath}))},async getDownloadURL(s){if(!t)throw Error("useFirebaseStorageSource Firebase not initialised");if(n[s])return n[s];const i=so.ref(t,s),[l,a]=await Promise.all([so.getDownloadURL(i),so.getMetadata(i)]),A={url:l,metadata:a};return n[s]=A,A}}}function ps({authController:e,authentication:t,getAppCheckToken:r,appCheckForceRefresh:n=!1,storageSource:s,dataSource:i}){const l=!!t,[a,A]=d.useState(l),[u,f]=d.useState(!1),[h,b]=d.useState(!l||!!e.loginSkipped),v=h&&(!l||!!e.user||!!e.loginSkipped)&&!u;d.useEffect(()=>{e.loginSkipped&&b(!0)},[e.loginSkipped]);const g=d.useRef(),p=d.useCallback(async()=>{if(e.initialLoading)return;if(!e.user&&!e.loginSkipped){g.current=void 0,A(!1),b(!1);return}const w=e.user;if(r)try{await r(n)?console.log("App Check success."):(f("App Check failed."),e.signOut())}catch(C){f(C.message),e.signOut()}if(t instanceof Function&&w&&!le(g.current,w)){A(!0);try{await t({user:w,authController:e,dataSource:i,storageSource:s})||(e.signOut(),f(!0))}catch(C){f(C),e.signOut()}A(!1),b(!0),g.current=w}else A(!1);!e.initialLoading&&!w&&b(!0)},[e,t,r,n,i,s]);return d.useEffect(()=>{p()},[p]),{canAccessMainView:v,authLoading:l&&a,notAllowedError:u,authVerified:h}}const Jd=`It seems like the provided Firebase config is not correct. If you 
are using the credentials provided automatically by Firebase 
Hosting, make sure you link your Firebase app to Firebase Hosting. 
`;function bs({firebaseConfig:e,onFirebaseInit:t,name:r,authDomain:n}){const[s,i]=d.useState(),[l,a]=d.useState(!1),[A,u]=d.useState(),f=d.useCallback(h=>{try{const b=fl.initializeApp(h,r??"[DEFAULT]");u(void 0),a(!1),t&&t(h),i(b)}catch(b){console.error("Error initialising Firebase",b),u(Jd+`
`+(b.message??JSON.stringify(b)))}},[r]);return d.useEffect(()=>{a(!0),e?f(e):process.env.NODE_ENV==="production"?fetch("/__/firebase/init.json").then(async h=>{if(console.debug("Firebase init response",h.status),h&&h.status<300){const b=await h.json();n&&(b.authDomain=n),f(b)}}).catch(h=>{a(!1),u("Could not load Firebase configuration from Firebase hosting. If the app is not deployed in Firebase hosting, you need to specify the configuration manually"+h.toString())}):(a(!1),u("You need to deploy the app to Firebase hosting or specify a Firebase configuration object"))},[e,f]),{firebaseApp:s,firebaseConfigLoading:l,configError:A}}function vs({firebaseApp:e,options:t}){t?.debugToken&&Object.assign(window,{FIREBASE_APPCHECK_DEBUG_TOKEN:t?.debugToken});const[r,n]=d.useState(!1),[s,i]=d.useState(),l=d.useCallback(a=>{if(!(!s||!t))return zo.getToken(s,a)},[s,t]);return d.useEffect(()=>{if(!t||!e)return;n(!0);const{providerKey:a,useEnterpriseRecaptcha:A,isTokenAutoRefreshEnabled:u}=t,f=zo.initializeAppCheck(e,{provider:A?new zo.ReCaptchaEnterpriseProvider(a):new zo.ReCaptchaV3Provider(a),isTokenAutoRefreshEnabled:u});i(f),n(!1)},[e,t]),{appCheckLoading:r,getAppCheckToken:t?l:void 0}}const qd=e=>o.jsx(o.Fragment,{children:o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",width:32,height:32,children:[o.jsxs("linearGradient",{id:"95yY7w43Oj6n2vH63j6HJb",x1:"29.401",x2:"29.401",y1:"4.064",y2:"106.734",gradientTransform:"matrix(1 0 0 -1 0 66)",gradientUnits:"userSpaceOnUse",children:[o.jsx("stop",{offset:"0",stopColor:"#ff5840"}),o.jsx("stop",{offset:".007",stopColor:"#ff5840"}),o.jsx("stop",{offset:".989",stopColor:"#fa528c"}),o.jsx("stop",{offset:"1",stopColor:"#fa528c"})]}),o.jsx("path",{fill:"url(#95yY7w43Oj6n2vH63j6HJb)",d:"M47.46,15.5l-1.37,1.48c-1.34,1.44-3.5,1.67-5.15,0.6c-2.71-1.75-6.43-3.13-11-2.37 c-4.94,0.83-9.17,3.85-11.64, 7.97l-8.03-6.08C14.99,9.82,23.2,5,32.5,5c5,0,9.94,1.56,14.27,4.46 C48.81,10.83,49.13,13.71,47.46,15.5z"}),o.jsxs("linearGradient",{id:"95yY7w43Oj6n2vH63j6HJc",x1:"12.148",x2:"12.148",y1:".872",y2:"47.812",gradientTransform:"matrix(1 0 0 -1 0 66)",gradientUnits:"userSpaceOnUse",children:[o.jsx("stop",{offset:"0",stopColor:"#feaa53"}),o.jsx("stop",{offset:".612",stopColor:"#ffcd49"}),o.jsx("stop",{offset:"1",stopColor:"#ffde44"})]}),o.jsx("path",{fill:"url(#95yY7w43Oj6n2vH63j6HJc)",d:"M16.01,30.91c-0.09,2.47,0.37,4.83,1.27,6.96l-8.21,6.05c-1.35-2.51-2.3-5.28-2.75-8.22 c-1.06-6.88,0.54-13.38, 3.95-18.6l8.03,6.08C16.93,25.47,16.1,28.11,16.01,30.91z"}),o.jsxs("linearGradient",{id:"95yY7w43Oj6n2vH63j6HJd",x1:"29.76",x2:"29.76",y1:"32.149",y2:"-6.939",gradientTransform:"matrix(1 0 0 -1 0 66)",gradientUnits:"userSpaceOnUse",children:[o.jsx("stop",{offset:"0",stopColor:"#42d778"}),o.jsx("stop",{offset:".428",stopColor:"#3dca76"}),o.jsx("stop",{offset:"1",stopColor:"#34b171"})]}),o.jsx("path",{fill:"url(#95yY7w43Oj6n2vH63j6HJd)",d:"M50.45,51.28c-4.55,4.07-10.61,6.57-17.36,6.71C22.91,58.2,13.66,52.53,9.07,43.92l8.21-6.05 C19.78,43.81, 25.67,48,32.5,48c3.94,0,7.52-1.28,10.33-3.44L50.45,51.28z"}),o.jsxs("linearGradient",{id:"95yY7w43Oj6n2vH63j6HJe",x1:"46",x2:"46",y1:"3.638",y2:"35.593",gradientTransform:"matrix(1 0 0 -1 0 66)",gradientUnits:"userSpaceOnUse",children:[o.jsx("stop",{offset:"0",stopColor:"#155cde"}),o.jsx("stop",{offset:".278",stopColor:"#1f7fe5"}),o.jsx("stop",{offset:".569",stopColor:"#279ceb"}),o.jsx("stop",{offset:".82",stopColor:"#2cafef"}),o.jsx("stop",{offset:"1",stopColor:"#2eb5f0"})]}),o.jsx("path",{fill:"url(#95yY7w43Oj6n2vH63j6HJe)",d:`M59,31.97c0.01,7.73-3.26,14.58-8.55,19.31l-7.62-6.72c2.1-1.61,3.77-3.71,4.84-6.15
        c0.29-0.66-0.2-1.41-0.92-1.41H37c-2.21,0-4-1.79-4-4v-2c0-2.21,1.79-4,4-4h17C56.75,27,59,29.22,59,31.97z`})]})}),Zd=e=>o.jsx("svg",{width:32,height:32,viewBox:"0 0 56 56",style:{transform:"scale(2.8)"},version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:o.jsx("g",{stroke:e==="light"?"#424245":"white",strokeWidth:"0.5",fillRule:"evenodd",children:o.jsx("path",{d:"M28.2226562,20.3846154 C29.0546875,20.3846154 30.0976562,19.8048315 30.71875,19.0317864 C31.28125,18.3312142 31.6914062,17.352829 31.6914062,16.3744437 C31.6914062,16.2415766 31.6796875,16.1087095 31.65625,16 C30.7304687,16.0362365 29.6171875,16.640178 28.9492187,17.4494596 C28.421875,18.06548 27.9414062,19.0317864 27.9414062,20.0222505 C27.9414062,20.1671964 27.9648438,20.3121424 27.9765625,20.3604577 C28.0351562,20.3725366 28.1289062,20.3846154 28.2226562,20.3846154 Z M25.2929688,35 C26.4296875,35 26.9335938,34.214876 28.3515625,34.214876 C29.7929688,34.214876 30.109375,34.9758423 31.375,34.9758423 C32.6171875,34.9758423 33.4492188,33.792117 34.234375,32.6325493 C35.1132812,31.3038779 35.4765625,29.9993643 35.5,29.9389701 C35.4179688,29.9148125 33.0390625,28.9122695 33.0390625,26.0979021 C33.0390625,23.6579784 34.9140625,22.5588048 35.0195312,22.474253 C33.7773438,20.6382708 31.890625,20.5899555 31.375,20.5899555 C29.9804688,20.5899555 28.84375,21.4596313 28.1289062,21.4596313 C27.3554688,21.4596313 26.3359375,20.6382708 25.1289062,20.6382708 C22.8320312,20.6382708 20.5,22.5950413 20.5,26.2911634 C20.5,28.5861411 21.3671875,31.013986 22.4335938,32.5842339 C23.3476562,33.9129053 24.1445312,35 25.2929688,35 Z",fill:e==="light"?"#424245":"white",fillRule:"nonzero"})})}),Xd=e=>o.jsx("svg",{fill:e==="light"?"#1c1e21":"white",role:"img",viewBox:"0 0 24 24",width:28,height:28,xmlns:"http://www.w3.org/2000/svg",children:o.jsx("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"})}),Kd=e=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 90 90",children:o.jsx("g",{children:o.jsx("path",{d:"M90,15.001C90,7.119,82.884,0,75,0H15C7.116,0,0,7.119,0,15.001v59.998   C0,82.881,7.116,90,15.001,90H45V56H34V41h11v-5.844C45,25.077,52.568,16,61.875,16H74v15H61.875C60.548,31,59,32.611,59,35.024V41   h15v15H59v34h16c7.884,0,15-7.119,15-15.001V15.001z",fill:e==="light"?"#39569c":"white"})})}),Rd=e=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 480 480",children:o.jsx("g",{children:o.jsx("path",{d:"M0.176,224L0.001,67.963l192-26.072V224H0.176z M224.001,37.241L479.937,0v224H224.001V37.241z M479.999,256l-0.062,224   l-255.936-36.008V256H479.999z M192.001,439.918L0.157,413.621L0.147,256h191.854V439.918z",fill:e==="light"?"#00a2ed":"white"})})}),eA=e=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 24 24",children:o.jsx("path",{fill:e==="light"?"#00acee":"white",d:"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"})}),ys="recaptcha-container";function oA(){return d.useEffect(()=>{if(!window||window?.recaptchaVerifier)return;const e=K.getAuth();window.recaptchaVerifier=new K.RecaptchaVerifier(ys,{size:"invisible"},e)},[]),null}function ws({allowSkipLogin:e,logo:t,signInOptions:r,firebaseApp:n,authController:s,noUserComponent:i,disableSignupScreen:l=!1,disabled:a=!1,additionalComponent:A,notAllowedError:u}){const f=jo(),[h,b]=d.useState(!1),[v,g]=d.useState(!1),p=r.map(E=>typeof E=="object"?E.provider:E),w=d.useCallback(()=>{const E=K.getAuth(),m=new K.RecaptchaVerifier("recaptcha",{size:"invisible"},E),k=K.getMultiFactorResolver(E,s.authProviderError);if(k.hints[0].factorId===K.PhoneMultiFactorGenerator.FACTOR_ID){const S={multiFactorHint:k.hints[0],session:k.session};new K.PhoneAuthProvider(E).verifyPhoneNumber(S,m).then(function(I){const T=String(window.prompt("Please enter the verification code that was sent to your mobile device.")),P=K.PhoneAuthProvider.credential(I,T),M=K.PhoneMultiFactorGenerator.assertion(P);return k.resolveSignIn(M)})}else console.warn("Unsupported second factor.")},[s.authProviderError]);function C(){let E;if(s.user!=null)return E;const m=["auth/popup-closed-by-user","auth/cancelled-popup-request"];return s.authProviderError&&(s.authProviderError.code==="auth/operation-not-allowed"||s.authProviderError.code==="auth/configuration-not-found"?E=o.jsxs("div",{children:[o.jsx(c.Box,{p:1,children:o.jsx(ue,{error:"You need to enable Firebase auth and the corresponding login provider in your Firebase project"})}),n&&o.jsx(c.Box,{p:1,children:o.jsx("a",{href:`https://console.firebase.google.com/project/${n.options.projectId}/authentication/providers`,rel:"noopener noreferrer",target:"_blank",children:o.jsx(c.Button,{variant:"text",color:"primary",children:"Open Firebase configuration"})})})]}):m.includes(s.authProviderError.code)||(s.authProviderError.code==="auth/multi-factor-auth-required"&&w(),E=o.jsx(c.Box,{p:1,children:o.jsx(ue,{error:s.authProviderError})}))),E}let x;t?x=o.jsx("img",{src:t,style:{height:"100%",width:"100%",objectFit:"cover"},alt:"Logo"}):x=o.jsx(Yr,{});let B;return u&&(typeof u=="string"?B=u:u instanceof Error?B=u.message:B="It looks like you don't have access to the CMS, based on the specified Authenticator configuration"),o.jsx(c.Fade,{in:!0,timeout:800,mountOnEnter:!0,unmountOnExit:!0,children:o.jsxs(c.Box,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"100vh","@supports (minHeight: 100dvh)":{minHeight:"100dvh"},minWidth:"100vw",p:2},children:[o.jsx("div",{id:"recaptcha"}),o.jsxs(c.Box,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",maxWidth:480},children:[o.jsx(c.Box,{m:1,sx:{padding:1,width:260,height:260},children:x}),B&&o.jsx(c.Box,{p:2,children:o.jsx(ue,{error:B})}),C(),!h&&!v&&o.jsxs(o.Fragment,{children:[Cs(s,p,f.mode,a),p.includes("password")&&o.jsx(Ge,{disabled:a,text:"Email/password",icon:o.jsx(on,{fontSize:"large"}),onClick:()=>b(!0)}),p.includes("phone")&&o.jsx(Ge,{disabled:a,text:"Phone number",icon:o.jsx(ye.Phone,{fontSize:"large"}),onClick:()=>g(!0)}),p.includes("anonymous")&&o.jsx(Ge,{disabled:a,text:"Log in anonymously",icon:o.jsx(ul,{fontSize:"large"}),onClick:s.anonymousLogin}),e&&o.jsx(c.Box,{m:1,children:o.jsx(c.Button,{disabled:a,onClick:s.skipLogin,children:"Skip login"})})]}),h&&o.jsx(rA,{authController:s,onClose:()=>b(!1),mode:f.mode,noUserComponent:i,disableSignupScreen:l}),v&&o.jsx(tA,{authController:s,onClose:()=>g(!1)}),!h&&!v&&A]})]})})}function Ge({icon:e,onClick:t,text:r,disabled:n}){return o.jsx(c.Box,{m:.5,width:"100%",children:o.jsx(c.Button,{fullWidth:!0,variant:"outlined",disabled:n,onClick:t,children:o.jsxs(c.Box,{sx:{p:"1",display:"flex",width:"240px",height:"32px",alignItems:"center",justifyItems:"center"},children:[o.jsx(c.Box,{sx:{display:"flex",flexDirection:"column",width:"32px",alignItems:"center",justifyItems:"center"},children:e}),o.jsx(c.Box,{sx:{flexGrow:1,pl:2,textAlign:"center"},children:r})]})})})}function tA({onClose:e,authController:t}){oA();const[r,n]=d.useState(),[s,i]=d.useState(),[l,a]=d.useState(!1),A=async u=>{u.preventDefault(),s&&t.confirmationResult?(a(!1),t.confirmationResult.confirm(s).catch(f=>{f.code==="auth/invalid-verification-code"&&a(!0)})):r&&t.phoneLogin(r,window.recaptchaVerifier)};return o.jsxs("form",{onSubmit:A,children:[l&&o.jsx(c.Box,{p:2,children:o.jsx(ue,{error:"Invalid confirmation code"})}),o.jsx("div",{id:ys}),o.jsxs(c.Grid,{container:!0,spacing:1,children:[o.jsx(c.Grid,{item:!0,xs:12,children:o.jsx(c.IconButton,{onClick:e,children:o.jsx(Pt,{sx:{width:20,height:20}})})}),o.jsx(c.Grid,{item:!0,xs:12,sx:{p:1,display:"flex"},children:o.jsx(c.Typography,{align:"center",variant:"subtitle2",children:"Please enter your phone number"})}),o.jsx(c.Grid,{item:!0,xs:12,children:o.jsx(c.TextField,{placeholder:"",fullWidth:!0,value:r,disabled:!!(r&&(t.authLoading||t.confirmationResult)),type:"phone",required:!0,onChange:u=>n(u.target.value)})}),!!(r&&t.confirmationResult)&&o.jsxs(o.Fragment,{children:[o.jsx(c.Grid,{item:!0,xs:12,sx:{mt:2,p:1,display:"flex"},children:o.jsx(c.Typography,{align:"center",variant:"subtitle2",children:"Please enter the confirmation code"})}),o.jsx(c.Grid,{item:!0,xs:12,children:o.jsx(c.TextField,{placeholder:"",fullWidth:!0,value:s,type:"text",required:!0,onChange:u=>i(u.target.value)})})]}),o.jsx(c.Grid,{item:!0,xs:12,children:o.jsxs(c.Box,{sx:{display:"flex",justifyContent:"end",alignItems:"center",width:"100%"},children:[t.authLoading&&o.jsx(c.CircularProgress,{sx:{p:1},size:16,thickness:8}),o.jsx(c.Button,{type:"submit",children:"Ok"})]})})]})]})}function rA({onClose:e,authController:t,mode:r,noUserComponent:n,disableSignupScreen:s}){const i=d.useRef(null),[l,a]=d.useState(),[A,u]=d.useState(),[f,h]=d.useState(),b=A===void 0,v=A&&A.includes("password"),g=A&&!A.includes("password")&&A.length>0,p=A&&!A.includes("password");d.useEffect(()=>{(v||p)&&i.current&&i.current.focus()},[v,p]),d.useEffect(()=>{if(!document)return;const S=F=>{F.keyCode===27&&e()};return document.addEventListener("keydown",S,!1),()=>{document.removeEventListener("keydown",S,!1)}},[e]);function w(){l&&t.fetchSignInMethodsForEmail(l).then(S=>{u(S)})}function C(){l&&f&&t.emailPasswordLogin(l,f)}function x(){l&&f&&t.createUserWithEmailAndPassword(l,f)}const B=()=>{b?e():u(void 0)},E=S=>{S.preventDefault(),b?w():v?C():p&&x()},m=p?"No user found with that email. Pick a password to create a new account":v?"Please enter your password":"Please enter your email",k=p?"Create account":v?"Login":"Ok";return g?o.jsxs(c.Grid,{container:!0,spacing:1,children:[o.jsx(c.Grid,{item:!0,xs:12,children:o.jsx(c.IconButton,{onClick:B,children:o.jsx(Pt,{sx:{width:20,height:20}})})}),o.jsxs(c.Grid,{item:!0,xs:12,sx:{p:1},children:[o.jsx(c.Typography,{align:"center",variant:"subtitle2",children:"You already have an account"}),o.jsxs(c.Typography,{align:"center",variant:"body2",children:["You can use one of these methods to login with ",l]})]}),o.jsx(c.Grid,{item:!0,xs:12,children:A&&Cs(t,A,r,!1)})]}):o.jsx(c.Slide,{direction:"up",in:!0,mountOnEnter:!0,unmountOnExit:!0,children:o.jsx("form",{onSubmit:E,children:o.jsxs(c.Grid,{container:!0,spacing:1,children:[o.jsx(c.Grid,{item:!0,xs:12,children:o.jsx(c.IconButton,{onClick:B,children:o.jsx(Pt,{sx:{width:20,height:20}})})}),o.jsx(c.Grid,{item:!0,xs:12,sx:{p:1,display:p&&s?"none":"flex"},children:o.jsx(c.Typography,{align:"center",variant:"subtitle2",children:m})}),o.jsx(c.Grid,{item:!0,xs:12,sx:{display:b?"inherit":"none"},children:o.jsx(c.TextField,{placeholder:"Email",fullWidth:!0,autoFocus:!0,value:l??"",disabled:t.authLoading,type:"email",onChange:S=>a(S.target.value)})}),o.jsx(c.Grid,{item:!0,xs:12,children:p&&n}),o.jsx(c.Grid,{item:!0,xs:12,sx:{display:v||p&&!s?"inherit":"none"},children:o.jsx(c.TextField,{placeholder:"Password",fullWidth:!0,value:f??"",disabled:t.authLoading,inputRef:i,type:"password",onChange:S=>h(S.target.value)})}),o.jsx(c.Grid,{item:!0,xs:12,children:o.jsxs(c.Box,{sx:{display:p&&s?"none":"flex",justifyContent:"end",alignItems:"center",width:"100%"},children:[t.authLoading&&o.jsx(c.CircularProgress,{sx:{p:1},size:16,thickness:8}),o.jsx(c.Button,{type:"submit",children:k})]})})]})})})}function Cs(e,t,r,n){return o.jsxs(o.Fragment,{children:[t.includes("google.com")&&o.jsx(Ge,{disabled:n,text:"Sign in with Google",icon:qd(),onClick:e.googleLogin}),t.includes("microsoft.com")&&o.jsx(Ge,{disabled:n,text:"Sign in with Microsoft",icon:Rd(r),onClick:e.microsoftLogin}),t.includes("apple.com")&&o.jsx(Ge,{disabled:n,text:"Sign in with Apple",icon:Zd(r),onClick:e.appleLogin}),t.includes("github.com")&&o.jsx(Ge,{disabled:n,text:"Sign in with Github",icon:Xd(r),onClick:e.githubLogin}),t.includes("facebook.com")&&o.jsx(Ge,{disabled:n,text:"Sign in with Facebook",icon:Kd(r),onClick:e.facebookLogin}),t.includes("twitter.com")&&o.jsx(Ge,{disabled:n,text:"Sign in with Twitter",icon:eA(r),onClick:e.twitterLogin})]})}const xs=[K.GoogleAuthProvider.PROVIDER_ID];function nA({name:e,logo:t,logoDark:r,toolbarExtraWidget:n,authentication:s,collectionOverrideHandler:i,collections:l,views:a,textSearchController:A,allowSkipLogin:u,signInOptions:f=xs,firebaseConfig:h,onFirebaseInit:b,appCheckOptions:v,primaryColor:g,secondaryColor:p,fontFamily:w,dateTimeFormat:C,locale:x,HomePage:B,basePath:E,baseCollectionPath:m,LoginView:k,onAnalyticsEvent:S,fields:F,plugins:I,autoOpenDrawer:T,snackbarMaxSnack:P=3,snackbarAutoHideDuration:M=5e3}){Fn(e,t);const{firebaseApp:L,firebaseConfigLoading:W,configError:$}=bs({onFirebaseInit:b,firebaseConfig:h}),{appCheckLoading:Z,getAppCheckToken:z}=vs({firebaseApp:L,options:v}),J=us({firebaseApp:L,signInOptions:f}),O=ds(),D=fs({firebaseApp:L,textSearchController:A,fields:F}),Q=hs({firebaseApp:L}),{authLoading:j,canAccessMainView:V,notAllowedError:re}=ps({authController:J,authentication:s,getAppCheckToken:z,appCheckForceRefresh:v&&v.forceRefresh?v.forceRefresh:!1,dataSource:D,storageSource:Q}),G=cs(),_=d.useMemo(()=>ss({mode:G.mode,primaryColor:g,secondaryColor:p,fontFamily:w}),[w,G.mode,g,p]);return $?o.jsx(pt,{fullScreen:!0,children:$}):W||!L||Z?o.jsxs(o.Fragment,{children:[o.jsx(c.CssBaseline,{}),o.jsx(ro,{})]}):o.jsx(Ae.BrowserRouter,{basename:E,children:o.jsx(As,{maxSnack:P,autoHideDuration:M,children:o.jsx(gn,{value:G,children:o.jsx(is,{collections:l,views:a,authController:J,userConfigPersistence:O,collectionOverrideHandler:i,dateTimeFormat:C,dataSource:D,storageSource:Q,entityLinkBuilder:({entity:N})=>`https://console.firebase.google.com/project/${L.options.projectId}/firestore/data/${N.path}/${N.id}`,locale:x,basePath:E,baseCollectionPath:m,onAnalyticsEvent:S,plugins:I,fields:F,children:({context:N,loading:R})=>{let Y;if(R||j)Y=o.jsx(ro,{});else{const te=G.mode==="dark"&&r?r:t;if(V)Y=o.jsxs(Ri,{name:e,logo:te,toolbarExtraWidget:n,autoOpenDrawer:T,children:[o.jsx(ls,{HomePage:B}),o.jsx(zi,{})]});else{const ee=k??ws;Y=o.jsx(ee,{logo:te,allowSkipLogin:u,signInOptions:f??xs,firebaseApp:L,authController:J,notAllowedError:re})}}return o.jsxs(c.ThemeProvider,{theme:_,children:[o.jsx(c.CssBaseline,{enableColorScheme:!0}),Y]})}})})})})}function iA(e,t){return console.debug("Performing Algolia query",e,t),e.search(t).then(({hits:r})=>r.map(n=>n.objectID)).catch(r=>(console.error(r),[]))}y.ArrayContainer=nt,y.ArrayEnumPreview=Xo,y.ArrayEnumSelectBinding=cr,y.ArrayOfMapsPreview=Mn,y.ArrayOfReferencesFieldBinding=ei,y.ArrayOfReferencesPreview=Gn,y.ArrayOfStorageComponentsPreview=On,y.ArrayOfStringsPreview=Pn,y.ArrayOneOfPreview=Vn,y.ArrayPropertyEnumPreview=_t,y.ArrayPropertyPreview=jt,y.AsyncPreviewComponent=ea,y.BlockFieldBinding=pi,y.BooleanPreview=Hn,y.BreadcrumbUpdater=Cd,y.COLLECTION_PATH_SEPARATOR=Zn,y.CenteredView=pt,y.CircularProgressCenter=ro,y.ColorChip=Ut,y.CustomDialogActions=je,y.DEFAULT_FIELD_CONFIGS=xi,y.DatePreview=Wn,y.DateTimeFieldBinding=ui,y.DebouncedTextField=xa,y.DeleteConfirmationDialog=xd,y.DisabledTextField=ci,y.Drawer=Ki,y.DrawerNavigationItem=zr,y.EmptyValue=Ao,y.EntityCollectionTable=Mr,y.EntityCollectionView=Or,y.EntityForm=Ci,y.EntityPreview=kr,y.EntityReference=Me,y.EnumValuesChip=Fe,y.ErrorBoundary=ne,y.ErrorView=ue,y.ExpandablePanel=to,y.FieldDescription=Be,y.FilledMenuItem=Mi,y.FilledSelect=Pi,y.FireCMS=is,y.FireCMSAppBar=ts,y.FireCMSContextInstance=$t,y.FireCMSHomePage=Zi,y.FireCMSLogo=Yr,y.FirebaseCMSApp=nA,y.FirebaseLoginView=ws,y.GeoPoint=Fo,y.ImagePreview=Yn,y.InfoLabel=Bd,y.LabelWithIcon=Ee,y.LoginButton=Ge,y.MapFieldBinding=gi,y.MapPropertyPreview=$n,y.Markdown=et,y.MarkdownFieldBinding=bi,y.ModeControllerProvider=gn,y.NavigationCollectionCard=Vr,y.NavigationGroup=ht,y.NavigationRoutes=ls,y.NotFoundPage=Xi,y.NumberPropertyPreview=Qn,y.PropertyFieldBinding=oo,y.PropertyPreview=xe,y.ReadOnlyFieldBinding=hr,y.ReferenceFieldBinding=fi,y.ReferencePreview=Ke,y.ReferenceSelectionInner=Ji,y.RepeatFieldBinding=hi,y.RouteWrapper=vt,y.Scaffold=Ri,y.SelectFieldBinding=ar,y.SideDialogs=zi,y.SkeletonPropertyComponent=Xe,y.SnackbarProvider=As,y.StorageThumbnail=zn,y.StorageThumbnailInternal=Nn,y.StorageUploadFieldBinding=fr,y.StringPropertyPreview=Nt,y.SwitchControl=Ba,y.SwitchFieldBinding=Ai,y.TextFieldBinding=ho,y.TextInput=di,y.TextareaAutosize=gr,y.UrlComponentPreview=Ro,y.VirtualTable=Ti,y.addInitialSlash=Ql,y.buildAdditionalFieldDelegate=Hd,y.buildCollection=$d,y.buildEntityCallbacks=Nd,y.buildEnumValueConfig=Ud,y.buildEnumValues=zd,y.buildFieldConfig=_d,y.buildProperties=Wd,y.buildPropertiesOrBuilder=Yd,y.buildProperty=Vd,y.canCreateEntity=dt,y.canDeleteEntity=Br,y.canEditEntity=xr,y.cmsToFirestoreModel=Go,y.collectionIconKeys=Er,y.createCMSDefaultTheme=ss,y.deleteEntityWithCallbacks=mn,y.firestoreToCMSModel=no,y.fullPathToCollectionSegments=We,y.getBadgeForWidget=ic,y.getBracketNotation=lc,y.getCollectionByPathOrAlias=Uo,y.getCollectionPathsCombinations=Ot,y.getColorForProperty=sc,y.getDefaultValuesFor=Po,y.getFieldConfig=at,y.getFieldId=yr,y.getHashValue=er,y.getIcon=ki,y.getIconForProperty=ve,y.getIconForView=At,y.getIdIcon=Ei,y.getLastSegment=Ll,y.getPropertyInPath=wr,y.getReferenceFrom=Re,y.getReferencePreviewKeys=mr,y.getResolvedPropertyInPath=Cr,y.getValueInPath=Ve,y.hydrateRegExp=Kn,y.isEmptyObject=tr,y.isHidden=tt,y.isObject=ot,y.isPropertyBuilder=Te,y.isReadOnly=uo,y.isReferenceProperty=Bi,y.isValidRegExp=va,y.joinCollectionLists=Aa,y.mergeCollections=nr,y.mergeDeep=Le,y.performAlgoliaTextSearch=iA,y.pick=jn,y.plural=ac,y.randomColor=pa,y.randomString=fo,y.removeFunctions=Rt,y.removeInPath=ca,y.removeInitialAndTrailingSlashes=be,y.removeInitialSlash=hn,y.removeTrailingSlash=pn,y.removeUndefined=or,y.renderSkeletonCaptionText=Rl,y.renderSkeletonIcon=Kt,y.renderSkeletonImageThumbnail=Xt,y.renderSkeletonText=Qe,y.resolveArrayProperty=_e,y.resolveCollection=pe,y.resolveCollectionPathAliases=Lt,y.resolveEnumValues=Qo,y.resolveNavigationFrom=kn,y.resolvePermissions=Lo,y.resolveProperties=pr,y.resolveProperty=Ie,y.resolvePropertyEnum=br,y.sanitizeData=qn,y.saveEntityWithCallbacks=Wt,y.searchIndex=Wr,y.segmentsToStrippedPath=Xn,y.serializeRegExp=ba,y.singular=cc,y.sortProperties=ir,y.stripCollectionPath=sr,y.toKebabCase=fa,y.toSnakeCase=ha,y.traverseValueProperty=rt,y.traverseValuesProperties=rr,y.updateDateAutoValues=Jn,y.useAuthController=Je,y.useBreadcrumbsContext=Jo,y.useBrowserTitleAndIcon=Fn,y.useBuildLocalConfigurationPersistence=ds,y.useBuildModeController=cs,y.useClearRestoreValue=ke,y.useClipboard=Sn,y.useCollectionFetch=En,y.useDataSource=Se,y.useDebounce=lr,y.useDebounceValue=ya,y.useEntityFetch=_o,y.useFireCMSContext=oe,y.useFirebaseAuthController=us,y.useFirebaseStorageSource=hs,y.useFirestoreDataSource=fs,y.useInitialiseFirebase=bs,y.useInitializeAppCheck=vs,y.useModeController=jo,y.useNavigationContext=he,y.useReferenceDialog=So,y.useResolvedNavigationFrom=Ol,y.useSelectionController=Gr,y.useSideDialogContext=gt,y.useSideDialogsController=ko,y.useSideEntityController=Ne,y.useSnackbarController=He,y.useStorageSource=lo,y.useValidateAuthenticator=ps,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.js.map
